<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.251">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Основи роботи з даними в R - 4&nbsp; Data collection and saving</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./references.html" rel="next">
<link href="./22-r-csv.html" rel="prev">
<link href="./img/favicon.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="css/style.css">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Data collection and saving</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Основи роботи з даними в R</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/kleban/data-r/" title="Source Code" class="sidebar-tool px-1"><i class="bi bi-github"></i></a>
    <a href="" title="Share" id="sidebar-tool-dropdown-0" class="sidebar-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi bi-share"></i></a>
    <ul class="dropdown-menu" aria-labelledby="sidebar-tool-dropdown-0">
        <li>
          <a class="dropdown-item sidebar-tools-main-item" href="https://twitter.com/intent/tweet?url=|url|">
            <i class="bi bi-bi-twitter pe-1"></i>
          Twitter
          </a>
        </li>
        <li>
          <a class="dropdown-item sidebar-tools-main-item" href="https://www.facebook.com/sharer/sharer.php?u=|url|">
            <i class="bi bi-bi-facebook pe-1"></i>
          Facebook
          </a>
        </li>
        <li>
          <a class="dropdown-item sidebar-tools-main-item" href="https://www.linkedin.com/sharing/share-offsite/?url=|url|">
            <i class="bi bi-bi-linkedin pe-1"></i>
          LinkedIn
          </a>
        </li>
    </ul>
</div>
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Про посібник</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00-intro.html" class="sidebar-item-text sidebar-link">Вступ</a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">Вступ до аналізу даних</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-intro.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Вступ</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">Читання даних: типи файлів, формати, пакети R, сервіси</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./21-data-read.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Презентація до лекції</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./22-r-csv.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Data collection and saving</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./23-r-xml.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Data collection and saving</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">Список використаних джерел</a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Зміст</h2>
   
  <ul>
  <li><a href="#csv-comma-separated-values" id="toc-csv-comma-separated-values" class="nav-link active" data-scroll-target="#csv-comma-separated-values"><span class="toc-section-number">4.1</span>  CSV (Comma Separated Values)</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-description" id="toc-sample-dataset-description" class="nav-link" data-scroll-target="#sample-dataset-description"><span class="toc-section-number">4.1.1</span>  Sample dataset description</a></li>
  </ul></li>
  <li><a href="#ms-excel-files-xlsx" id="toc-ms-excel-files-xlsx" class="nav-link" data-scroll-target="#ms-excel-files-xlsx"><span class="toc-section-number">4.2</span>  MS Excel files (xlsx)</a>
  <ul class="collapse">
  <li><a href="#task-1" id="toc-task-1" class="nav-link" data-scroll-target="#task-1"><span class="toc-section-number">4.2.1</span>  Task 1</a></li>
  </ul></li>
  <li><a href="#xml-extensible-markup-language" id="toc-xml-extensible-markup-language" class="nav-link" data-scroll-target="#xml-extensible-markup-language"><span class="toc-section-number">4.3</span>  XML (eXtensible Markup Language)</a></li>
  <li><a href="#api-and-json" id="toc-api-and-json" class="nav-link" data-scroll-target="#api-and-json"><span class="toc-section-number">4.4</span>  API and JSON</a></li>
  <li><a href="#google-services" id="toc-google-services" class="nav-link" data-scroll-target="#google-services"><span class="toc-section-number">4.5</span>  Google Services</a>
  <ul class="collapse">
  <li><a href="#google-spreadsheets" id="toc-google-spreadsheets" class="nav-link" data-scroll-target="#google-spreadsheets"><span class="toc-section-number">4.5.1</span>  Google Spreadsheets</a></li>
  <li><a href="#google-search-trends" id="toc-google-search-trends" class="nav-link" data-scroll-target="#google-search-trends"><span class="toc-section-number">4.5.2</span>  Google Search Trends</a></li>
  </ul></li>
  <li><a href="#sql-with-sqlite-sample" id="toc-sql-with-sqlite-sample" class="nav-link" data-scroll-target="#sql-with-sqlite-sample"><span class="toc-section-number">4.6</span>  SQL (with SQLite sample)</a></li>
  <li><a href="#web-pages-html" id="toc-web-pages-html" class="nav-link" data-scroll-target="#web-pages-html"><span class="toc-section-number">4.7</span>  Web-pages (HTML)</a>
  <ul class="collapse">
  <li><a href="#task-3" id="toc-task-3" class="nav-link" data-scroll-target="#task-3"><span class="toc-section-number">4.7.1</span>  Task 3</a></li>
  </ul></li>
  <li><a href="#набори-даних" id="toc-набори-даних" class="nav-link" data-scroll-target="#набори-даних"><span class="toc-section-number">4.8</span>  Набори даних</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references"><span class="toc-section-number">4.9</span>  References</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Data collection and saving</span></h1>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<p>This chapter contains information about data reading and writing from/to different formats: csv, xml, json, google services, sql, html.</p>
<hr>
<p>You need this packages for code execution:</p>
<div class="cell" data-execution_count="78">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="co"># install.packages("readr")</span></span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="co"># install.packages("xlsx")</span></span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="co"># install.packages("XML")</span></span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="co"># install.packages("methods")</span></span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="co"># install.packages("jsonlite")</span></span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="co"># install.packages("googlesheets4")</span></span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="co"># install.packages('gtrendsR')</span></span>
<span id="cb1-8"><a href="#cb1-8"></a><span class="co"># install.packages('ggplot2')</span></span>
<span id="cb1-9"><a href="#cb1-9"></a><span class="co"># install.packages("RSQLite")</span></span>
<span id="cb1-10"><a href="#cb1-10"></a><span class="co"># #install.packages("rvest")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="79">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="fu">invisible</span>(<span class="fu">Sys.setlocale</span>(<span class="st">"LC_ALL"</span>, <span class="st">"Ukrainian"</span>))</span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="fu">invisible</span>(<span class="fu">options</span>(<span class="at">warn=</span><span class="sc">-</span><span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p>There are many data source types for data storing, reading. Let’s review and try some of them.</p>
<section id="csv-comma-separated-values" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="csv-comma-separated-values"><span class="header-section-number">4.1</span> CSV (Comma Separated Values)</h2>
<p><code>CSV</code> - comma separated values.</p>
<div class="cell" data-execution_count="80">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="co"># lets check current working directory to write correct files path</span></span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="fu">getwd</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
'E:/Repos/Season 2022/r-book/_book/docs/data-analysis-en'
</div>
</div>
<p>You can use <code>/</code> or <code>\\</code> for writing correct path in R. For example:</p>
<div class="cell" data-execution_count="81">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>path <span class="ot">=</span> <span class="st">"d:/projects/file.csv"</span></span>
<span id="cb4-2"><a href="#cb4-2"></a>path <span class="ot">=</span> <span class="st">"d:</span><span class="sc">\\</span><span class="st">projects</span><span class="sc">\\</span><span class="st">file.csv"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>To combine path use <code>paste()</code> or <code>paste0()</code> functions</p>
<div class="cell" data-execution_count="82">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>work_dir <span class="ot">=</span> <span class="fu">getwd</span>()</span>
<span id="cb5-2"><a href="#cb5-2"></a>work_dir </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
'E:/Repos/Season 2022/r-book/_book/docs/data-analysis-en'
</div>
</div>
<div class="cell" data-execution_count="83">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>file_name <span class="ot">=</span> <span class="st">"temp_file.csv"</span></span>
<span id="cb6-2"><a href="#cb6-2"></a>file_path <span class="ot">=</span> <span class="fu">paste0</span>(work_dir, <span class="st">"/"</span>, file_name)</span>
<span id="cb6-3"><a href="#cb6-3"></a>file_path</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
'E:/Repos/Season 2022/r-book/_book/docs/data-analysis-en/temp_file.csv'
</div>
</div>
<div class="cell" data-execution_count="84">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>file_path <span class="ot">=</span> <span class="fu">paste</span>(work_dir, file_name, <span class="at">sep =</span> <span class="st">"/"</span>)</span>
<span id="cb7-2"><a href="#cb7-2"></a>file_path</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
'E:/Repos/Season 2022/r-book/_book/docs/data-analysis-en/temp_file.csv'
</div>
</div>
<section id="sample-dataset-description" class="level3" data-number="4.1.1">
<h3 data-number="4.1.1" class="anchored" data-anchor-id="sample-dataset-description"><span class="header-section-number">4.1.1</span> Sample dataset description</h3>
<p>Information about dataset from <a href="kaggle.com">kaggle.com</a>. Original file located at url: <a href="https://www.kaggle.com/radmirzosimov/telecom-users-dataset">https://www.kaggle.com/radmirzosimov/telecom-users-dataset</a>.</p>
<p>Any business wants to maximize the number of customers. To achieve this goal, it is important not only to try to attract new ones, but also to retain existing ones. Retaining a client will cost the company less than attracting a new one. In addition, a new client may be weakly interested in business services and it will be difficult to work with him, while old clients already have the necessary data on interaction with the service.</p>
<p>Accordingly, predicting the churn, we can react in time and try to keep the client who wants to leave. Based on the data about the services that the client uses, we can make him a special offer, trying to change his decision to leave the operator. This will make the task of retention easier to implement than the task of attracting new users, about which we do not know anything yet.</p>
<p>You are provided with a dataset from a telecommunications company. The data contains information about almost six thousand users, their demographic characteristics, the services they use, the duration of using the operator’s services, the method of payment, and the amount of payment.</p>
<p>The task is to analyze the data and predict the churn of users (to identify people who will and will not renew their contract). The work should include the following mandatory items:</p>
<ol type="1">
<li>Description of the data (with the calculation of basic statistics);</li>
<li>Research of dependencies and formulation of hypotheses;</li>
<li>Building models for predicting the outflow (with justification for the choice of a particular model) 4. based on tested hypotheses and identified relationships;</li>
<li>Comparison of the quality of the obtained models.</li>
</ol>
<p><strong>Fields description:</strong></p>
<ul class="task-list">
<li><input type="checkbox" disabled="" checked=""><code>customerID</code> - customer id</li>
<li><input type="checkbox" disabled="" checked=""><code>gender</code> - client gender (male / female)</li>
<li><input type="checkbox" disabled="" checked=""><code>SeniorCitizen</code> - is the client retired (1, 0)</li>
<li><input type="checkbox" disabled="" checked=""><code>Partner</code> - is the client married (Yes, No)</li>
<li><input type="checkbox" disabled="" checked=""><code>tenure</code> - how many months a person has been a client of the company</li>
<li><input type="checkbox" disabled="" checked=""><code>PhoneService</code> - is the telephone service connected (Yes, No)</li>
<li><input type="checkbox" disabled="" checked=""><code>MultipleLines</code> - are multiple phone lines connected (Yes, No, No phone service)</li>
<li><input type="checkbox" disabled="" checked=""><code>InternetService</code> - client’s Internet service provider (DSL, Fiber optic, No)</li>
<li><input type="checkbox" disabled="" checked=""><code>OnlineSecurity</code> - is the online security service connected (Yes, No, No internet service)</li>
<li><input type="checkbox" disabled="" checked=""><code>OnlineBackup</code> - is the online backup service activated (Yes, No, No internet service)</li>
<li><input type="checkbox" disabled="" checked=""><code>DeviceProtection</code> - does the client have equipment insurance (Yes, No, No internet service)</li>
<li><input type="checkbox" disabled="" checked=""><code>TechSupport</code> - is the technical support service connected (Yes, No, No internet service)</li>
<li><input type="checkbox" disabled="" checked=""><code>StreamingTV</code> - is the streaming TV service connected (Yes, No, No internet service)</li>
<li><input type="checkbox" disabled="" checked=""><code>StreamingMovies</code> - is the streaming cinema service activated (Yes, No, No internet service)</li>
<li><input type="checkbox" disabled="" checked=""><code>Contract</code> - type of customer contract (Month-to-month, One year, Two year)</li>
<li><input type="checkbox" disabled="" checked=""><code>PaperlessBilling</code> - whether the client uses paperless billing (Yes, No)</li>
<li><input type="checkbox" disabled="" checked=""><code>PaymentMethod</code> - payment method (Electronic check, Mailed check, Bank transfer (automatic), Credit card (automatic))</li>
<li><input type="checkbox" disabled="" checked=""><code>MonthlyCharges</code> - current monthly payment</li>
<li><input type="checkbox" disabled="" checked=""><code>TotalCharges</code> - the total amount that the client paid for the services for the entire time</li>
<li><input type="checkbox" disabled="" checked=""><code>Churn - whether</code> there was a churn (Yes or No)</li>
</ul>
<p>Thare are few methods for reading/writing csv in <code>base</code> package:</p>
<ul class="task-list">
<li><input type="checkbox" disabled="" checked=""><code>read.csv()</code>, <code>write.csv</code> - default data separator is <code>,</code>, decimal is separator <code>.</code>.</li>
<li><input type="checkbox" disabled="" checked=""><code>read.csv2()</code>, <code>write.csv2</code> - default data separator is <code>;</code>, decimal is separator <code>,</code>.</li>
</ul>
<p>Before using any new function check it usage information with <code>help(function_name)</code> or <code>?function_name</code>, example: <strong><code>?read.csv</code></strong>.</p>
<p>You can read (current data set has NA values as example, there are no NA in original datase):</p>
<div class="cell" data-execution_count="85">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"../../data/telecom_users.csv"</span>) <span class="co"># default reading</span></span>
<span id="cb8-2"><a href="#cb8-2"></a><span class="fu">str</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   5986 obs. of  22 variables:
 $ X               : int  1869 4528 6344 6739 432 2215 5260 6001 1480 5137 ...
 $ customerID      : chr  "7010-BRBUU" "9688-YGXVR" "9286-DOJGF" "6994-KERXL" ...
 $ gender          : chr  "Male" "Female" "Female" "Male" ...
 $ SeniorCitizen   : int  0 0 1 0 0 0 0 0 0 1 ...
 $ Partner         : chr  "Yes" "No" "Yes" "No" ...
 $ Dependents      : chr  "Yes" "No" "No" "No" ...
 $ tenure          : int  72 44 38 4 2 70 33 1 39 55 ...
 $ PhoneService    : chr  "Yes" "Yes" "Yes" "Yes" ...
 $ MultipleLines   : chr  "Yes" "No" "Yes" "No" ...
 $ InternetService : chr  "No" "Fiber optic" "Fiber optic" "DSL" ...
 $ OnlineSecurity  : chr  "No internet service" "No" "No" "No" ...
 $ OnlineBackup    : chr  "No internet service" "Yes" "No" "No" ...
 $ DeviceProtection: chr  "No internet service" "Yes" "No" "No" ...
 $ TechSupport     : chr  "No internet service" "No" "No" "No" ...
 $ StreamingTV     : chr  "No internet service" "Yes" "No" "No" ...
 $ StreamingMovies : chr  "No internet service" "No" "No" "Yes" ...
 $ Contract        : chr  "Two year" "Month-to-month" "Month-to-month" "Month-to-month" ...
 $ PaperlessBilling: chr  "No" "Yes" "Yes" "Yes" ...
 $ PaymentMethod   : chr  "Credit card (automatic)" "Credit card (automatic)" "Bank transfer (automatic)" "Electronic check" ...
 $ MonthlyCharges  : chr  "24.1" "88.15" "74.95" "55.9" ...
 $ TotalCharges    : num  1735 3973 2870 238 120 ...
 $ Churn           : chr  "No" "No" "Yes" "No" ...</code></pre>
</div>
</div>
<div class="cell" data-execution_count="86">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"../../data/telecom_users.csv"</span>,</span>
<span id="cb10-2"><a href="#cb10-2"></a>                  <span class="at">sep =</span> <span class="st">","</span>, <span class="co"># comma not only possibel separator</span></span>
<span id="cb10-3"><a href="#cb10-3"></a>                  <span class="at">dec =</span> <span class="st">"."</span>, <span class="co"># decimal separator can be different</span></span>
<span id="cb10-4"><a href="#cb10-4"></a>                  <span class="at">na.strings =</span> <span class="fu">c</span>(<span class="st">""</span>, <span class="st">"NA"</span>, <span class="st">"NULL"</span>)) <span class="co"># you can define NA values</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="87">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="fu">str</span>(data) <span class="co"># chack data structure / types/ values</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   5986 obs. of  22 variables:
 $ X               : int  1869 4528 6344 6739 432 2215 5260 6001 1480 5137 ...
 $ customerID      : chr  "7010-BRBUU" "9688-YGXVR" "9286-DOJGF" "6994-KERXL" ...
 $ gender          : chr  "Male" "Female" "Female" "Male" ...
 $ SeniorCitizen   : int  0 0 1 0 0 0 0 0 0 1 ...
 $ Partner         : chr  "Yes" "No" "Yes" "No" ...
 $ Dependents      : chr  "Yes" "No" "No" "No" ...
 $ tenure          : int  72 44 38 4 2 70 33 1 39 55 ...
 $ PhoneService    : chr  "Yes" "Yes" "Yes" "Yes" ...
 $ MultipleLines   : chr  "Yes" "No" "Yes" "No" ...
 $ InternetService : chr  "No" "Fiber optic" "Fiber optic" "DSL" ...
 $ OnlineSecurity  : chr  "No internet service" "No" "No" "No" ...
 $ OnlineBackup    : chr  "No internet service" "Yes" "No" "No" ...
 $ DeviceProtection: chr  "No internet service" "Yes" "No" "No" ...
 $ TechSupport     : chr  "No internet service" "No" "No" "No" ...
 $ StreamingTV     : chr  "No internet service" "Yes" "No" "No" ...
 $ StreamingMovies : chr  "No internet service" "No" "No" "Yes" ...
 $ Contract        : chr  "Two year" "Month-to-month" "Month-to-month" "Month-to-month" ...
 $ PaperlessBilling: chr  "No" "Yes" "Yes" "Yes" ...
 $ PaymentMethod   : chr  "Credit card (automatic)" "Credit card (automatic)" "Bank transfer (automatic)" "Electronic check" ...
 $ MonthlyCharges  : num  24.1 88.2 75 55.9 53.5 ...
 $ TotalCharges    : num  1735 3973 2870 238 120 ...
 $ Churn           : chr  "No" "No" "Yes" "No" ...</code></pre>
</div>
</div>
<div class="cell" data-execution_count="88">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="fu">head</span>(data, <span class="dv">2</span>) <span class="co"># top 6 rows, use n = X, for viewing top X lines</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<table class="dataframe table table-sm table-striped">
<caption>A data.frame: 2 × 22</caption>
<thead>
    <tr><th></th><th scope="col">X</th><th scope="col">customerID</th><th scope="col">gender</th><th scope="col">SeniorCitizen</th><th scope="col">Partner</th><th scope="col">Dependents</th><th scope="col">tenure</th><th scope="col">PhoneService</th><th scope="col">MultipleLines</th><th scope="col">InternetService</th><th scope="col">...</th><th scope="col">DeviceProtection</th><th scope="col">TechSupport</th><th scope="col">StreamingTV</th><th scope="col">StreamingMovies</th><th scope="col">Contract</th><th scope="col">PaperlessBilling</th><th scope="col">PaymentMethod</th><th scope="col">MonthlyCharges</th><th scope="col">TotalCharges</th><th scope="col">Churn</th></tr>
    <tr><th></th><th scope="col">&lt;int&gt;</th><th scope="col">&lt;chr&gt;</th><th scope="col">&lt;chr&gt;</th><th scope="col">&lt;int&gt;</th><th scope="col">&lt;chr&gt;</th><th scope="col">&lt;chr&gt;</th><th scope="col">&lt;int&gt;</th><th scope="col">&lt;chr&gt;</th><th scope="col">&lt;chr&gt;</th><th scope="col">&lt;chr&gt;</th><th scope="col">...</th><th scope="col">&lt;chr&gt;</th><th scope="col">&lt;chr&gt;</th><th scope="col">&lt;chr&gt;</th><th scope="col">&lt;chr&gt;</th><th scope="col">&lt;chr&gt;</th><th scope="col">&lt;chr&gt;</th><th scope="col">&lt;chr&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;chr&gt;</th></tr>
</thead>
<tbody>
    <tr><th scope="row">1</th><td>1869</td><td>7010-BRBUU</td><td>Male  </td><td>0</td><td>Yes</td><td>Yes</td><td>72</td><td>Yes</td><td>Yes</td><td>No         </td><td>...</td><td>No internet service</td><td>No internet service</td><td>No internet service</td><td>No internet service</td><td>Two year      </td><td>No </td><td>Credit card (automatic)</td><td>24.10</td><td>1734.65</td><td>No</td></tr>
    <tr><th scope="row">2</th><td>4528</td><td>9688-YGXVR</td><td>Female</td><td>0</td><td>No </td><td>No </td><td>44</td><td>Yes</td><td>No </td><td>Fiber optic</td><td>...</td><td>Yes                </td><td>No                 </td><td>Yes                </td><td>No                 </td><td>Month-to-month</td><td>Yes</td><td>Credit card (automatic)</td><td>88.15</td><td>3973.20</td><td>No</td></tr>
</tbody>
</table>
</div>
</div>
<div class="cell" data-execution_count="89">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a><span class="fu">is.data.frame</span>(data) <span class="co"># if data is data.frame</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
TRUE
</div>
</div>
<div class="cell" data-execution_count="90">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="fu">anyNA</span>(data) <span class="co"># if dataframe contains any NA values</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
TRUE
</div>
</div>
<div class="cell" data-execution_count="91">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a><span class="fu">lapply</span>(data, anyNA)</span>
<span id="cb16-2"><a href="#cb16-2"></a><span class="co">#lapply(, any) #check NA by 2nd dimension - columns</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<dl>
    <dt>$X</dt>
        <dd>FALSE</dd>
    <dt>$customerID</dt>
        <dd>FALSE</dd>
    <dt>$gender</dt>
        <dd>FALSE</dd>
    <dt>$SeniorCitizen</dt>
        <dd>FALSE</dd>
    <dt>$Partner</dt>
        <dd>FALSE</dd>
    <dt>$Dependents</dt>
        <dd>FALSE</dd>
    <dt>$tenure</dt>
        <dd>FALSE</dd>
    <dt>$PhoneService</dt>
        <dd>FALSE</dd>
    <dt>$MultipleLines</dt>
        <dd>FALSE</dd>
    <dt>$InternetService</dt>
        <dd>FALSE</dd>
    <dt>$OnlineSecurity</dt>
        <dd>FALSE</dd>
    <dt>$OnlineBackup</dt>
        <dd>FALSE</dd>
    <dt>$DeviceProtection</dt>
        <dd>FALSE</dd>
    <dt>$TechSupport</dt>
        <dd>FALSE</dd>
    <dt>$StreamingTV</dt>
        <dd>FALSE</dd>
    <dt>$StreamingMovies</dt>
        <dd>FALSE</dd>
    <dt>$Contract</dt>
        <dd>FALSE</dd>
    <dt>$PaperlessBilling</dt>
        <dd>FALSE</dd>
    <dt>$PaymentMethod</dt>
        <dd>FALSE</dd>
    <dt>$MonthlyCharges</dt>
        <dd>TRUE</dd>
    <dt>$TotalCharges</dt>
        <dd>TRUE</dd>
    <dt>$Churn</dt>
        <dd>FALSE</dd>
</dl>
</div>
</div>
<p>Check <code>MonthlyCharges: TRUE</code> and <code>TotalCharges: TRUE</code>. These columns has NA-values.</p>
<p>Let’s replace them with <code>mean</code>:</p>
<div class="cell" data-execution_count="92">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a>data[<span class="fu">is.na</span>(data<span class="sc">$</span>TotalCharges), <span class="st">"TotalCharges"</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(data<span class="sc">$</span>TotalCharges, <span class="at">na.rm =</span> T)</span>
<span id="cb17-2"><a href="#cb17-2"></a>data[<span class="fu">is.na</span>(data<span class="sc">$</span>MonthlyCharges), <span class="st">"MonthlyCharges"</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(data<span class="sc">$</span>MonthlyCharges, <span class="at">na.rm =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="93">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a><span class="fu">any</span>(<span class="fu">is.na</span>(data)) <span class="co"># check for NA</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
FALSE
</div>
</div>
<p>You can write data with <code>write.csv()</code>, <code>write.csv2()</code> from <code>base</code> package.</p>
<div class="cell" data-execution_count="94">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a><span class="fu">write.csv</span>(data, <span class="at">file =</span> <span class="st">"../../data/cleaned_data.csv"</span>, <span class="at">row.names =</span> F)</span>
<span id="cb19-2"><a href="#cb19-2"></a><span class="co"># by default row.names = TRUE and file will contain first column with row numbers 1,2, ..., N</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>One more useful package is <code>readr</code>. Examples of using:</p>
<div class="cell" data-execution_count="95">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a><span class="co"># library(readr)</span></span>
<span id="cb20-2"><a href="#cb20-2"></a><span class="co"># data &lt;- read_csv(file = "../../data/telecom_users.csv")</span></span>
<span id="cb20-3"><a href="#cb20-3"></a><span class="co"># data &lt;- read_csv2(file = "../../data/telecom_users.csv")`</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
</section>
</section>
<section id="ms-excel-files-xlsx" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="ms-excel-files-xlsx"><span class="header-section-number">4.2</span> MS Excel files (xlsx)</h2>
<p>There are many packages to read/write MS Excel files. <code>xlsx</code> one of the most useful.</p>
<div class="cell" data-execution_count="96">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a><span class="co"># install.packages("xlsx") #install before use it</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="185">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a><span class="fu">library</span>(xlsx)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="186">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a><span class="fu">any</span>(<span class="fu">grepl</span>(<span class="st">"xlsx"</span>, <span class="fu">installed.packages</span>())) <span class="co"># check if package installed</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
TRUE
</div>
</div>
<p><strong><code>?read.xlsx</code></strong> - review package functions and params</p>
<p>Let’s read the data <code>telecom_users.xlsx</code>:</p>
<div class="cell" data-execution_count="189">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read.xlsx</span>(<span class="st">"../../data/telecom_users.xlsx"</span>, <span class="at">sheetIndex =</span> <span class="dv">1</span>)</span>
<span id="cb24-2"><a href="#cb24-2"></a><span class="co"># sheetIndex = 1 - select sheet to read, or use sheetName = "sheet1" to read by Name</span></span>
<span id="cb24-3"><a href="#cb24-3"></a><span class="fu">head</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<table class="dataframe table table-sm table-striped">
<caption>A data.frame: 6 × 21</caption>
<thead>
    <tr><th></th><th scope="col">customerID</th><th scope="col">gender</th><th scope="col">SeniorCitizen</th><th scope="col">Partner</th><th scope="col">Dependents</th><th scope="col">tenure</th><th scope="col">PhoneService</th><th scope="col">MultipleLines</th><th scope="col">InternetService</th><th scope="col">OnlineSecurity</th><th scope="col">...</th><th scope="col">DeviceProtection</th><th scope="col">TechSupport</th><th scope="col">StreamingTV</th><th scope="col">StreamingMovies</th><th scope="col">Contract</th><th scope="col">PaperlessBilling</th><th scope="col">PaymentMethod</th><th scope="col">MonthlyCharges</th><th scope="col">TotalCharges</th><th scope="col">Churn</th></tr>
    <tr><th></th><th scope="col">&lt;chr&gt;</th><th scope="col">&lt;chr&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;chr&gt;</th><th scope="col">&lt;chr&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;chr&gt;</th><th scope="col">&lt;chr&gt;</th><th scope="col">&lt;chr&gt;</th><th scope="col">&lt;chr&gt;</th><th scope="col">...</th><th scope="col">&lt;chr&gt;</th><th scope="col">&lt;chr&gt;</th><th scope="col">&lt;chr&gt;</th><th scope="col">&lt;chr&gt;</th><th scope="col">&lt;chr&gt;</th><th scope="col">&lt;chr&gt;</th><th scope="col">&lt;chr&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;chr&gt;</th></tr>
</thead>
<tbody>
    <tr><th scope="row">1</th><td>7010-BRBUU</td><td>Male  </td><td>0</td><td>Yes</td><td>Yes</td><td>72</td><td>Yes</td><td>Yes             </td><td>No         </td><td>No internet service</td><td>...</td><td>No internet service</td><td>No internet service</td><td>No internet service</td><td>No internet service</td><td>Two year      </td><td>No </td><td>Credit card (automatic)  </td><td>24.10</td><td>1734.65</td><td>No </td></tr>
    <tr><th scope="row">2</th><td>9688-YGXVR</td><td>Female</td><td>0</td><td>No </td><td>No </td><td>44</td><td>Yes</td><td>No              </td><td>Fiber optic</td><td>No                 </td><td>...</td><td>Yes                </td><td>No                 </td><td>Yes                </td><td>No                 </td><td>Month-to-month</td><td>Yes</td><td>Credit card (automatic)  </td><td>88.15</td><td>3973.20</td><td>No </td></tr>
    <tr><th scope="row">3</th><td>9286-DOJGF</td><td>Female</td><td>1</td><td>Yes</td><td>No </td><td>38</td><td>Yes</td><td>Yes             </td><td>Fiber optic</td><td>No                 </td><td>...</td><td>No                 </td><td>No                 </td><td>No                 </td><td>No                 </td><td>Month-to-month</td><td>Yes</td><td>Bank transfer (automatic)</td><td>74.95</td><td>2869.85</td><td>Yes</td></tr>
    <tr><th scope="row">4</th><td>6994-KERXL</td><td>Male  </td><td>0</td><td>No </td><td>No </td><td> 4</td><td>Yes</td><td>No              </td><td>DSL        </td><td>No                 </td><td>...</td><td>No                 </td><td>No                 </td><td>No                 </td><td>Yes                </td><td>Month-to-month</td><td>Yes</td><td>Electronic check         </td><td>55.90</td><td> 238.50</td><td>No </td></tr>
    <tr><th scope="row">5</th><td>2181-UAESM</td><td>Male  </td><td>0</td><td>No </td><td>No </td><td> 2</td><td>Yes</td><td>No              </td><td>DSL        </td><td>Yes                </td><td>...</td><td>Yes                </td><td>No                 </td><td>No                 </td><td>No                 </td><td>Month-to-month</td><td>No </td><td>Electronic check         </td><td>53.45</td><td> 119.50</td><td>No </td></tr>
    <tr><th scope="row">6</th><td>4312-GVYNH</td><td>Female</td><td>0</td><td>Yes</td><td>No </td><td>70</td><td>No </td><td>No phone service</td><td>DSL        </td><td>Yes                </td><td>...</td><td>Yes                </td><td>Yes                </td><td>No                 </td><td>Yes                </td><td>Two year      </td><td>Yes</td><td>Bank transfer (automatic)</td><td>49.85</td><td>3370.20</td><td>No </td></tr>
</tbody>
</table>
</div>
</div>
<div class="cell" data-execution_count="190">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a><span class="co"># You can also use startRow, endRow and other params to define how much data read</span></span>
<span id="cb25-2"><a href="#cb25-2"></a>data <span class="ot">&lt;-</span> <span class="fu">read.xlsx</span>(<span class="st">"../../data/telecom_users.xlsx"</span>, <span class="at">sheetIndex =</span> <span class="dv">1</span>, <span class="at">endRow =</span> <span class="dv">100</span>)</span>
<span id="cb25-3"><a href="#cb25-3"></a><span class="fu">head</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<table class="dataframe table table-sm table-striped">
<caption>A data.frame: 6 × 21</caption>
<thead>
    <tr><th></th><th scope="col">customerID</th><th scope="col">gender</th><th scope="col">SeniorCitizen</th><th scope="col">Partner</th><th scope="col">Dependents</th><th scope="col">tenure</th><th scope="col">PhoneService</th><th scope="col">MultipleLines</th><th scope="col">InternetService</th><th scope="col">OnlineSecurity</th><th scope="col">...</th><th scope="col">DeviceProtection</th><th scope="col">TechSupport</th><th scope="col">StreamingTV</th><th scope="col">StreamingMovies</th><th scope="col">Contract</th><th scope="col">PaperlessBilling</th><th scope="col">PaymentMethod</th><th scope="col">MonthlyCharges</th><th scope="col">TotalCharges</th><th scope="col">Churn</th></tr>
    <tr><th></th><th scope="col">&lt;chr&gt;</th><th scope="col">&lt;chr&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;chr&gt;</th><th scope="col">&lt;chr&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;chr&gt;</th><th scope="col">&lt;chr&gt;</th><th scope="col">&lt;chr&gt;</th><th scope="col">&lt;chr&gt;</th><th scope="col">...</th><th scope="col">&lt;chr&gt;</th><th scope="col">&lt;chr&gt;</th><th scope="col">&lt;chr&gt;</th><th scope="col">&lt;chr&gt;</th><th scope="col">&lt;chr&gt;</th><th scope="col">&lt;chr&gt;</th><th scope="col">&lt;chr&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;chr&gt;</th></tr>
</thead>
<tbody>
    <tr><th scope="row">1</th><td>7010-BRBUU</td><td>Male  </td><td>0</td><td>Yes</td><td>Yes</td><td>72</td><td>Yes</td><td>Yes             </td><td>No         </td><td>No internet service</td><td>...</td><td>No internet service</td><td>No internet service</td><td>No internet service</td><td>No internet service</td><td>Two year      </td><td>No </td><td>Credit card (automatic)  </td><td>24.10</td><td>1734.65</td><td>No </td></tr>
    <tr><th scope="row">2</th><td>9688-YGXVR</td><td>Female</td><td>0</td><td>No </td><td>No </td><td>44</td><td>Yes</td><td>No              </td><td>Fiber optic</td><td>No                 </td><td>...</td><td>Yes                </td><td>No                 </td><td>Yes                </td><td>No                 </td><td>Month-to-month</td><td>Yes</td><td>Credit card (automatic)  </td><td>88.15</td><td>3973.20</td><td>No </td></tr>
    <tr><th scope="row">3</th><td>9286-DOJGF</td><td>Female</td><td>1</td><td>Yes</td><td>No </td><td>38</td><td>Yes</td><td>Yes             </td><td>Fiber optic</td><td>No                 </td><td>...</td><td>No                 </td><td>No                 </td><td>No                 </td><td>No                 </td><td>Month-to-month</td><td>Yes</td><td>Bank transfer (automatic)</td><td>74.95</td><td>2869.85</td><td>Yes</td></tr>
    <tr><th scope="row">4</th><td>6994-KERXL</td><td>Male  </td><td>0</td><td>No </td><td>No </td><td> 4</td><td>Yes</td><td>No              </td><td>DSL        </td><td>No                 </td><td>...</td><td>No                 </td><td>No                 </td><td>No                 </td><td>Yes                </td><td>Month-to-month</td><td>Yes</td><td>Electronic check         </td><td>55.90</td><td> 238.50</td><td>No </td></tr>
    <tr><th scope="row">5</th><td>2181-UAESM</td><td>Male  </td><td>0</td><td>No </td><td>No </td><td> 2</td><td>Yes</td><td>No              </td><td>DSL        </td><td>Yes                </td><td>...</td><td>Yes                </td><td>No                 </td><td>No                 </td><td>No                 </td><td>Month-to-month</td><td>No </td><td>Electronic check         </td><td>53.45</td><td> 119.50</td><td>No </td></tr>
    <tr><th scope="row">6</th><td>4312-GVYNH</td><td>Female</td><td>0</td><td>Yes</td><td>No </td><td>70</td><td>No </td><td>No phone service</td><td>DSL        </td><td>Yes                </td><td>...</td><td>Yes                </td><td>Yes                </td><td>No                 </td><td>Yes                </td><td>Two year      </td><td>Yes</td><td>Bank transfer (automatic)</td><td>49.85</td><td>3370.20</td><td>No </td></tr>
</tbody>
</table>
</div>
</div>
<p>Let’s replace <code>Churn</code> values <code>Yes</code>/<code>No</code> by <code>1</code>/<code>0</code>:</p>
<div class="cell" data-execution_count="101">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a><span class="fu">head</span>(data<span class="sc">$</span>Churn)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class="list-inline"><li>'No'</li><li>'No'</li><li>'Yes'</li><li>'No'</li><li>'No'</li><li>'No'</li></ol>
</div>
</div>
<div class="cell" data-execution_count="102">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a>data<span class="sc">$</span>Churn <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(data<span class="sc">$</span>Churn <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="103">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a><span class="fu">head</span>(data<span class="sc">$</span>Churn)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class="list-inline"><li>0</li><li>0</li><li>1</li><li>0</li><li>0</li><li>0</li></ol>
</div>
</div>
<p>Write final data to excel:</p>
<div class="cell" data-execution_count="191">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a><span class="fu">write.xlsx</span>(data, <span class="at">file =</span> <span class="st">"../../data/final_telecom_data.xlsx"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<section id="task-1" class="level3" data-number="4.2.1">
<h3 data-number="4.2.1" class="anchored" data-anchor-id="task-1"><span class="header-section-number">4.2.1</span> Task 1</h3>
<p>Download from kaggle.com and read dataset <code>Default_Fin.csv</code>: https://www.kaggle.com/kmldas/loan-default-prediction</p>
<p><em>Description:</em></p>
<p>This is a synthetic dataset created using actual data from a financial institution. The data has been modified to remove identifiable features and the numbers transformed to ensure they do not link to original source (financial institution).</p>
<p>This is intended to be used for academic purposes for beginners who want to practice financial analytics from a simple financial dataset</p>
<ul class="task-list">
<li><input type="checkbox" disabled="" checked=""><code>Index</code> - This is the serial number or unique identifier of the loan taker</li>
<li><input type="checkbox" disabled="" checked=""><code>Employed</code> - This is a Boolean 1= employed 0= unemployed</li>
<li><input type="checkbox" disabled="" checked=""><code>Bank.Balance</code> - Bank Balance of the loan taker</li>
<li><input type="checkbox" disabled="" checked=""><code>Annual.Salary</code> - Annual salary of the loan taker<br>
</li>
<li><input type="checkbox" disabled="" checked=""><code>Defaulted</code> - This is a Boolean 1= defaulted 0= not defaulted</li>
</ul>
<ol type="1">
<li>Check what columns has missing values</li>
<li>Count default and non-default clients / and parts of total clients in %</li>
<li>Count Employed clients</li>
<li>Count Employed Default clients</li>
<li>Average salary by Employed clients</li>
<li>Rename columns to “id”, “empl”, “balance”, “salary”, “default”</li>
</ol>
<hr>
<p><strong>Solution for Task 1</strong></p>
<div class="cell" data-execution_count="145">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"../../data/Default_Fin.csv"</span>)</span>
<span id="cb30-2"><a href="#cb30-2"></a><span class="fu">head</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<table class="dataframe table table-sm table-striped">
<caption>A data.frame: 6 × 5</caption>
<thead>
    <tr><th></th><th scope="col">Index</th><th scope="col">Employed</th><th scope="col">Bank.Balance</th><th scope="col">Annual.Salary</th><th scope="col">Defaulted.</th></tr>
    <tr><th></th><th scope="col">&lt;int&gt;</th><th scope="col">&lt;int&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;int&gt;</th></tr>
</thead>
<tbody>
    <tr><th scope="row">1</th><td>1</td><td>1</td><td> 8754.36</td><td>532339.56</td><td>0</td></tr>
    <tr><th scope="row">2</th><td>2</td><td>0</td><td> 9806.16</td><td>145273.56</td><td>0</td></tr>
    <tr><th scope="row">3</th><td>3</td><td>1</td><td>12882.60</td><td>381205.68</td><td>0</td></tr>
    <tr><th scope="row">4</th><td>4</td><td>1</td><td> 6351.00</td><td>428453.88</td><td>0</td></tr>
    <tr><th scope="row">5</th><td>5</td><td>1</td><td> 9427.92</td><td>461562.00</td><td>0</td></tr>
    <tr><th scope="row">6</th><td>6</td><td>0</td><td>11035.08</td><td> 89898.72</td><td>0</td></tr>
</tbody>
</table>
</div>
</div>
<blockquote class="blockquote">
<ol type="1">
<li>Check what columns has missing values</li>
</ol>
</blockquote>
<div class="cell" data-execution_count="106">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a><span class="fu">anyNA</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
FALSE
</div>
</div>
<blockquote class="blockquote">
<ol start="2" type="1">
<li>Count default and non-default clients / and parts of total clients in %</li>
</ol>
</blockquote>
<div class="cell" data-execution_count="107">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a>def_count <span class="ot">&lt;-</span> <span class="fu">nrow</span>(data[data<span class="sc">$</span>Defaulted. <span class="sc">==</span> <span class="dv">1</span>, ])</span>
<span id="cb32-2"><a href="#cb32-2"></a>no_def_count <span class="ot">&lt;-</span> <span class="fu">nrow</span>(data[data<span class="sc">$</span>Defaulted. <span class="sc">==</span> <span class="dv">0</span>, ])</span>
<span id="cb32-3"><a href="#cb32-3"></a>def_count</span>
<span id="cb32-4"><a href="#cb32-4"></a>no_def_count </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
333
</div>
<div class="cell-output cell-output-display">
9667
</div>
</div>
<div class="cell" data-execution_count="108">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a>def_count <span class="sc">/</span> <span class="fu">nrow</span>(data) <span class="sc">*</span> <span class="dv">100</span> <span class="co"># part defaults</span></span>
<span id="cb33-2"><a href="#cb33-2"></a>no_def_count <span class="sc">/</span> <span class="fu">nrow</span>(data) <span class="sc">*</span> <span class="dv">100</span> <span class="co"># part non-defaults</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
3.33
</div>
<div class="cell-output cell-output-display">
96.67
</div>
</div>
<blockquote class="blockquote">
<ol start="3" type="1">
<li>Count Employed clients</li>
</ol>
</blockquote>
<div class="cell" data-execution_count="109">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1"></a>empl <span class="ot">&lt;-</span> data[data<span class="sc">$</span>Employed <span class="sc">==</span> <span class="dv">1</span>, ]</span>
<span id="cb34-2"><a href="#cb34-2"></a><span class="fu">nrow</span>(empl)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
7056
</div>
</div>
<blockquote class="blockquote">
<ol start="4" type="1">
<li>Count Employed Default clients</li>
</ol>
</blockquote>
<div class="cell" data-execution_count="110">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a>empl <span class="ot">&lt;-</span> data[data<span class="sc">$</span>Employed <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> data<span class="sc">$</span>Defaulted. <span class="sc">==</span> <span class="dv">1</span>, ]</span>
<span id="cb35-2"><a href="#cb35-2"></a><span class="fu">nrow</span>(empl)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
206
</div>
</div>
<blockquote class="blockquote">
<ol start="5" type="1">
<li>Average salary by Employed clients</li>
</ol>
</blockquote>
<div class="cell" data-execution_count="111">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1"></a>empl <span class="ot">&lt;-</span> data[data<span class="sc">$</span>Employed <span class="sc">==</span> <span class="dv">1</span>, ]</span>
<span id="cb36-2"><a href="#cb36-2"></a><span class="fu">mean</span>(empl<span class="sc">$</span>Annual.Salary)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
480143.43414966
</div>
</div>
<blockquote class="blockquote">
<ol start="6" type="1">
<li>Rename columns to “id”, “empl”, “balance”, “salary”, “default”:</li>
</ol>
</blockquote>
<div class="cell" data-execution_count="112">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a><span class="fu">colnames</span>(data) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"id"</span>, <span class="st">"empl"</span>, <span class="st">"balance"</span>, <span class="st">"salary"</span>, <span class="st">"default"</span>)</span>
<span id="cb37-2"><a href="#cb37-2"></a><span class="fu">head</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<table class="dataframe table table-sm table-striped">
<caption>A data.frame: 6 × 5</caption>
<thead>
    <tr><th></th><th scope="col">id</th><th scope="col">empl</th><th scope="col">balance</th><th scope="col">salary</th><th scope="col">default</th></tr>
    <tr><th></th><th scope="col">&lt;int&gt;</th><th scope="col">&lt;int&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;int&gt;</th></tr>
</thead>
<tbody>
    <tr><th scope="row">1</th><td>1</td><td>1</td><td> 8754.36</td><td>532339.56</td><td>0</td></tr>
    <tr><th scope="row">2</th><td>2</td><td>0</td><td> 9806.16</td><td>145273.56</td><td>0</td></tr>
    <tr><th scope="row">3</th><td>3</td><td>1</td><td>12882.60</td><td>381205.68</td><td>0</td></tr>
    <tr><th scope="row">4</th><td>4</td><td>1</td><td> 6351.00</td><td>428453.88</td><td>0</td></tr>
    <tr><th scope="row">5</th><td>5</td><td>1</td><td> 9427.92</td><td>461562.00</td><td>0</td></tr>
    <tr><th scope="row">6</th><td>6</td><td>0</td><td>11035.08</td><td> 89898.72</td><td>0</td></tr>
</tbody>
</table>
</div>
</div>
<hr>
</section>
</section>
<section id="xml-extensible-markup-language" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="xml-extensible-markup-language"><span class="header-section-number">4.3</span> XML (eXtensible Markup Language)</h2>
<p>For our example we will use data from <code>data/employes.xml</code>. File contains records with info:</p>
<pre><code>&lt;RECORDS&gt;
   &lt;EMPLOYEE&gt;
      &lt;ID&gt;1&lt;/ID&gt;
      &lt;NAME&gt;Rick&lt;/NAME&gt;
      &lt;SALARY&gt;623.3&lt;/SALARY&gt;
      &lt;STARTDATE&gt;1/1/2012&lt;/STARTDATE&gt;
      &lt;DEPT&gt;IT&lt;/DEPT&gt;
   &lt;/EMPLOYEE&gt;
   ...
&lt;/RECORDS&gt;</code></pre>
<div class="cell" data-execution_count="146">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1"></a><span class="co">#install.packages("XML")</span></span>
<span id="cb39-2"><a href="#cb39-2"></a><span class="fu">library</span>(<span class="st">"XML"</span>)</span>
<span id="cb39-3"><a href="#cb39-3"></a><span class="co">#install.packages("methods")</span></span>
<span id="cb39-4"><a href="#cb39-4"></a><span class="fu">library</span>(<span class="st">"methods"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="147">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1"></a>result <span class="ot">&lt;-</span> <span class="fu">xmlParse</span>(<span class="at">file =</span> <span class="st">"../../data/employes.xml"</span>)</span>
<span id="cb40-2"><a href="#cb40-2"></a><span class="fu">print</span>(result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;?xml version="1.0"?&gt;
&lt;RECORDS&gt;
  &lt;EMPLOYEE&gt;
    &lt;ID&gt;1&lt;/ID&gt;
    &lt;NAME&gt;Rick&lt;/NAME&gt;
    &lt;SALARY&gt;623.3&lt;/SALARY&gt;
    &lt;STARTDATE&gt;1/1/2012&lt;/STARTDATE&gt;
    &lt;DEPT&gt;IT&lt;/DEPT&gt;
  &lt;/EMPLOYEE&gt;
  &lt;EMPLOYEE&gt;
    &lt;ID&gt;2&lt;/ID&gt;
    &lt;NAME&gt;Dan&lt;/NAME&gt;
    &lt;SALARY&gt;515.2&lt;/SALARY&gt;
    &lt;STARTDATE&gt;9/23/2013&lt;/STARTDATE&gt;
    &lt;DEPT&gt;Operations&lt;/DEPT&gt;
  &lt;/EMPLOYEE&gt;
  &lt;EMPLOYEE&gt;
    &lt;ID&gt;3&lt;/ID&gt;
    &lt;NAME&gt;Michelle&lt;/NAME&gt;
    &lt;SALARY&gt;611&lt;/SALARY&gt;
    &lt;STARTDATE&gt;11/15/2014&lt;/STARTDATE&gt;
    &lt;DEPT&gt;IT&lt;/DEPT&gt;
  &lt;/EMPLOYEE&gt;
  &lt;EMPLOYEE&gt;
    &lt;ID&gt;4&lt;/ID&gt;
    &lt;NAME&gt;Ryan&lt;/NAME&gt;
    &lt;SALARY&gt;729&lt;/SALARY&gt;
    &lt;STARTDATE&gt;5/11/2014&lt;/STARTDATE&gt;
    &lt;DEPT&gt;HR&lt;/DEPT&gt;
  &lt;/EMPLOYEE&gt;
  &lt;EMPLOYEE&gt;
    &lt;ID&gt;5&lt;/ID&gt;
    &lt;NAME&gt;Gary&lt;/NAME&gt;
    &lt;SALARY&gt;843.25&lt;/SALARY&gt;
    &lt;STARTDATE&gt;3/27/2015&lt;/STARTDATE&gt;
    &lt;DEPT&gt;Finance&lt;/DEPT&gt;
  &lt;/EMPLOYEE&gt;
  &lt;EMPLOYEE&gt;
    &lt;ID&gt;6&lt;/ID&gt;
    &lt;NAME&gt;Nina&lt;/NAME&gt;
    &lt;SALARY&gt;578&lt;/SALARY&gt;
    &lt;STARTDATE&gt;5/21/2013&lt;/STARTDATE&gt;
    &lt;DEPT&gt;IT&lt;/DEPT&gt;
  &lt;/EMPLOYEE&gt;
  &lt;EMPLOYEE&gt;
    &lt;ID&gt;7&lt;/ID&gt;
    &lt;NAME&gt;Simon&lt;/NAME&gt;
    &lt;SALARY&gt;632.8&lt;/SALARY&gt;
    &lt;STARTDATE&gt;7/30/2013&lt;/STARTDATE&gt;
    &lt;DEPT&gt;Operations&lt;/DEPT&gt;
  &lt;/EMPLOYEE&gt;
  &lt;EMPLOYEE&gt;
    &lt;ID&gt;8&lt;/ID&gt;
    &lt;NAME&gt;Guru&lt;/NAME&gt;
    &lt;SALARY&gt;722.5&lt;/SALARY&gt;
    &lt;STARTDATE&gt;6/17/2014&lt;/STARTDATE&gt;
    &lt;DEPT&gt;Finance&lt;/DEPT&gt;
  &lt;/EMPLOYEE&gt;
&lt;/RECORDS&gt;
 </code></pre>
</div>
</div>
<div class="cell" data-execution_count="148">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1"></a>rootnode <span class="ot">&lt;-</span> <span class="fu">xmlRoot</span>(result) <span class="co"># reading rootnode of xml document</span></span>
<span id="cb42-2"><a href="#cb42-2"></a>rootnode[[<span class="dv">1</span>]] <span class="co"># reading first record</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>&lt;EMPLOYEE&gt;
  &lt;ID&gt;1&lt;/ID&gt;
  &lt;NAME&gt;Rick&lt;/NAME&gt;
  &lt;SALARY&gt;623.3&lt;/SALARY&gt;
  &lt;STARTDATE&gt;1/1/2012&lt;/STARTDATE&gt;
  &lt;DEPT&gt;IT&lt;/DEPT&gt;
&lt;/EMPLOYEE&gt; </code></pre>
</div>
</div>
<div class="cell" data-execution_count="149">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1"></a>rootnode[[<span class="dv">1</span>]][[<span class="dv">2</span>]] <span class="co"># reading first record in root node and second tag, its &lt;NAME&gt;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>&lt;NAME&gt;Rick&lt;/NAME&gt; </code></pre>
</div>
</div>
<p>For us the best way is to get dataframe:</p>
<div class="cell" data-execution_count="150">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1"></a>xmldataframe <span class="ot">&lt;-</span> <span class="fu">xmlToDataFrame</span>(<span class="st">"../../data/employes.xml"</span>)</span>
<span id="cb46-2"><a href="#cb46-2"></a>xmldataframe</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<table class="dataframe table table-sm table-striped">
<caption>A data.frame: 8 × 5</caption>
<thead>
    <tr><th scope="col">ID</th><th scope="col">NAME</th><th scope="col">SALARY</th><th scope="col">STARTDATE</th><th scope="col">DEPT</th></tr>
    <tr><th scope="col">&lt;chr&gt;</th><th scope="col">&lt;chr&gt;</th><th scope="col">&lt;chr&gt;</th><th scope="col">&lt;chr&gt;</th><th scope="col">&lt;chr&gt;</th></tr>
</thead>
<tbody>
    <tr><td>1</td><td>Rick    </td><td>623.3 </td><td>1/1/2012  </td><td>IT        </td></tr>
    <tr><td>2</td><td>Dan     </td><td>515.2 </td><td>9/23/2013 </td><td>Operations</td></tr>
    <tr><td>3</td><td>Michelle</td><td>611   </td><td>11/15/2014</td><td>IT        </td></tr>
    <tr><td>4</td><td>Ryan    </td><td>729   </td><td>5/11/2014 </td><td>HR        </td></tr>
    <tr><td>5</td><td>Gary    </td><td>843.25</td><td>3/27/2015 </td><td>Finance   </td></tr>
    <tr><td>6</td><td>Nina    </td><td>578   </td><td>5/21/2013 </td><td>IT        </td></tr>
    <tr><td>7</td><td>Simon   </td><td>632.8 </td><td>7/30/2013 </td><td>Operations</td></tr>
    <tr><td>8</td><td>Guru    </td><td>722.5 </td><td>6/17/2014 </td><td>Finance   </td></tr>
</tbody>
</table>
</div>
</div>
<hr>
</section>
<section id="api-and-json" class="level2" data-number="4.4">
<h2 data-number="4.4" class="anchored" data-anchor-id="api-and-json"><span class="header-section-number">4.4</span> API and JSON</h2>
<p><code>JSON</code> (<code>JavaScript Object Notation</code>) is a lightweight data-interchange format. It is easy for humans to read and write. It is easy for machines to parse and generate. It is based on a subset of the JavaScript Programming Language Standard.</p>
<p><code>API</code> is the acronym for <code>Application Programming Interface</code>, which is a software intermediary that allows two applications to talk to each other.</p>
<p>One of the most popular packages for <code>json</code> is <code>jsonlite</code>.</p>
<div class="cell" data-execution_count="151">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1"></a><span class="co">#install.packages("jsonlite")</span></span>
<span id="cb47-2"><a href="#cb47-2"></a><span class="fu">library</span>(jsonlite)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s use readinginformation about BTC and USDT crypro currencies from Binance</p>
<div class="cell" data-execution_count="152">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1"></a>market <span class="ot">=</span> <span class="st">'BTCUSDT'</span></span>
<span id="cb48-2"><a href="#cb48-2"></a>interval <span class="ot">=</span> <span class="st">'1h'</span></span>
<span id="cb48-3"><a href="#cb48-3"></a>limit <span class="ot">=</span> <span class="dv">100</span></span>
<span id="cb48-4"><a href="#cb48-4"></a></span>
<span id="cb48-5"><a href="#cb48-5"></a>url <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="at">url =</span> <span class="st">"https://api.binance.com/api/v3/klines?symbol="</span>, market ,<span class="st">"&amp;interval="</span>, interval,<span class="st">"&amp;limit="</span>, limit)</span>
<span id="cb48-6"><a href="#cb48-6"></a><span class="fu">print</span>(url) <span class="co"># complete request URL</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "https://api.binance.com/api/v3/klines?symbol=BTCUSDT&amp;interval=1h&amp;limit=100"</code></pre>
</div>
</div>
<p>On the next stage you need use fromJSON() function to get data.</p>
<p>More details about requests to Binanace at https://github.com/binance/binance-spot-api-docs/blob/master/rest-api.md#klinecandlestick-data</p>
<p>If you enter ‘url’ value at browser response is going to be like this:</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode numberSource json number-lines code-with-copy"><code class="sourceCode json"><span id="cb50-1"><a href="#cb50-1"></a><span class="ot">[</span></span>
<span id="cb50-2"><a href="#cb50-2"></a>  <span class="ot">[</span></span>
<span id="cb50-3"><a href="#cb50-3"></a>    <span class="dv">1499040000000</span><span class="ot">,</span>      <span class="er">//</span> <span class="er">Open</span> <span class="er">time</span></span>
<span id="cb50-4"><a href="#cb50-4"></a>    <span class="st">"0.01634790"</span><span class="ot">,</span>       <span class="er">//</span> <span class="er">Open</span></span>
<span id="cb50-5"><a href="#cb50-5"></a>    <span class="st">"0.80000000"</span><span class="ot">,</span>       <span class="er">//</span> <span class="er">High</span></span>
<span id="cb50-6"><a href="#cb50-6"></a>    <span class="st">"0.01575800"</span><span class="ot">,</span>       <span class="er">//</span> <span class="er">Low</span></span>
<span id="cb50-7"><a href="#cb50-7"></a>    <span class="st">"0.01577100"</span><span class="ot">,</span>       <span class="er">//</span> <span class="er">Close</span></span>
<span id="cb50-8"><a href="#cb50-8"></a>    <span class="st">"148976.11427815"</span><span class="ot">,</span>  <span class="er">//</span> <span class="er">Volume</span></span>
<span id="cb50-9"><a href="#cb50-9"></a>    <span class="dv">1499644799999</span><span class="ot">,</span>      <span class="er">//</span> <span class="er">Close</span> <span class="er">time</span></span>
<span id="cb50-10"><a href="#cb50-10"></a>    <span class="st">"2434.19055334"</span><span class="ot">,</span>    <span class="er">//</span> <span class="er">Quote</span> <span class="er">asset</span> <span class="er">volume</span></span>
<span id="cb50-11"><a href="#cb50-11"></a>    <span class="dv">308</span><span class="ot">,</span>                <span class="er">//</span> <span class="er">Number</span> <span class="er">of</span> <span class="er">trades</span></span>
<span id="cb50-12"><a href="#cb50-12"></a>    <span class="st">"1756.87402397"</span><span class="ot">,</span>    <span class="er">//</span> <span class="er">Taker</span> <span class="er">buy</span> <span class="er">base</span> <span class="er">asset</span> <span class="er">volume</span></span>
<span id="cb50-13"><a href="#cb50-13"></a>    <span class="st">"28.46694368"</span><span class="ot">,</span>      <span class="er">//</span> <span class="er">Taker</span> <span class="er">buy</span> <span class="er">quote</span> <span class="er">asset</span> <span class="er">volume</span></span>
<span id="cb50-14"><a href="#cb50-14"></a>    <span class="st">"17928899.62484339"</span> <span class="er">//</span> <span class="er">Ignore.</span></span>
<span id="cb50-15"><a href="#cb50-15"></a>  <span class="ot">]</span></span>
<span id="cb50-16"><a href="#cb50-16"></a><span class="ot">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell" data-execution_count="153">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1"></a>data <span class="ot">&lt;-</span> <span class="fu">fromJSON</span>(url) <span class="co"># get json and transform it to list()</span></span>
<span id="cb51-2"><a href="#cb51-2"></a>data <span class="ot">&lt;-</span> data[, <span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>] <span class="co"># let's left only 1:7 columns (from Open time to Close time)</span></span>
<span id="cb51-3"><a href="#cb51-3"></a><span class="fu">head</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<table class="dataframe table table-sm table-striped">
<caption>A matrix: 6 × 7 of type chr</caption>
<tbody>
    <tr><td>1650513600000</td><td>41693.58000000</td><td>41750.00000000</td><td>41525.00000000</td><td>41610.01000000</td><td>1138.64337000</td><td>1650517199999</td></tr>
    <tr><td>1650517200000</td><td>41610.01000000</td><td>41699.00000000</td><td>41434.44000000</td><td>41462.76000000</td><td>1229.25936000</td><td>1650520799999</td></tr>
    <tr><td>1650520800000</td><td>41462.75000000</td><td>41600.00000000</td><td>41419.20000000</td><td>41522.38000000</td><td>1049.71244000</td><td>1650524399999</td></tr>
    <tr><td>1650524400000</td><td>41522.38000000</td><td>41940.00000000</td><td>41451.00000000</td><td>41855.69000000</td><td>1928.48091000</td><td>1650527999999</td></tr>
    <tr><td>1.650528e+12 </td><td>41855.69000000</td><td>42050.30000000</td><td>41741.10000000</td><td>41922.97000000</td><td>2518.04090000</td><td>1650531599999</td></tr>
    <tr><td>1650531600000</td><td>41922.96000000</td><td>41971.90000000</td><td>41743.96000000</td><td>41803.70000000</td><td>1655.76993000</td><td>1650535199999</td></tr>
</tbody>
</table>
</div>
</div>
<div class="cell" data-execution_count="154">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1"></a><span class="fu">typeof</span>(data) <span class="co"># check data type</span></span>
<span id="cb52-2"><a href="#cb52-2"></a>data <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(data) <span class="co"># convert to dataframe</span></span>
<span id="cb52-3"><a href="#cb52-3"></a><span class="fu">head</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
'character'
</div>
<div class="cell-output cell-output-display">

<table class="dataframe table table-sm table-striped">
<caption>A data.frame: 6 × 7</caption>
<thead>
    <tr><th></th><th scope="col">V1</th><th scope="col">V2</th><th scope="col">V3</th><th scope="col">V4</th><th scope="col">V5</th><th scope="col">V6</th><th scope="col">V7</th></tr>
    <tr><th></th><th scope="col">&lt;chr&gt;</th><th scope="col">&lt;chr&gt;</th><th scope="col">&lt;chr&gt;</th><th scope="col">&lt;chr&gt;</th><th scope="col">&lt;chr&gt;</th><th scope="col">&lt;chr&gt;</th><th scope="col">&lt;chr&gt;</th></tr>
</thead>
<tbody>
    <tr><th scope="row">1</th><td>1650513600000</td><td>41693.58000000</td><td>41750.00000000</td><td>41525.00000000</td><td>41610.01000000</td><td>1138.64337000</td><td>1650517199999</td></tr>
    <tr><th scope="row">2</th><td>1650517200000</td><td>41610.01000000</td><td>41699.00000000</td><td>41434.44000000</td><td>41462.76000000</td><td>1229.25936000</td><td>1650520799999</td></tr>
    <tr><th scope="row">3</th><td>1650520800000</td><td>41462.75000000</td><td>41600.00000000</td><td>41419.20000000</td><td>41522.38000000</td><td>1049.71244000</td><td>1650524399999</td></tr>
    <tr><th scope="row">4</th><td>1650524400000</td><td>41522.38000000</td><td>41940.00000000</td><td>41451.00000000</td><td>41855.69000000</td><td>1928.48091000</td><td>1650527999999</td></tr>
    <tr><th scope="row">5</th><td>1.650528e+12 </td><td>41855.69000000</td><td>42050.30000000</td><td>41741.10000000</td><td>41922.97000000</td><td>2518.04090000</td><td>1650531599999</td></tr>
    <tr><th scope="row">6</th><td>1650531600000</td><td>41922.96000000</td><td>41971.90000000</td><td>41743.96000000</td><td>41803.70000000</td><td>1655.76993000</td><td>1650535199999</td></tr>
</tbody>
</table>
</div>
</div>
<div class="cell" data-execution_count="155">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1"></a><span class="co"># fix columns names</span></span>
<span id="cb53-2"><a href="#cb53-2"></a><span class="fu">colnames</span>(data) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Open_time"</span>, <span class="st">"Open"</span>, <span class="st">"High"</span>, <span class="st">"Low"</span>, <span class="st">"Close"</span>, <span class="st">"Volume"</span>, <span class="st">"Close_time"</span>)</span>
<span id="cb53-3"><a href="#cb53-3"></a><span class="fu">head</span>(data) <span class="co"># looks better, but columns are characters still</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<table class="dataframe table table-sm table-striped">
<caption>A data.frame: 6 × 7</caption>
<thead>
    <tr><th></th><th scope="col">Open_time</th><th scope="col">Open</th><th scope="col">High</th><th scope="col">Low</th><th scope="col">Close</th><th scope="col">Volume</th><th scope="col">Close_time</th></tr>
    <tr><th></th><th scope="col">&lt;chr&gt;</th><th scope="col">&lt;chr&gt;</th><th scope="col">&lt;chr&gt;</th><th scope="col">&lt;chr&gt;</th><th scope="col">&lt;chr&gt;</th><th scope="col">&lt;chr&gt;</th><th scope="col">&lt;chr&gt;</th></tr>
</thead>
<tbody>
    <tr><th scope="row">1</th><td>1650513600000</td><td>41693.58000000</td><td>41750.00000000</td><td>41525.00000000</td><td>41610.01000000</td><td>1138.64337000</td><td>1650517199999</td></tr>
    <tr><th scope="row">2</th><td>1650517200000</td><td>41610.01000000</td><td>41699.00000000</td><td>41434.44000000</td><td>41462.76000000</td><td>1229.25936000</td><td>1650520799999</td></tr>
    <tr><th scope="row">3</th><td>1650520800000</td><td>41462.75000000</td><td>41600.00000000</td><td>41419.20000000</td><td>41522.38000000</td><td>1049.71244000</td><td>1650524399999</td></tr>
    <tr><th scope="row">4</th><td>1650524400000</td><td>41522.38000000</td><td>41940.00000000</td><td>41451.00000000</td><td>41855.69000000</td><td>1928.48091000</td><td>1650527999999</td></tr>
    <tr><th scope="row">5</th><td>1.650528e+12 </td><td>41855.69000000</td><td>42050.30000000</td><td>41741.10000000</td><td>41922.97000000</td><td>2518.04090000</td><td>1650531599999</td></tr>
    <tr><th scope="row">6</th><td>1650531600000</td><td>41922.96000000</td><td>41971.90000000</td><td>41743.96000000</td><td>41803.70000000</td><td>1655.76993000</td><td>1650535199999</td></tr>
</tbody>
</table>
</div>
</div>
<div class="cell" data-execution_count="156">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1"></a><span class="fu">is.numeric</span>(data[,<span class="dv">1</span>]) <span class="co"># check 1st column type is numeric</span></span>
<span id="cb54-2"><a href="#cb54-2"></a><span class="fu">is.numeric</span>(data[,<span class="dv">2</span>]) <span class="co"># check 2nd column type is numeric</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
FALSE
</div>
<div class="cell-output cell-output-display">
FALSE
</div>
</div>
<div class="cell" data-execution_count="157">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1"></a>data <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">sapply</span>(data, as.numeric)) <span class="co"># convert all columns to numeric</span></span>
<span id="cb55-2"><a href="#cb55-2"></a><span class="fu">head</span>(data) <span class="co"># good, its double now</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<table class="dataframe table table-sm table-striped">
<caption>A data.frame: 6 × 7</caption>
<thead>
    <tr><th></th><th scope="col">Open_time</th><th scope="col">Open</th><th scope="col">High</th><th scope="col">Low</th><th scope="col">Close</th><th scope="col">Volume</th><th scope="col">Close_time</th></tr>
    <tr><th></th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th></tr>
</thead>
<tbody>
    <tr><th scope="row">1</th><td>1.650514e+12</td><td>41693.58</td><td>41750.0</td><td>41525.00</td><td>41610.01</td><td>1138.643</td><td>1.650517e+12</td></tr>
    <tr><th scope="row">2</th><td>1.650517e+12</td><td>41610.01</td><td>41699.0</td><td>41434.44</td><td>41462.76</td><td>1229.259</td><td>1.650521e+12</td></tr>
    <tr><th scope="row">3</th><td>1.650521e+12</td><td>41462.75</td><td>41600.0</td><td>41419.20</td><td>41522.38</td><td>1049.712</td><td>1.650524e+12</td></tr>
    <tr><th scope="row">4</th><td>1.650524e+12</td><td>41522.38</td><td>41940.0</td><td>41451.00</td><td>41855.69</td><td>1928.481</td><td>1.650528e+12</td></tr>
    <tr><th scope="row">5</th><td>1.650528e+12</td><td>41855.69</td><td>42050.3</td><td>41741.10</td><td>41922.97</td><td>2518.041</td><td>1.650532e+12</td></tr>
    <tr><th scope="row">6</th><td>1.650532e+12</td><td>41922.96</td><td>41971.9</td><td>41743.96</td><td>41803.70</td><td>1655.770</td><td>1.650535e+12</td></tr>
</tbody>
</table>
</div>
</div>
<p>Final stage is to convert <code>Open_time</code> and <code>Close_time</code> to dates.</p>
<div class="cell" data-execution_count="158">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1"></a>data<span class="sc">$</span>Open_time <span class="ot">&lt;-</span> <span class="fu">as.POSIXct</span>(data<span class="sc">$</span>Open_time<span class="sc">/</span><span class="fl">1e3</span>, <span class="at">origin =</span> <span class="st">'1970-01-01'</span>)</span>
<span id="cb56-2"><a href="#cb56-2"></a>data<span class="sc">$</span>Close_time <span class="ot">&lt;-</span> <span class="fu">as.POSIXct</span>(data<span class="sc">$</span>Close_time<span class="sc">/</span><span class="fl">1e3</span>, <span class="at">origin =</span> <span class="st">'1970-01-01'</span>)</span>
<span id="cb56-3"><a href="#cb56-3"></a></span>
<span id="cb56-4"><a href="#cb56-4"></a><span class="fu">head</span>(data) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<table class="dataframe table table-sm table-striped">
<caption>A data.frame: 6 × 7</caption>
<thead>
    <tr><th></th><th scope="col">Open_time</th><th scope="col">Open</th><th scope="col">High</th><th scope="col">Low</th><th scope="col">Close</th><th scope="col">Volume</th><th scope="col">Close_time</th></tr>
    <tr><th></th><th scope="col">&lt;dttm&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dttm&gt;</th></tr>
</thead>
<tbody>
    <tr><th scope="row">1</th><td>2022-04-21 07:00:00</td><td>41693.58</td><td>41750.0</td><td>41525.00</td><td>41610.01</td><td>1138.643</td><td>2022-04-21 07:59:59</td></tr>
    <tr><th scope="row">2</th><td>2022-04-21 08:00:00</td><td>41610.01</td><td>41699.0</td><td>41434.44</td><td>41462.76</td><td>1229.259</td><td>2022-04-21 08:59:59</td></tr>
    <tr><th scope="row">3</th><td>2022-04-21 09:00:00</td><td>41462.75</td><td>41600.0</td><td>41419.20</td><td>41522.38</td><td>1049.712</td><td>2022-04-21 09:59:59</td></tr>
    <tr><th scope="row">4</th><td>2022-04-21 10:00:00</td><td>41522.38</td><td>41940.0</td><td>41451.00</td><td>41855.69</td><td>1928.481</td><td>2022-04-21 10:59:59</td></tr>
    <tr><th scope="row">5</th><td>2022-04-21 11:00:00</td><td>41855.69</td><td>42050.3</td><td>41741.10</td><td>41922.97</td><td>2518.041</td><td>2022-04-21 11:59:59</td></tr>
    <tr><th scope="row">6</th><td>2022-04-21 12:00:00</td><td>41922.96</td><td>41971.9</td><td>41743.96</td><td>41803.70</td><td>1655.770</td><td>2022-04-21 12:59:59</td></tr>
</tbody>
</table>
</div>
</div>
<div class="cell" data-execution_count="159">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1"></a><span class="fu">tail</span>(data) <span class="co"># check last records</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<table class="dataframe table table-sm table-striped">
<caption>A data.frame: 6 × 7</caption>
<thead>
    <tr><th></th><th scope="col">Open_time</th><th scope="col">Open</th><th scope="col">High</th><th scope="col">Low</th><th scope="col">Close</th><th scope="col">Volume</th><th scope="col">Close_time</th></tr>
    <tr><th></th><th scope="col">&lt;dttm&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dttm&gt;</th></tr>
</thead>
<tbody>
    <tr><th scope="row">95</th><td>2022-04-25 05:00:00</td><td>39095.81</td><td>39153.94</td><td>38961.64</td><td>39091.17</td><td>1205.5158</td><td>2022-04-25 05:59:59</td></tr>
    <tr><th scope="row">96</th><td>2022-04-25 06:00:00</td><td>39091.17</td><td>39294.76</td><td>39086.37</td><td>39253.71</td><td>1443.3318</td><td>2022-04-25 06:59:59</td></tr>
    <tr><th scope="row">97</th><td>2022-04-25 07:00:00</td><td>39253.70</td><td>39256.28</td><td>39055.71</td><td>39139.74</td><td> 896.8554</td><td>2022-04-25 07:59:59</td></tr>
    <tr><th scope="row">98</th><td>2022-04-25 08:00:00</td><td>39139.74</td><td>39230.50</td><td>38947.42</td><td>38975.22</td><td>1057.4900</td><td>2022-04-25 08:59:59</td></tr>
    <tr><th scope="row">99</th><td>2022-04-25 09:00:00</td><td>38975.21</td><td>39057.97</td><td>38590.00</td><td>38636.35</td><td>2814.9716</td><td>2022-04-25 09:59:59</td></tr>
    <tr><th scope="row">100</th><td>2022-04-25 10:00:00</td><td>38636.35</td><td>38675.68</td><td>38200.00</td><td>38534.99</td><td>3528.2355</td><td>2022-04-25 10:59:59</td></tr>
</tbody>
</table>
</div>
</div>
<hr>
</section>
<section id="google-services" class="level2" data-number="4.5">
<h2 data-number="4.5" class="anchored" data-anchor-id="google-services"><span class="header-section-number">4.5</span> Google Services</h2>
<section id="google-spreadsheets" class="level3" data-number="4.5.1">
<h3 data-number="4.5.1" class="anchored" data-anchor-id="google-spreadsheets"><span class="header-section-number">4.5.1</span> Google Spreadsheets</h3>
<blockquote class="blockquote">
<p>THIS CHAPTER IS UNDER CONSTRUCTION / Working with Google Spreadsheets need account authorization.</p>
</blockquote>
<p>googlesheets4 is a package to work with Google Sheets from R.</p>
<div class="cell" data-execution_count="127">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1"></a><span class="co">#install.packages("googlesheets4")</span></span>
<span id="cb58-2"><a href="#cb58-2"></a><span class="fu">library</span>(googlesheets4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>You can read google documents after authentification on google service. There is sample code:</p>
<pre><code>read_sheet("https://docs.google.com/spreadsheets/d/1U6Cf_qEOhiR9AZqTqS3mbMF3zt2db48ZP5v3rkrAEJY/edit#gid=780868077")
gs4_deauth()</code></pre>
<p>Let’s read sample dataset <code>gapminder</code>. It detailed described in next paragraph.</p>
<div class="cell" data-execution_count="128">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1"></a><span class="co"># gs4_example("gapminder")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
</section>
<section id="google-search-trends" class="level3" data-number="4.5.2">
<h3 data-number="4.5.2" class="anchored" data-anchor-id="google-search-trends"><span class="header-section-number">4.5.2</span> Google Search Trends</h3>
<p><strong><code>Google Trends</code></strong> is a service for analyzing search requests by many filters like <code>region</code> (continent, country, locality), <code>period</code> (year, month), <code>information category</code> (business, education, hobby, healthcare), <code>information type</code> (news, shopping, video, images) https://trends.google.com/trends/</p>
<div class="cell" data-execution_count="129">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1"></a><span class="co"># install.packages('gtrendsR')</span></span>
<span id="cb61-2"><a href="#cb61-2"></a><span class="co"># install.packages('ggplot2')</span></span>
<span id="cb61-3"><a href="#cb61-3"></a><span class="fu">library</span>(gtrendsR) <span class="co"># loading package for Google Trends queries</span></span>
<span id="cb61-4"><a href="#cb61-4"></a><span class="fu">library</span>(ggplot2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s configure out google trends query params</p>
<div class="cell" data-execution_count="130">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1"></a>keywords <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Bitcoin"</span>, <span class="st">"FC Barcelona"</span>) <span class="co"># search keywords</span></span>
<span id="cb62-2"><a href="#cb62-2"></a>country <span class="ot">=</span> <span class="fu">c</span>(<span class="st">'AT'</span>) <span class="co"># search region from https://support.google.com/business/answer/6270107?hl=en</span></span>
<span id="cb62-3"><a href="#cb62-3"></a>time <span class="ot">=</span> (<span class="st">"2021-01-01 2021-06-01"</span>) <span class="co"># period</span></span>
<span id="cb62-4"><a href="#cb62-4"></a>channel <span class="ot">=</span> <span class="st">'web'</span> <span class="co"># search channel: google search ('news' - google news, 'images' - google images)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="131">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1"></a><span class="co"># query</span></span>
<span id="cb63-2"><a href="#cb63-2"></a>trends <span class="ot">=</span> <span class="fu">gtrends</span>(keywords, <span class="at">gprop =</span> channel, <span class="at">geo =</span> country, <span class="at">time =</span> time, <span class="at">tz =</span> <span class="st">"UTC"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="132">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1"></a>time_trend <span class="ot">=</span> trends<span class="sc">$</span>interest_over_time</span>
<span id="cb64-2"><a href="#cb64-2"></a><span class="fu">head</span>(time_trend)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<table class="dataframe table table-sm table-striped">
<caption>A data.frame: 6 × 7</caption>
<thead>
    <tr><th></th><th scope="col">date</th><th scope="col">hits</th><th scope="col">keyword</th><th scope="col">geo</th><th scope="col">time</th><th scope="col">gprop</th><th scope="col">category</th></tr>
    <tr><th></th><th scope="col">&lt;dttm&gt;</th><th scope="col">&lt;chr&gt;</th><th scope="col">&lt;chr&gt;</th><th scope="col">&lt;chr&gt;</th><th scope="col">&lt;chr&gt;</th><th scope="col">&lt;chr&gt;</th><th scope="col">&lt;int&gt;</th></tr>
</thead>
<tbody>
    <tr><th scope="row">1</th><td>2021-01-01</td><td>36</td><td>Bitcoin</td><td>AT</td><td>2021-01-01 2021-06-01</td><td>web</td><td>0</td></tr>
    <tr><th scope="row">2</th><td>2021-01-02</td><td>67</td><td>Bitcoin</td><td>AT</td><td>2021-01-01 2021-06-01</td><td>web</td><td>0</td></tr>
    <tr><th scope="row">3</th><td>2021-01-03</td><td>74</td><td>Bitcoin</td><td>AT</td><td>2021-01-01 2021-06-01</td><td>web</td><td>0</td></tr>
    <tr><th scope="row">4</th><td>2021-01-04</td><td>57</td><td>Bitcoin</td><td>AT</td><td>2021-01-01 2021-06-01</td><td>web</td><td>0</td></tr>
    <tr><th scope="row">5</th><td>2021-01-05</td><td>53</td><td>Bitcoin</td><td>AT</td><td>2021-01-01 2021-06-01</td><td>web</td><td>0</td></tr>
    <tr><th scope="row">6</th><td>2021-01-06</td><td>66</td><td>Bitcoin</td><td>AT</td><td>2021-01-01 2021-06-01</td><td>web</td><td>0</td></tr>
</tbody>
</table>
</div>
</div>
<div class="cell" data-execution_count="133">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1"></a>plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>time_trend, <span class="fu">aes</span>(<span class="at">x=</span>date, <span class="at">y=</span>hits, <span class="at">group=</span>keyword, <span class="at">col=</span>keyword)) <span class="sc">+</span></span>
<span id="cb65-2"><a href="#cb65-2"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb65-3"><a href="#cb65-3"></a>  <span class="fu">xlab</span>(<span class="st">'Time'</span>) <span class="sc">+</span> </span>
<span id="cb65-4"><a href="#cb65-4"></a>  <span class="fu">ylab</span>(<span class="st">'Relative Interest'</span>) <span class="sc">+</span> </span>
<span id="cb65-5"><a href="#cb65-5"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_blank</span>(), <span class="at">legend.position=</span><span class="st">"bottom"</span>, <span class="at">legend.text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">15</span>)) <span class="sc">+</span> </span>
<span id="cb65-6"><a href="#cb65-6"></a>  <span class="fu">ggtitle</span>(<span class="st">"Google Search Volume"</span>)  </span>
<span id="cb65-7"><a href="#cb65-7"></a></span>
<span id="cb65-8"><a href="#cb65-8"></a>plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="23-r-xml_files/figure-html/cell-57-output-1.png" class="img-fluid"></p>
</div>
</div>
<hr>
</section>
</section>
<section id="sql-with-sqlite-sample" class="level2" data-number="4.6">
<h2 data-number="4.6" class="anchored" data-anchor-id="sql-with-sqlite-sample"><span class="header-section-number">4.6</span> SQL (with SQLite sample)</h2>
<p>We are going to review working with database on SQLite, becouse it allows us not to install DB-server and start working with simple file.</p>
<p>For now we will use <code>RSQLite</code> package.</p>
<div class="cell" data-execution_count="160">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1"></a><span class="co"># install.packages("RSQLite")</span></span>
<span id="cb66-2"><a href="#cb66-2"></a><span class="fu">library</span>(RSQLite)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="161">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1"></a><span class="co"># let's use mtcars dataset</span></span>
<span id="cb67-2"><a href="#cb67-2"></a></span>
<span id="cb67-3"><a href="#cb67-3"></a><span class="fu">data</span>(<span class="st">"mtcars"</span>) <span class="co"># loads the data</span></span>
<span id="cb67-4"><a href="#cb67-4"></a><span class="fu">head</span>(mtcars) <span class="co"># preview the data</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<table class="dataframe table table-sm table-striped">
<caption>A data.frame: 6 × 11</caption>
<thead>
    <tr><th></th><th scope="col">mpg</th><th scope="col">cyl</th><th scope="col">disp</th><th scope="col">hp</th><th scope="col">drat</th><th scope="col">wt</th><th scope="col">qsec</th><th scope="col">vs</th><th scope="col">am</th><th scope="col">gear</th><th scope="col">carb</th></tr>
    <tr><th></th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th></tr>
</thead>
<tbody>
    <tr><th scope="row">Mazda RX4</th><td>21.0</td><td>6</td><td>160</td><td>110</td><td>3.90</td><td>2.620</td><td>16.46</td><td>0</td><td>1</td><td>4</td><td>4</td></tr>
    <tr><th scope="row">Mazda RX4 Wag</th><td>21.0</td><td>6</td><td>160</td><td>110</td><td>3.90</td><td>2.875</td><td>17.02</td><td>0</td><td>1</td><td>4</td><td>4</td></tr>
    <tr><th scope="row">Datsun 710</th><td>22.8</td><td>4</td><td>108</td><td> 93</td><td>3.85</td><td>2.320</td><td>18.61</td><td>1</td><td>1</td><td>4</td><td>1</td></tr>
    <tr><th scope="row">Hornet 4 Drive</th><td>21.4</td><td>6</td><td>258</td><td>110</td><td>3.08</td><td>3.215</td><td>19.44</td><td>1</td><td>0</td><td>3</td><td>1</td></tr>
    <tr><th scope="row">Hornet Sportabout</th><td>18.7</td><td>8</td><td>360</td><td>175</td><td>3.15</td><td>3.440</td><td>17.02</td><td>0</td><td>0</td><td>3</td><td>2</td></tr>
    <tr><th scope="row">Valiant</th><td>18.1</td><td>6</td><td>225</td><td>105</td><td>2.76</td><td>3.460</td><td>20.22</td><td>1</td><td>0</td><td>3</td><td>1</td></tr>
</tbody>
</table>
</div>
</div>
<blockquote class="blockquote">
<p>I need this code for book successful building (remove database file if exists):</p>
</blockquote>
<div class="cell" data-execution_count="162">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1"></a><span class="co">#Define the file name that will be deleted</span></span>
<span id="cb68-2"><a href="#cb68-2"></a>fn <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"../../data/cars.sqlite"</span>)</span>
<span id="cb68-3"><a href="#cb68-3"></a><span class="co">#Check its existence</span></span>
<span id="cb68-4"><a href="#cb68-4"></a><span class="cf">if</span> (<span class="fu">file.exists</span>(fn)) {</span>
<span id="cb68-5"><a href="#cb68-5"></a>  <span class="co">#Delete file if it exists</span></span>
<span id="cb68-6"><a href="#cb68-6"></a>  <span class="fu">file.remove</span>(fn)</span>
<span id="cb68-7"><a href="#cb68-7"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
TRUE
</div>
</div>
<p>Now, let’s create new:</p>
<div class="cell" data-execution_count="163">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1"></a><span class="co"># create new db file</span></span>
<span id="cb69-2"><a href="#cb69-2"></a>db_path <span class="ot">=</span> <span class="fu">paste0</span>(<span class="st">"../../data/cars.sqlite"</span>)</span>
<span id="cb69-3"><a href="#cb69-3"></a><span class="co"># create connection</span></span>
<span id="cb69-4"><a href="#cb69-4"></a>conn <span class="ot">&lt;-</span> <span class="fu">dbConnect</span>(RSQLite<span class="sc">::</span><span class="fu">SQLite</span>(), </span>
<span id="cb69-5"><a href="#cb69-5"></a>                    db_path,</span>
<span id="cb69-6"><a href="#cb69-6"></a>                    <span class="at">overwrite =</span> <span class="cn">TRUE</span>, <span class="at">append =</span> <span class="cn">FALSE</span>) <span class="co"># for lecture content only</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="164">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1"></a><span class="co"># Write the mtcars dataset into a table names mtcars_data</span></span>
<span id="cb70-2"><a href="#cb70-2"></a><span class="fu">dbWriteTable</span>(conn, <span class="st">"cars_table"</span>, mtcars)</span>
<span id="cb70-3"><a href="#cb70-3"></a><span class="co"># List all the tables available in the database</span></span>
<span id="cb70-4"><a href="#cb70-4"></a><span class="fu">dbListTables</span>(conn)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

'cars_table'
</div>
</div>
<div class="cell" data-execution_count="165">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1"></a>table_data <span class="ot">&lt;-</span> <span class="fu">dbGetQuery</span>(conn, <span class="st">"SELECT * FROM cars_table"</span>)</span>
<span id="cb71-2"><a href="#cb71-2"></a><span class="fu">head</span>(table_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<table class="dataframe table table-sm table-striped">
<caption>A data.frame: 6 × 11</caption>
<thead>
    <tr><th></th><th scope="col">mpg</th><th scope="col">cyl</th><th scope="col">disp</th><th scope="col">hp</th><th scope="col">drat</th><th scope="col">wt</th><th scope="col">qsec</th><th scope="col">vs</th><th scope="col">am</th><th scope="col">gear</th><th scope="col">carb</th></tr>
    <tr><th></th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th></tr>
</thead>
<tbody>
    <tr><th scope="row">1</th><td>21.0</td><td>6</td><td>160</td><td>110</td><td>3.90</td><td>2.620</td><td>16.46</td><td>0</td><td>1</td><td>4</td><td>4</td></tr>
    <tr><th scope="row">2</th><td>21.0</td><td>6</td><td>160</td><td>110</td><td>3.90</td><td>2.875</td><td>17.02</td><td>0</td><td>1</td><td>4</td><td>4</td></tr>
    <tr><th scope="row">3</th><td>22.8</td><td>4</td><td>108</td><td> 93</td><td>3.85</td><td>2.320</td><td>18.61</td><td>1</td><td>1</td><td>4</td><td>1</td></tr>
    <tr><th scope="row">4</th><td>21.4</td><td>6</td><td>258</td><td>110</td><td>3.08</td><td>3.215</td><td>19.44</td><td>1</td><td>0</td><td>3</td><td>1</td></tr>
    <tr><th scope="row">5</th><td>18.7</td><td>8</td><td>360</td><td>175</td><td>3.15</td><td>3.440</td><td>17.02</td><td>0</td><td>0</td><td>3</td><td>2</td></tr>
    <tr><th scope="row">6</th><td>18.1</td><td>6</td><td>225</td><td>105</td><td>2.76</td><td>3.460</td><td>20.22</td><td>1</td><td>0</td><td>3</td><td>1</td></tr>
</tbody>
</table>
</div>
</div>
<div class="cell" data-execution_count="166">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1"></a><span class="co"># close connection</span></span>
<span id="cb72-2"><a href="#cb72-2"></a><span class="fu">dbDisconnect</span>(conn)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>You can write complex queries for many tables if you knowledge of SQL allows.</p>
<hr>
</section>
<section id="web-pages-html" class="level2" data-number="4.7">
<h2 data-number="4.7" class="anchored" data-anchor-id="web-pages-html"><span class="header-section-number">4.7</span> Web-pages (HTML)</h2>
<p>Sometimes decision making needs scrap data from web sources and pages.</p>
<p>Let’s try to parse data from <code>Wikipedia</code> as table.</p>
<div class="cell" data-execution_count="170">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1"></a><span class="co">#install.packages("rvest")</span></span>
<span id="cb73-2"><a href="#cb73-2"></a><span class="fu">library</span>(rvest) <span class="co"># Parsing of HTML/XML files</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Go to web page https://en.wikipedia.org/wiki/List_of_largest_banks and check it.</p>
<div class="cell" data-execution_count="171">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1"></a><span class="co"># fix URL</span></span>
<span id="cb74-2"><a href="#cb74-2"></a>url <span class="ot">&lt;-</span> <span class="st">"https://en.wikipedia.org/wiki/List_of_largest_banks"</span></span>
<span id="cb74-3"><a href="#cb74-3"></a><span class="co">#url &lt;- "data/List of largest banks - Wikipedia_.html"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="172">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1"></a><span class="co"># read html content of the page</span></span>
<span id="cb75-2"><a href="#cb75-2"></a>page <span class="ot">&lt;-</span> <span class="fu">read_html</span>(url)</span>
<span id="cb75-3"><a href="#cb75-3"></a>page</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>{html_document}
&lt;html class="client-nojs" lang="en" dir="ltr"&gt;
[1] &lt;head&gt;\n&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8 ...
[2] &lt;body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject  ...</code></pre>
</div>
</div>
<div class="cell" data-execution_count="173">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1"></a><span class="co"># read all yables on page</span></span>
<span id="cb77-2"><a href="#cb77-2"></a>tables <span class="ot">&lt;-</span> <span class="fu">html_nodes</span>(page, <span class="st">"table"</span>)</span>
<span id="cb77-3"><a href="#cb77-3"></a>tables</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>{xml_nodeset (4)}
[1] &lt;table class="box-Missing_information plainlinks metadata ambox ambox-con ...
[2] &lt;table class="wikitable sortable mw-collapsible"&gt;&lt;tbody&gt;\n&lt;tr&gt;\n&lt;th data- ...
[3] &lt;table class="wikitable sortable mw-collapsible"&gt;\n&lt;caption&gt;Number of ban ...
[4] &lt;table class="wikitable sortable mw-collapsible"&gt;&lt;tbody&gt;\n&lt;tr&gt;\n&lt;th data- ...</code></pre>
</div>
</div>
<p>For now, let’s read a table of Total Assets in US Billion</p>
<div class="cell" data-execution_count="174">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1"></a><span class="co"># with pipe operator</span></span>
<span id="cb79-2"><a href="#cb79-2"></a><span class="co">#tables[2] %&gt;% </span></span>
<span id="cb79-3"><a href="#cb79-3"></a> <span class="co">#   html_table(fill = TRUE) %&gt;% </span></span>
<span id="cb79-4"><a href="#cb79-4"></a> <span class="co">#   as.data.frame()</span></span>
<span id="cb79-5"><a href="#cb79-5"></a><span class="co">#without pipe operator</span></span>
<span id="cb79-6"><a href="#cb79-6"></a>assets_table <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">html_table</span>(tables[<span class="dv">2</span>], <span class="at">fill =</span> <span class="cn">TRUE</span>))   </span>
<span id="cb79-7"><a href="#cb79-7"></a><span class="fu">head</span>(assets_table)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<table class="dataframe table table-sm table-striped">
<caption>A data.frame: 6 × 3</caption>
<thead>
    <tr><th></th><th scope="col">Rank</th><th scope="col">Bank.name</th><th scope="col">Total.assets.2020..US..billion.</th></tr>
    <tr><th></th><th scope="col">&lt;int&gt;</th><th scope="col">&lt;chr&gt;</th><th scope="col">&lt;chr&gt;</th></tr>
</thead>
<tbody>
    <tr><th scope="row">1</th><td>1</td><td>Industrial and Commercial Bank of China</td><td>5,518.00</td></tr>
    <tr><th scope="row">2</th><td>2</td><td>China Construction Bank                </td><td>4,400.00</td></tr>
    <tr><th scope="row">3</th><td>3</td><td>Agricultural Bank of China             </td><td>4,300.00</td></tr>
    <tr><th scope="row">4</th><td>4</td><td>Bank of China                          </td><td>4,200.00</td></tr>
    <tr><th scope="row">5</th><td>5</td><td>JPMorgan Chase                         </td><td>3,831.65</td></tr>
    <tr><th scope="row">6</th><td>6</td><td>Mitsubishi UFJ Financial Group         </td><td>3,175.21</td></tr>
</tbody>
</table>
</div>
</div>
<p>Next is reading data of market capitalization table (4th):</p>
<div class="cell" data-execution_count="175">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1"></a>capital_table <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">html_table</span>(tables[<span class="dv">4</span>], <span class="at">fill =</span> <span class="cn">TRUE</span>))   </span>
<span id="cb80-2"><a href="#cb80-2"></a><span class="fu">head</span>(capital_table)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<table class="dataframe table table-sm table-striped">
<caption>A data.frame: 6 × 3</caption>
<thead>
    <tr><th></th><th scope="col">Rank</th><th scope="col">Bank.name</th><th scope="col">Market.cap.US..billion.</th></tr>
    <tr><th></th><th scope="col">&lt;int&gt;</th><th scope="col">&lt;chr&gt;</th><th scope="col">&lt;dbl&gt;</th></tr>
</thead>
<tbody>
    <tr><th scope="row">1</th><td>1</td><td>JPMorgan Chase                         </td><td>368.78</td></tr>
    <tr><th scope="row">2</th><td>2</td><td>Industrial and Commercial Bank of China</td><td>295.65</td></tr>
    <tr><th scope="row">3</th><td>3</td><td>Bank of America                        </td><td>279.73</td></tr>
    <tr><th scope="row">4</th><td>4</td><td>Wells Fargo                            </td><td>214.34</td></tr>
    <tr><th scope="row">5</th><td>5</td><td>China Construction Bank                </td><td>207.98</td></tr>
    <tr><th scope="row">6</th><td>6</td><td>Agricultural Bank of China             </td><td>181.49</td></tr>
</tbody>
</table>
</div>
</div>
<p>And now let’s <code>merge()</code> this two datasets:</p>
<div class="cell" data-execution_count="176">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1"></a>merged_data <span class="ot">&lt;-</span> <span class="fu">merge</span>(assets_table, capital_table, <span class="at">by =</span> <span class="st">"Bank.name"</span>)</span>
<span id="cb81-2"><a href="#cb81-2"></a><span class="fu">head</span>(merged_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<table class="dataframe table table-sm table-striped">
<caption>A data.frame: 6 × 5</caption>
<thead>
    <tr><th></th><th scope="col">Bank.name</th><th scope="col">Rank.x</th><th scope="col">Total.assets.2020..US..billion.</th><th scope="col">Rank.y</th><th scope="col">Market.cap.US..billion.</th></tr>
    <tr><th></th><th scope="col">&lt;chr&gt;</th><th scope="col">&lt;int&gt;</th><th scope="col">&lt;chr&gt;</th><th scope="col">&lt;int&gt;</th><th scope="col">&lt;dbl&gt;</th></tr>
</thead>
<tbody>
    <tr><th scope="row">1</th><td>Agricultural Bank of China             </td><td> 3</td><td>4,300.00</td><td> 6</td><td>181.49</td></tr>
    <tr><th scope="row">2</th><td>Australia and New Zealand Banking Group</td><td>48</td><td>661.72  </td><td>26</td><td> 54.88</td></tr>
    <tr><th scope="row">3</th><td>Banco Bilbao Vizcaya Argentaria        </td><td>42</td><td>782.16  </td><td>37</td><td> 37.42</td></tr>
    <tr><th scope="row">4</th><td>Banco Bradesco                         </td><td>79</td><td>345.21  </td><td>18</td><td> 74.67</td></tr>
    <tr><th scope="row">5</th><td>Banco Santander                        </td><td>16</td><td>1,702.61</td><td>17</td><td> 75.47</td></tr>
    <tr><th scope="row">6</th><td>Bank of America                        </td><td> 8</td><td>2,434.08</td><td> 3</td><td>279.73</td></tr>
</tbody>
</table>
</div>
</div>
<section id="task-3" class="level3" data-number="4.7.1">
<h3 data-number="4.7.1" class="anchored" data-anchor-id="task-3"><span class="header-section-number">4.7.1</span> Task 3</h3>
<p>From a page https://en.wikipedia.org/wiki/List_of_largest_banks read and <code>merge by country</code> named tables:</p>
<ul class="task-list">
<li><input type="checkbox" disabled="" checked="">Number of banks in the top 100 by total assets</li>
<li><input type="checkbox" disabled="" checked="">Total market capital (US$ billion) across the top 70 banks by country</li>
</ul>
<p><strong>Solution</strong></p>
<div class="cell" data-execution_count="178">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1"></a><span class="fu">library</span>(rvest)</span>
<span id="cb82-2"><a href="#cb82-2"></a>url <span class="ot">&lt;-</span> <span class="st">"https://en.wikipedia.org/wiki/List_of_largest_banks"</span> <span class="co"># got to url in other tab</span></span>
<span id="cb82-3"><a href="#cb82-3"></a><span class="co">#url &lt;- "data/List of largest banks - Wikipedia_.html"</span></span>
<span id="cb82-4"><a href="#cb82-4"></a>page_data <span class="ot">&lt;-</span> <span class="fu">read_html</span>(url) <span class="co"># read html content</span></span>
<span id="cb82-5"><a href="#cb82-5"></a></span>
<span id="cb82-6"><a href="#cb82-6"></a>tables <span class="ot">&lt;-</span> <span class="fu">html_nodes</span>(page_data, <span class="st">"table"</span>)</span>
<span id="cb82-7"><a href="#cb82-7"></a><span class="fu">html_table</span>(tables[<span class="dv">1</span>]) <span class="co">#its not needed table</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<ol>
    <li><table class="dataframe table table-sm table-striped">
<caption>A tibble: 1 <u+00d7> 2</u+00d7></caption>
<thead>
    <tr><th scope="col">X1</th><th scope="col">X2</th></tr>
    <tr><th scope="col">&lt;lgl&gt;</th><th scope="col">&lt;chr&gt;</th></tr>
</thead>
<tbody>
    <tr><td>NA</td><td>This article is missing information about Revenue and Employment. Please expand the article to include this information. Further details may exist on the talk page.  (September 2020)</td></tr>
</tbody>
</table>
</li>
</ol>
</div>
</div>
<div class="cell" data-execution_count="179">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1"></a><span class="fu">html_table</span>(tables[<span class="dv">3</span>]) <span class="co"># thats solution for "Number of banks in the top 100 by total assets"</span></span>
<span id="cb83-2"><a href="#cb83-2"></a><span class="co">#check the end of table. There are NA record</span></span>
<span id="cb83-3"><a href="#cb83-3"></a><span class="co"># lets remove it</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<ol>
    <li><table class="dataframe table table-sm table-striped">
<caption>A tibble: 26 <u+00d7> 3</u+00d7></caption>
<thead>
    <tr><th scope="col">Rank</th><th scope="col">Country</th><th scope="col">Number</th></tr>
    <tr><th scope="col">&lt;int&gt;</th><th scope="col">&lt;chr&gt;</th><th scope="col">&lt;int&gt;</th></tr>
</thead>
<tbody>
    <tr><td>1</td><td>China         </td><td>19</td></tr>
    <tr><td>2</td><td>United States </td><td>11</td></tr>
    <tr><td>3</td><td>Japan         </td><td> 8</td></tr>
    <tr><td>4</td><td>United Kingdom</td><td> 6</td></tr>
    <tr><td>4</td><td>France        </td><td> 6</td></tr>
    <tr><td>4</td><td>South Korea   </td><td> 6</td></tr>
    <tr><td>5</td><td>Canada        </td><td> 5</td></tr>
    <tr><td>5</td><td>Germany       </td><td> 5</td></tr>
    <tr><td>6</td><td>Australia     </td><td> 4</td></tr>
    <tr><td>6</td><td>Brazil        </td><td> 4</td></tr>
    <tr><td>6</td><td>Spain         </td><td> 4</td></tr>
    <tr><td>7</td><td>Netherlands   </td><td> 3</td></tr>
    <tr><td>7</td><td>Singapore     </td><td> 3</td></tr>
    <tr><td>7</td><td>Sweden        </td><td> 3</td></tr>
    <tr><td>7</td><td>Switzerland   </td><td> 3</td></tr>
    <tr><td>8</td><td>Italy         </td><td> 2</td></tr>
    <tr><td>9</td><td>India         </td><td> 1</td></tr>
    <tr><td>9</td><td>Austria       </td><td> 1</td></tr>
    <tr><td>9</td><td>Belgium       </td><td> 1</td></tr>
    <tr><td>9</td><td>Denmark       </td><td> 1</td></tr>
    <tr><td>9</td><td>Finland       </td><td> 1</td></tr>
    <tr><td>9</td><td>Norway        </td><td> 1</td></tr>
    <tr><td>9</td><td>Russia        </td><td> 1</td></tr>
    <tr><td>9</td><td>Qatar         </td><td> 1</td></tr>
    <tr><td>9</td><td>NA            </td><td>NA</td></tr>
    <tr><td>9</td><td>NA            </td><td>NA</td></tr>
</tbody>
</table>
</li>
</ol>
</div>
</div>
<div class="cell" data-execution_count="180">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1"></a>table1 <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">html_table</span>(tables[<span class="dv">3</span>]))</span>
<span id="cb84-2"><a href="#cb84-2"></a>table1 <span class="ot">&lt;-</span> table1[<span class="sc">!</span><span class="fu">is.na</span>(table1<span class="sc">$</span>Country), ]</span>
<span id="cb84-3"><a href="#cb84-3"></a>table1 <span class="co"># now it OK!</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<table class="dataframe table table-sm table-striped">
<caption>A data.frame: 24 × 3</caption>
<thead>
    <tr><th></th><th scope="col">Rank</th><th scope="col">Country</th><th scope="col">Number</th></tr>
    <tr><th></th><th scope="col">&lt;int&gt;</th><th scope="col">&lt;chr&gt;</th><th scope="col">&lt;int&gt;</th></tr>
</thead>
<tbody>
    <tr><th scope="row">1</th><td>1</td><td>China         </td><td>19</td></tr>
    <tr><th scope="row">2</th><td>2</td><td>United States </td><td>11</td></tr>
    <tr><th scope="row">3</th><td>3</td><td>Japan         </td><td> 8</td></tr>
    <tr><th scope="row">4</th><td>4</td><td>United Kingdom</td><td> 6</td></tr>
    <tr><th scope="row">5</th><td>4</td><td>France        </td><td> 6</td></tr>
    <tr><th scope="row">6</th><td>4</td><td>South Korea   </td><td> 6</td></tr>
    <tr><th scope="row">7</th><td>5</td><td>Canada        </td><td> 5</td></tr>
    <tr><th scope="row">8</th><td>5</td><td>Germany       </td><td> 5</td></tr>
    <tr><th scope="row">9</th><td>6</td><td>Australia     </td><td> 4</td></tr>
    <tr><th scope="row">10</th><td>6</td><td>Brazil        </td><td> 4</td></tr>
    <tr><th scope="row">11</th><td>6</td><td>Spain         </td><td> 4</td></tr>
    <tr><th scope="row">12</th><td>7</td><td>Netherlands   </td><td> 3</td></tr>
    <tr><th scope="row">13</th><td>7</td><td>Singapore     </td><td> 3</td></tr>
    <tr><th scope="row">14</th><td>7</td><td>Sweden        </td><td> 3</td></tr>
    <tr><th scope="row">15</th><td>7</td><td>Switzerland   </td><td> 3</td></tr>
    <tr><th scope="row">16</th><td>8</td><td>Italy         </td><td> 2</td></tr>
    <tr><th scope="row">17</th><td>9</td><td>India         </td><td> 1</td></tr>
    <tr><th scope="row">18</th><td>9</td><td>Austria       </td><td> 1</td></tr>
    <tr><th scope="row">19</th><td>9</td><td>Belgium       </td><td> 1</td></tr>
    <tr><th scope="row">20</th><td>9</td><td>Denmark       </td><td> 1</td></tr>
    <tr><th scope="row">21</th><td>9</td><td>Finland       </td><td> 1</td></tr>
    <tr><th scope="row">22</th><td>9</td><td>Norway        </td><td> 1</td></tr>
    <tr><th scope="row">23</th><td>9</td><td>Russia        </td><td> 1</td></tr>
    <tr><th scope="row">24</th><td>9</td><td>Qatar         </td><td> 1</td></tr>
</tbody>
</table>
</div>
</div>
<div class="cell" data-execution_count="183">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1"></a><span class="co"># SOlution for "Total market capital (US$ billion) across the top 70 banks by country"</span></span>
<span id="cb85-2"><a href="#cb85-2"></a><span class="co"># compare this with table on a given page</span></span>
<span id="cb85-3"><a href="#cb85-3"></a>table2 <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">html_table</span>(tables[<span class="dv">4</span>]))</span>
<span id="cb85-4"><a href="#cb85-4"></a>table2 <span class="co"># now it OK!</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<table class="dataframe table table-sm table-striped">
<caption>A data.frame: 50 × 3</caption>
<thead>
    <tr><th scope="col">Rank</th><th scope="col">Bank.name</th><th scope="col">Market.cap.US..billion.</th></tr>
    <tr><th scope="col">&lt;int&gt;</th><th scope="col">&lt;chr&gt;</th><th scope="col">&lt;dbl&gt;</th></tr>
</thead>
<tbody>
    <tr><td> 1</td><td>JPMorgan Chase                         </td><td>368.78</td></tr>
    <tr><td> 2</td><td>Industrial and Commercial Bank of China</td><td>295.65</td></tr>
    <tr><td> 3</td><td>Bank of America                        </td><td>279.73</td></tr>
    <tr><td> 4</td><td>Wells Fargo                            </td><td>214.34</td></tr>
    <tr><td> 5</td><td>China Construction Bank                </td><td>207.98</td></tr>
    <tr><td> 6</td><td>Agricultural Bank of China             </td><td>181.49</td></tr>
    <tr><td> 7</td><td>HSBC Holdings PLC                      </td><td>169.47</td></tr>
    <tr><td> 8</td><td>Citigroup Inc.                         </td><td>163.58</td></tr>
    <tr><td> 9</td><td>Bank of China                          </td><td>151.15</td></tr>
    <tr><td>10</td><td>China Merchants Bank                   </td><td>133.37</td></tr>
    <tr><td>11</td><td>Royal Bank of Canada                   </td><td>113.80</td></tr>
    <tr><td>12</td><td>Toronto-Dominion Bank                  </td><td>106.61</td></tr>
    <tr><td>13</td><td>Commonwealth Bank                      </td><td> 99.77</td></tr>
    <tr><td>14</td><td>HDFC Bank                              </td><td>105.90</td></tr>
    <tr><td>15</td><td>U.S. Bancorp                           </td><td> 84.40</td></tr>
    <tr><td>16</td><td>Goldman Sachs                          </td><td> 78.70</td></tr>
    <tr><td>17</td><td>Banco Santander                        </td><td> 75.47</td></tr>
    <tr><td>18</td><td>Banco Bradesco                         </td><td> 74.67</td></tr>
    <tr><td>19</td><td>Morgan Stanley                         </td><td> 73.93</td></tr>
    <tr><td>20</td><td>Westpac                                </td><td> 67.84</td></tr>
    <tr><td>21</td><td>Mitsubishi UFJ Financial Group         </td><td> 66.20</td></tr>
    <tr><td>22</td><td>Scotiabank                             </td><td> 65.48</td></tr>
    <tr><td>23</td><td>PNC Financial Services                 </td><td> 63.11</td></tr>
    <tr><td>24</td><td>Bank of Communications                 </td><td> 61.85</td></tr>
    <tr><td>25</td><td>BNP Paribas                            </td><td> 59.36</td></tr>
    <tr><td>26</td><td>Australia and New Zealand Banking Group</td><td> 54.88</td></tr>
    <tr><td>27</td><td>National Australia Bank                </td><td> 51.68</td></tr>
    <tr><td>28</td><td>Lloyds Banking Group                   </td><td> 51.19</td></tr>
    <tr><td>29</td><td>Sumitomo Mitsui Financial Group        </td><td> 49.85</td></tr>
    <tr><td>30</td><td>Bank of Montreal                       </td><td> 48.12</td></tr>
    <tr><td>31</td><td>UBS                                    </td><td> 45.92</td></tr>
    <tr><td>32</td><td>ING Group                              </td><td> 44.97</td></tr>
    <tr><td>33</td><td>Capital One                            </td><td> 43.22</td></tr>
    <tr><td>34</td><td>The Bank of New York Mellon            </td><td> 42.58</td></tr>
    <tr><td>35</td><td>China Minsheng Bank                    </td><td> 39.13</td></tr>
    <tr><td>36</td><td>China CITIC Bank                       </td><td> 38.55</td></tr>
    <tr><td>37</td><td>Banco Bilbao Vizcaya Argentaria        </td><td> 37.42</td></tr>
    <tr><td>38</td><td>Mizuho Financial Group                 </td><td> 36.95</td></tr>
    <tr><td>39</td><td>Intesa Sanpaolo                        </td><td> 36.90</td></tr>
    <tr><td>40</td><td>Credit Agricole                        </td><td> 34.89</td></tr>
    <tr><td>41</td><td>Canadian Imperial Bank of Commerce     </td><td> 34.87</td></tr>
    <tr><td>42</td><td>Royal Bank of Scotland                 </td><td> 33.95</td></tr>
    <tr><td>43</td><td>Barclays                               </td><td> 33.26</td></tr>
    <tr><td>44</td><td>Credit Suisse                          </td><td> 30.75</td></tr>
    <tr><td>45</td><td>Nordea                                 </td><td> 29.59</td></tr>
    <tr><td>46</td><td>Standard Chartered                     </td><td> 29.37</td></tr>
    <tr><td>47</td><td>KBC Bank                               </td><td> 27.40</td></tr>
    <tr><td>48</td><td>UniCredit                              </td><td> 26.88</td></tr>
    <tr><td>49</td><td>Societe Generale                       </td><td> 21.27</td></tr>
    <tr><td>50</td><td>Deutsche Bank                          </td><td> 15.77</td></tr>
</tbody>
</table>
</div>
</div>
<hr>
</section>
</section>
<section id="набори-даних" class="level2" data-number="4.8">
<h2 data-number="4.8" class="anchored" data-anchor-id="набори-даних"><span class="header-section-number">4.8</span> Набори даних</h2>
<ol type="1">
<li>https://github.com/kleban/r-book-published/tree/main/datasets/telecom_users.csv</li>
<li>https://github.com/kleban/r-book-published/tree/main/datasets/telecom_sers.xlsx</li>
<li>https://github.com/kleban/r-book-published/tree/main/datasets/Default_Fin.csv</li>
<li>https://github.com/kleban/r-book-published/tree/main/datasets/employes.xml</li>
</ol>
<hr>
</section>
<section id="references" class="level2" data-number="4.9">
<h2 data-number="4.9" class="anchored" data-anchor-id="references"><span class="header-section-number">4.9</span> References</h2>
<ol type="1">
<li><a href="https://www.datacamp.com/community/tutorials/sqlite-in-r">SQLite in R. Datacamp</a></li>
<li><a href="https://www.tidyverse.org/blog/2020/05/googlesheets4-0-2-0/">Tidyverse googlesheets4 0.2.0</a> <!-- 3. [Telecom users dataset. Practice classification with a telco dataset.Kaggle](https://www.kaggle.com/radmirzosimov/telecom-users-dataset) --></li>
<li><a href="https://github.com/binance/binance-spot-api-docs/blob/master/rest-api.md#klinecandlestick-data">Binanace spot Api Docs</a></li>
<li><a href="https://www.datacamp.com/community/tutorials/r-web-scraping-rvest">Web Scraping in R: rvest Tutorial</a> by Arvid Kingl</li>
</ol>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./22-r-csv.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Data collection and saving</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./references.html" class="pagination-link">
        <span class="nav-page-text">Список використаних джерел</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
      <div class="nav-footer-center">Copyright 2023, Юрій Клебан</div>
  </div>
</footer>



</body></html>