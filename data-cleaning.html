<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.251">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Основи роботи з даними в R - 20&nbsp; Підготовка та очистка даних у R</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./references.html" rel="next">
<link href="./39-r-wide-to-long.html" rel="prev">
<link href="./img/favicon.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="css/style.css">
</head>

<body class="nav-sidebar floating">


<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Підготовка та очистка даних у R</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Основи роботи з даними в R</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/kleban/data-r/" title="Source Code" class="sidebar-tool px-1"><i class="bi bi-github"></i></a>
    <a href="" title="Share" id="sidebar-tool-dropdown-0" class="sidebar-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi bi-share"></i></a>
    <ul class="dropdown-menu" aria-labelledby="sidebar-tool-dropdown-0">
        <li>
          <a class="dropdown-item sidebar-tools-main-item" href="https://twitter.com/intent/tweet?url=|url|">
            <i class="bi bi-bi-twitter pe-1"></i>
          Twitter
          </a>
        </li>
        <li>
          <a class="dropdown-item sidebar-tools-main-item" href="https://www.facebook.com/sharer/sharer.php?u=|url|">
            <i class="bi bi-bi-facebook pe-1"></i>
          Facebook
          </a>
        </li>
        <li>
          <a class="dropdown-item sidebar-tools-main-item" href="https://www.linkedin.com/sharing/share-offsite/?url=|url|">
            <i class="bi bi-bi-linkedin pe-1"></i>
          LinkedIn
          </a>
        </li>
    </ul>
</div>
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Про посібник</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00-intro.html" class="sidebar-item-text sidebar-link">Вступ</a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">ТЕМА 1. ВСТУП ДО РОБОТИ З ДАНИМИ</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-r-data-read-intro.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Загальна інформація + презентація</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">ТЕМА 2. ЧИТАННЯ ДАНИХ</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./20-r-data-read-intro.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Загальна інформація + презентація</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./22-r-csv.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">CSV</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./23-r-xlsx.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">MS Excel (xlsx)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./24-r-xml.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">XML</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./25-r-api-json.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">JSON and API</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./26-r-google.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Google Services</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./27-r-sql.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">SQL (with SQLite sample)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./28-r-html.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Web-pages (HTML)</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">ТЕМА 3. МАНІПУЛЮВАННЯ ДАНИМИ У <code>dplyr</code></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./30-r-what-is-dplyr.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">What’s <code>dplyr</code> package [EN]</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./31-r-data-explore.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Exploring data with <code>dplyr</code></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./32-r-data-slice.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Subset rows with <code>slice()</code></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./33-r-data-sorting.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Sorting with <strong><code>arrange()</code></strong></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./34-r-data-mutating.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Create new variables with <strong><code>mutate()</code></strong></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./35-r-data-rename.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Renaming columns with <strong><code>rename()</code></strong></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./36-r-data-grouping.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Grouping columns with <strong><code>dplyr</code></strong></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./37-r-data-bind.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Binding rows and columns</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./38-r-data-join.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title"><code>Join()</code>-ing data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./39-r-wide-to-long.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Wide-to-long tables</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">ТЕМА 4. СПОСОБИ ОЧИСТКИ ДАНИХ</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-cleaning.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Підготовка та очистка даних у R</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">Список використаних джерел</a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Зміст</h2>
   
  <ul>
  <li><a href="#поняття-та-виміри-оцінки-якості-даних" id="toc-поняття-та-виміри-оцінки-якості-даних" class="nav-link active" data-scroll-target="#поняття-та-виміри-оцінки-якості-даних"><span class="toc-section-number">20.1</span>  Поняття та виміри оцінки якості даних</a>
  <ul class="collapse">
  <li><a href="#що-таке-валідація-даних" id="toc-що-таке-валідація-даних" class="nav-link" data-scroll-target="#що-таке-валідація-даних"><span class="toc-section-number">20.1.1</span>  Що таке валідація даних?</a></li>
  <li><a href="#правильність-accuracy" id="toc-правильність-accuracy" class="nav-link" data-scroll-target="#правильність-accuracy"><span class="toc-section-number">20.1.2</span>  Правильність / (Accuracy)</a></li>
  <li><a href="#повнота-completeness" id="toc-повнота-completeness" class="nav-link" data-scroll-target="#повнота-completeness"><span class="toc-section-number">20.1.3</span>  Повнота / (Completeness)</a></li>
  <li><a href="#узгодженість-consistency" id="toc-узгодженість-consistency" class="nav-link" data-scroll-target="#узгодженість-consistency"><span class="toc-section-number">20.1.4</span>  Узгодженість / Consistency</a></li>
  <li><a href="#відповідність-conformity" id="toc-відповідність-conformity" class="nav-link" data-scroll-target="#відповідність-conformity"><span class="toc-section-number">20.1.5</span>  Відповідність / Conformity</a></li>
  <li><a href="#цілісність-integrity" id="toc-цілісність-integrity" class="nav-link" data-scroll-target="#цілісність-integrity"><span class="toc-section-number">20.1.6</span>  Цілісність / Integrity</a></li>
  <li><a href="#своєчасність-timeliness" id="toc-своєчасність-timeliness" class="nav-link" data-scroll-target="#своєчасність-timeliness"><span class="toc-section-number">20.1.7</span>  Своєчасність / Timeliness</a></li>
  </ul></li>
  <li><a href="#робота-з-неіменованими-та-поганоіменованими-даними" id="toc-робота-з-неіменованими-та-поганоіменованими-даними" class="nav-link" data-scroll-target="#робота-з-неіменованими-та-поганоіменованими-даними"><span class="toc-section-number">20.2</span>  Робота з неіменованими та “поганоіменованими” даними</a>
  <ul class="collapse">
  <li><a href="#іменування-даних" id="toc-іменування-даних" class="nav-link" data-scroll-target="#іменування-даних"><span class="toc-section-number">20.2.1</span>  Іменування даних</a></li>
  <li><a href="#заміна-назв-стовпців-data.frame" id="toc-заміна-назв-стовпців-data.frame" class="nav-link" data-scroll-target="#заміна-назв-стовпців-data.frame"><span class="toc-section-number">20.2.2</span>  Заміна назв стовпців data.frame </a><a class="anchor nav-link" id="id22" data-scroll-target="undefined"></a></li>
  <li><a href="#підготовка-та-очистка-текстової-інформації" id="toc-підготовка-та-очистка-текстової-інформації" class="nav-link" data-scroll-target="#підготовка-та-очистка-текстової-інформації"><span class="toc-section-number">20.2.3</span>  Підготовка та очистка текстової інформації</a></li>
  </ul></li>
  <li><a href="#заміна-пропусків-у-даних-missing-value-imputation" id="toc-заміна-пропусків-у-даних-missing-value-imputation" class="nav-link" data-scroll-target="#заміна-пропусків-у-даних-missing-value-imputation"><span class="toc-section-number">20.3</span>  Заміна пропусків у даних (Missing Value Imputation)</a>
  <ul class="collapse">
  <li><a href="#перевірка-наявності-пропусків-у-даних" id="toc-перевірка-наявності-пропусків-у-даних" class="nav-link" data-scroll-target="#перевірка-наявності-пропусків-у-даних"><span class="toc-section-number">20.3.1</span>  Перевірка наявності пропусків у даних</a></li>
  <li><a href="#видалення-пустих-рядків-та-сповпців-у-data.frame" id="toc-видалення-пустих-рядків-та-сповпців-у-data.frame" class="nav-link" data-scroll-target="#видалення-пустих-рядків-та-сповпців-у-data.frame"><span class="toc-section-number">20.3.2</span>  Видалення пустих рядків та сповпців у <code>data.frame</code></a></li>
  <li><a href="#заміна-пропусків-у-data.frame" id="toc-заміна-пропусків-у-data.frame" class="nav-link" data-scroll-target="#заміна-пропусків-у-data.frame"><span class="toc-section-number">20.3.3</span>  Заміна пропусків у <code>data.frame</code></a></li>
  </ul></li>
  <li><a href="#аналіз-та-обробка-статистичних-викидів-у-даних" id="toc-аналіз-та-обробка-статистичних-викидів-у-даних" class="nav-link" data-scroll-target="#аналіз-та-обробка-статистичних-викидів-у-даних"><span class="toc-section-number">20.4</span>  Аналіз та обробка статистичних викидів у даних</a></li>
  <li><a href="#додаткові-прийоми-очистки-даних" id="toc-додаткові-прийоми-очистки-даних" class="nav-link" data-scroll-target="#додаткові-прийоми-очистки-даних"><span class="toc-section-number">20.5</span>  Додаткові прийоми очистки даних </a><a class="anchor nav-link" id="id5" data-scroll-target="undefined"></a>
  <ul class="collapse">
  <li><a href="#видалення-дублікатів" id="toc-видалення-дублікатів" class="nav-link" data-scroll-target="#видалення-дублікатів"><span class="toc-section-number">20.5.1</span>  Видалення дублікатів</a></li>
  </ul></li>
  <li><a href="#завдання-для-практики" id="toc-завдання-для-практики" class="nav-link" data-scroll-target="#завдання-для-практики"><span class="toc-section-number">20.6</span>  Завдання для практики</a></li>
  <li><a href="#набори-даних" id="toc-набори-даних" class="nav-link" data-scroll-target="#набори-даних"><span class="toc-section-number">20.7</span>  Набори даних</a></li>
  <li><a href="#використані-та-додаткові-джерела" id="toc-використані-та-додаткові-джерела" class="nav-link" data-scroll-target="#використані-та-додаткові-джерела"><span class="toc-section-number">20.8</span>  Використані та додаткові джерела</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Підготовка та очистка даних у R</span></h1>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<hr>
<p>Матеріали розділу описують інформацію про виміри оцінки якості даних, підходи до визначення та обробки пропущених значень, а також розглядаються способи боротьби зі статистичними викидами.</p>
<blockquote class="blockquote">
<p><em>Примітка. Додати теоретичну інформацію про нормальний розподіл, квантилі, Q1, Q3, IQR…</em></p>
</blockquote>
<hr>
<p><em>До початку роботи варто інстралювати наступні пакети:</em></p>
<div class="cell" data-execution_count="45">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="co"># install.packages("dplyr")</span></span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="co"># install.packages("janitor")</span></span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="co"># install.packages("stringr")</span></span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="co"># install.packages("stringdist")</span></span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="co"># install.packages("mice")</span></span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="co"># install.packages("VIM")</span></span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="co"># install.packages("Amelia")</span></span>
<span id="cb1-8"><a href="#cb1-8"></a><span class="co"># install.packages("tidyr")</span></span>
<span id="cb1-9"><a href="#cb1-9"></a><span class="co"># install.packages("Hmisc")</span></span>
<span id="cb1-10"><a href="#cb1-10"></a><span class="fu">options</span>(<span class="at">warn=</span><span class="sc">-</span><span class="dv">1</span>) <span class="co"># Налаштування для блокування вивеження warning-повідомлень</span></span>
<span id="cb1-11"><a href="#cb1-11"></a><span class="fu">Sys.setlocale</span>(<span class="st">"LC_ALL"</span>, <span class="st">"Ukrainian"</span>) <span class="co"># Налаштування для української лікалізації jupyter-ноутбуків</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
'LC_COLLATE=Ukrainian_Ukraine.1251;LC_CTYPE=Ukrainian_Ukraine.1251;LC_MONETARY=Ukrainian_Ukraine.1251;LC_NUMERIC=C;LC_TIME=Ukrainian_Ukraine.1251'
</div>
</div>
<hr>
<section id="поняття-та-виміри-оцінки-якості-даних" class="level2" data-number="20.1">
<h2 data-number="20.1" class="anchored" data-anchor-id="поняття-та-виміри-оцінки-якості-даних"><span class="header-section-number">20.1</span> Поняття та виміри оцінки якості даних</h2>
<p>Якість даних залежить від очищення та коригування даних, які відсутні, некоректні, недійсні або нечитабельні. Для забезпечення достовірності даних важливо зрозуміти ключові аспекти якості даних, щоб оцінити, наскільки дані погані/хороші.</p>
<section id="що-таке-валідація-даних" class="level3" data-number="20.1.1">
<h3 data-number="20.1.1" class="anchored" data-anchor-id="що-таке-валідація-даних"><span class="header-section-number">20.1.1</span> Що таке валідація даних?</h3>
<p>Валідація даних відноситься до процесу забезпечення точності та якості даних. Він реалізується шляхом вбудовування кількох перевірок у систему або звітування для забезпечення логічної узгодженості введених і збережених даних.</p>
<p>На перший погляд, очевидно, що перетворення даних до якісних полягає в очищенні поганих даних – даних, які відсутні, неправильні або якимось чином недійсні. Але щоб переконатися, що дані заслуговують довіри, важливо розуміти ключові виміри якості даних, щоб оцінити, наскільки дані є «поганими».</p>
<p>Окремі компанії мають внутрішні документи, що визначають виміри оцінки якості даних та порядок його проведення - <code>Data Validation Framework</code> або <code>Data Quality Framework</code>.</p>
<p>Коли говорять про якість даних, то мається на увазі їх оцінка у кількох вимірах. Розглянемо коротко ці виміри:</p>
<ul class="task-list">
<li><input type="checkbox" disabled="" checked="">Правильність / <code>Accuracy</code></li>
<li><input type="checkbox" disabled="" checked="">Повнота / <code>Completeness</code></li>
<li><input type="checkbox" disabled="" checked="">Узгодженість / <code>Consistency</code></li>
<li><input type="checkbox" disabled="" checked="">Відповідність / <code>Conformity</code></li>
<li><input type="checkbox" disabled="" checked="">Цілісність / <code>Integrity</code></li>
<li><input type="checkbox" disabled="" checked="">Своєчасність / <code>Timeliness</code></li>
<li><input type="checkbox" disabled="" checked="">Унікальність / <code>Uniqueness</code></li>
</ul>
<hr>
</section>
<section id="правильність-accuracy" class="level3" data-number="20.1.2">
<h3 data-number="20.1.2" class="anchored" data-anchor-id="правильність-accuracy"><span class="header-section-number">20.1.2</span> Правильність / (Accuracy)</h3>
<p><strong>Правильність</strong> — це ступінь, до якого дані правильно відображають реальний об’єкт АБО описувану подію.</p>
<p>Приклади: - [x] Реальною вартістю є ціна продажу одиниці товару. - [x] Адреса співробітника в <code>базі даних співробітників</code> є справжньою адресою.</p>
<p>Запитання, які ви можете задати собі:</p>
<ul class="task-list">
<li><input type="checkbox" disabled="" checked="">Чи об’єкти даних точно представляють значення «реального світу», які вони повинні моделювати? <em>Наприклад, чи правильно вказувати вік у сотнях тисяч років?</em></li>
<li><input type="checkbox" disabled="" checked="">Чи присутнє неправильне написання назв товарів чи осіб, адрес і навіть несвоєчасних чи неактуальних даних?</li>
</ul>
<p>Ці проблеми можуть вплинути на результатати аналітичних звітів, наприклад, неправильні середні значення певних показників.</p>
<hr>
</section>
<section id="повнота-completeness" class="level3" data-number="20.1.3">
<h3 data-number="20.1.3" class="anchored" data-anchor-id="повнота-completeness"><span class="header-section-number">20.1.3</span> Повнота / (Completeness)</h3>
<p>Повнота визначається як очікувана всебічність. Дані можуть бути повними, навіть якщо додаткові дані відсутні. Поки дані відповідають очікуванням, вони вважаються повними.</p>
<p>Наприклад, ім’я та прізвище замовника є обов’язковими, але прізвище необов’язково; тому запис можна вважати повним, навіть якщо прізвища не існує.</p>
<p>Питання, які ви можете задати собі:</p>
<ul class="task-list">
<li><input type="checkbox" disabled="" checked="">Чи доступна вся необхідна інформація?</li>
<li><input type="checkbox" disabled="" checked="">Чи мають якісь дані відсутні елементи?</li>
<li><input type="checkbox" disabled="" checked="">Або вони перебувають у непридатному для роботи вигляді?</li>
</ul>
<hr>
</section>
<section id="узгодженість-consistency" class="level3" data-number="20.1.4">
<h3 data-number="20.1.4" class="anchored" data-anchor-id="узгодженість-consistency"><span class="header-section-number">20.1.4</span> Узгодженість / Consistency</h3>
<p><strong>Узгодженість</strong> означає, що дані в усіх системах/таблицях відображають однакову інформацію та синхронізовані між собою.</p>
<p>Приклади: - [x] Статус бізнес-підрозділу “закритий”, але є продажі для цього підрозділу. - [x] Статус працівника “звільнено”, але статус випалати заробіної плати містить суму відмінну від 0 за той самий період. - [x] Зафіксовано, що клієнт має у банку депозити, але у даних про депозити записи по клієнту відсутні.</p>
<p>Запитання, які ви можете поставити собі:</p>
<ul class="task-list">
<li><input type="checkbox" disabled="" checked="">Чи однакові значення даних у наборах даних?</li>
<li><input type="checkbox" disabled="" checked="">Чи існують якісь різні випадки, коли однакові екземпляри даних надають суперечливу інформацію?</li>
</ul>
<hr>
</section>
<section id="відповідність-conformity" class="level3" data-number="20.1.5">
<h3 data-number="20.1.5" class="anchored" data-anchor-id="відповідність-conformity"><span class="header-section-number">20.1.5</span> Відповідність / Conformity</h3>
<p><strong>Відповідність</strong> означає, що дані відповідають набору стандартних визначень даних, як-от тип даних, розмір і формат. Наприклад, дата народження клієнта у форматі <code>dd/mm/yyyy</code> або відстань у км числом <code>100</code>, а не записом <code>100км</code>.</p>
<p>Запитання, які ви можете задати собі: - [x] Чи відповідають значення даних зазначеним форматам? - [x] Якщо так, то чи всі значення даних відповідають цим форматам?</p>
<p>Важливо підтримувати відповідність конкретним форматам.</p>
<hr>
</section>
<section id="цілісність-integrity" class="level3" data-number="20.1.6">
<h3 data-number="20.1.6" class="anchored" data-anchor-id="цілісність-integrity"><span class="header-section-number">20.1.6</span> Цілісність / Integrity</h3>
<p><strong>Цілісність</strong> означає достовірність даних у взаємозв’язках і гарантує, що всі дані в базі даних можна відстежити та з’єднати з іншими даними.</p>
<p>Наприклад, у базі даних клієнтів має бути дійсний клієнт, адреси та відношення/зв’язки між ними. Якщо є дані про зв’язок адреси без клієнта, то ці дані недійсні й вважаються загубленим записом.</p>
<p>Запитайте себе: - [x] Чи є якісь дані без важливих зв’язків?</p>
<p>Неможливість пов’язати записи разом може призвести до дублювання у ваших системах.</p>
<hr>
</section>
<section id="своєчасність-timeliness" class="level3" data-number="20.1.7">
<h3 data-number="20.1.7" class="anchored" data-anchor-id="своєчасність-timeliness"><span class="header-section-number">20.1.7</span> Своєчасність / Timeliness</h3>
<p><strong>Своєчасність</strong> показує, чи є інформація доступною, коли вона очікується та потрібна. Своєчасність даних дуже важлива.</p>
<p>Це відображається в: - [x] Компанії, які зобов’язані публікувати свої квартальні результати протягом певного періоду часу - [x] Обслуговування клієнтів надає клієнтам актуальну інформацію - [x] Кредитна система перевіряє активність рахунку кредитної картки в режимі реального часу</p>
<p>Своєчасність залежить від очікувань користувача. Доступність даних в Інтернеті може знадобитися для системи розподілу номерів у сфері готельного бізнесу.</p>
<p>Як бачите, якість даних є важливим питанням, яке слід враховувати, починаючи від етапу визначення цілей проекту, аж до впровадження, обслуговування та використання готово рішення у виробничі процесі підприємства.</p>
<hr>
</section>
</section>
<section id="робота-з-неіменованими-та-поганоіменованими-даними" class="level2" data-number="20.2">
<h2 data-number="20.2" class="anchored" data-anchor-id="робота-з-неіменованими-та-поганоіменованими-даними"><span class="header-section-number">20.2</span> Робота з неіменованими та “поганоіменованими” даними</h2>
<section id="іменування-даних" class="level3" data-number="20.2.1">
<h3 data-number="20.2.1" class="anchored" data-anchor-id="іменування-даних"><span class="header-section-number">20.2.1</span> Іменування даних</h3>
<p>Першим прикладом проблем у даних можна розгянути читання неіменованих даних, тобто стопці таблиці не мають заголовків у файлі.</p>
<p>Створимо такий файл у блокноті і зчитаємо його:</p>
<div class="cell" data-cell_id="ba629ad1cff343a899fe45ae07c40b8d" data-deepnote_cell_height="99" data-deepnote_cell_type="code" data-deepnote_output_heights="[null,219]" data-execution_millis="75" data-execution_start="1650389176553" data-output_cleared="true" data-source_hash="af0c3da" data-tags="[]" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="46">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"../../data/untitled.csv"</span>)</span>
<span id="cb2-2"><a href="#cb2-2"></a>data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<table class="dataframe table table-sm table-striped">
<caption>A data.frame: 5 × 4</caption>
<thead>
    <tr><th scope="col">X23</th><th scope="col">X185</th><th scope="col">X85.7</th><th scope="col">Male</th></tr>
    <tr><th scope="col">&lt;int&gt;</th><th scope="col">&lt;chr&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;chr&gt;</th></tr>
</thead>
<tbody>
    <tr><td>41</td><td>175 </td><td>68.3</td><td>M               </td></tr>
    <tr><td>11</td><td>142*</td><td>55.4</td><td>Female          </td></tr>
    <tr><td>12</td><td>NA  </td><td>48.2</td><td>Man             </td></tr>
    <tr><td>54</td><td>171 </td><td>  NA</td><td>Looks like a man</td></tr>
    <tr><td>32</td><td>168 </td><td>78.0</td><td>F               </td></tr>
</tbody>
</table>
</div>
</div>
<p>Зверніть увагу, що у якості стовпців взято перший рядок даних у додано <code>X</code> на початку. Зчитаємо дані із параметром, що вказує на відсутність заголовків:</p>
<div class="cell" data-cell_id="071784be9f9e4507b487a1ebd15ed904" data-deepnote_cell_height="429.375" data-deepnote_cell_type="code" data-deepnote_output_heights="[null,248]" data-execution_millis="33" data-execution_start="1650389318247" data-owner_user_id="e217be60-8088-4d01-8fcf-08f2a3d75b6d" data-source_hash="d1f77be1" data-tags="[]" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="47">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"../../data/untitled.csv"</span>, <span class="at">header =</span> <span class="cn">FALSE</span>)</span>
<span id="cb3-2"><a href="#cb3-2"></a>data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<table class="dataframe table table-sm table-striped">
<caption>A data.frame: 6 × 4</caption>
<thead>
    <tr><th scope="col">V1</th><th scope="col">V2</th><th scope="col">V3</th><th scope="col">V4</th></tr>
    <tr><th scope="col">&lt;int&gt;</th><th scope="col">&lt;chr&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;chr&gt;</th></tr>
</thead>
<tbody>
    <tr><td>23</td><td>185 </td><td>85.7</td><td>Male            </td></tr>
    <tr><td>41</td><td>175 </td><td>68.3</td><td>M               </td></tr>
    <tr><td>11</td><td>142*</td><td>55.4</td><td>Female          </td></tr>
    <tr><td>12</td><td>NA  </td><td>48.2</td><td>Man             </td></tr>
    <tr><td>54</td><td>171 </td><td>  NA</td><td>Looks like a man</td></tr>
    <tr><td>32</td><td>168 </td><td>78.0</td><td>F               </td></tr>
</tbody>
</table>
</div>
</div>
<p>Проблема іменування не вирішена, дані ми уже не втратили. Передамо одночасно з читанням інформацію про назви стовпців:</p>
<div class="cell" data-cell_id="b2f2910a77ec4776aa7d881a36d74863" data-deepnote_cell_height="465.375" data-deepnote_cell_type="code" data-deepnote_output_heights="[null,248]" data-execution_millis="33" data-execution_start="1650389438672" data-source_hash="cba21c26" data-tags="[]" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="48">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"../../data/untitled.csv"</span>, </span>
<span id="cb4-2"><a href="#cb4-2"></a>            <span class="at">header =</span> <span class="cn">FALSE</span>,</span>
<span id="cb4-3"><a href="#cb4-3"></a>            <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Age"</span>,<span class="st">"Height"</span>, <span class="st">"Weight"</span>, <span class="st">"Gender"</span>))</span>
<span id="cb4-4"><a href="#cb4-4"></a>data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<table class="dataframe table table-sm table-striped">
<caption>A data.frame: 6 × 4</caption>
<thead>
    <tr><th scope="col">Age</th><th scope="col">Height</th><th scope="col">Weight</th><th scope="col">Gender</th></tr>
    <tr><th scope="col">&lt;int&gt;</th><th scope="col">&lt;chr&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;chr&gt;</th></tr>
</thead>
<tbody>
    <tr><td>23</td><td>185 </td><td>85.7</td><td>Male            </td></tr>
    <tr><td>41</td><td>175 </td><td>68.3</td><td>M               </td></tr>
    <tr><td>11</td><td>142*</td><td>55.4</td><td>Female          </td></tr>
    <tr><td>12</td><td>NA  </td><td>48.2</td><td>Man             </td></tr>
    <tr><td>54</td><td>171 </td><td>  NA</td><td>Looks like a man</td></tr>
    <tr><td>32</td><td>168 </td><td>78.0</td><td>F               </td></tr>
</tbody>
</table>
</div>
</div>
<p>Ще одним варіантом задання назв стовпців є використання функції <code>colnames()</code> як для усіх різом, так і для окремого:</p>
<div class="cell" data-cell_id="ec3c8040f0dd44b38271c5b8dc30edfc" data-deepnote_cell_height="678" data-deepnote_cell_type="code" data-deepnote_output_heights="[248,248]" data-execution_millis="57" data-execution_start="1650389604515" data-source_hash="d1a601e" data-tags="[]" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="49">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="fu">colnames</span>(data) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"age"</span>, <span class="st">"height"</span>, <span class="st">"width"</span>, <span class="st">"gender"</span>)</span>
<span id="cb5-2"><a href="#cb5-2"></a>data</span>
<span id="cb5-3"><a href="#cb5-3"></a><span class="fu">colnames</span>(data)[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="st">"HEIGHT"</span></span>
<span id="cb5-4"><a href="#cb5-4"></a>data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<table class="dataframe table table-sm table-striped">
<caption>A data.frame: 6 × 4</caption>
<thead>
    <tr><th scope="col">age</th><th scope="col">height</th><th scope="col">width</th><th scope="col">gender</th></tr>
    <tr><th scope="col">&lt;int&gt;</th><th scope="col">&lt;chr&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;chr&gt;</th></tr>
</thead>
<tbody>
    <tr><td>23</td><td>185 </td><td>85.7</td><td>Male            </td></tr>
    <tr><td>41</td><td>175 </td><td>68.3</td><td>M               </td></tr>
    <tr><td>11</td><td>142*</td><td>55.4</td><td>Female          </td></tr>
    <tr><td>12</td><td>NA  </td><td>48.2</td><td>Man             </td></tr>
    <tr><td>54</td><td>171 </td><td>  NA</td><td>Looks like a man</td></tr>
    <tr><td>32</td><td>168 </td><td>78.0</td><td>F               </td></tr>
</tbody>
</table>
</div>
<div class="cell-output cell-output-display">

<table class="dataframe table table-sm table-striped">
<caption>A data.frame: 6 × 4</caption>
<thead>
    <tr><th scope="col">age</th><th scope="col">HEIGHT</th><th scope="col">width</th><th scope="col">gender</th></tr>
    <tr><th scope="col">&lt;int&gt;</th><th scope="col">&lt;chr&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;chr&gt;</th></tr>
</thead>
<tbody>
    <tr><td>23</td><td>185 </td><td>85.7</td><td>Male            </td></tr>
    <tr><td>41</td><td>175 </td><td>68.3</td><td>M               </td></tr>
    <tr><td>11</td><td>142*</td><td>55.4</td><td>Female          </td></tr>
    <tr><td>12</td><td>NA  </td><td>48.2</td><td>Man             </td></tr>
    <tr><td>54</td><td>171 </td><td>  NA</td><td>Looks like a man</td></tr>
    <tr><td>32</td><td>168 </td><td>78.0</td><td>F               </td></tr>
</tbody>
</table>
</div>
</div>
<p>Також змінювати назви стовпців можна за допомогою функції <code>rename()</code> з пакету <code>dplyr</code>:</p>
<div class="cell" data-cell_id="1c9ee90a85f24140a0a2b08f2e5d4f6d" data-deepnote_cell_height="927.4375" data-deepnote_cell_type="code" data-deepnote_output_heights="[443.3125,40.375]" data-deepnote_to_be_reexecuted="true" data-execution_millis="293" data-execution_start="1650393120222" data-source_hash="dcf4aa68" data-tags="[]" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="50">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb6-2"><a href="#cb6-2"></a></span>
<span id="cb6-3"><a href="#cb6-3"></a>data <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span> <span class="fu">rename</span>(<span class="at">AGE =</span> age) <span class="co"># %&gt;%</span></span>
<span id="cb6-4"><a href="#cb6-4"></a>data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<table class="dataframe table table-sm table-striped">
<caption>A data.frame: 6 × 4</caption>
<thead>
    <tr><th scope="col">AGE</th><th scope="col">HEIGHT</th><th scope="col">width</th><th scope="col">gender</th></tr>
    <tr><th scope="col">&lt;int&gt;</th><th scope="col">&lt;chr&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;chr&gt;</th></tr>
</thead>
<tbody>
    <tr><td>23</td><td>185 </td><td>85.7</td><td>Male            </td></tr>
    <tr><td>41</td><td>175 </td><td>68.3</td><td>M               </td></tr>
    <tr><td>11</td><td>142*</td><td>55.4</td><td>Female          </td></tr>
    <tr><td>12</td><td>NA  </td><td>48.2</td><td>Man             </td></tr>
    <tr><td>54</td><td>171 </td><td>  NA</td><td>Looks like a man</td></tr>
    <tr><td>32</td><td>168 </td><td>78.0</td><td>F               </td></tr>
</tbody>
</table>
</div>
</div>
<hr>
</section>
<section id="заміна-назв-стовпців-data.frame" class="level3" data-number="20.2.2">
<h3 data-number="20.2.2" class="anchored" data-anchor-id="заміна-назв-стовпців-data.frame"><span class="header-section-number">20.2.2</span> Заміна назв стовпців data.frame <a class="anchor" id="id22"></a></h3><a class="anchor" id="id22">
<p>Зчитаємо файл, що містить інформацію про осіб, але уже має іменовані стовтці:</p>
</a><div class="cell" data-cell_id="42a2ae637a1444e2b072683d12de972a" data-deepnote_cell_height="66" data-deepnote_cell_type="code" data-tags="[]" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="51"><a class="anchor" id="id22">
</a><div class="sourceCode cell-code" id="cb7"><a class="anchor" id="id22"></a><pre class="sourceCode numberSource r number-lines code-with-copy"><a class="anchor" id="id22"><code class="sourceCode r"><span id="cb7-1"></span></code></a><code class="sourceCode r"><a href="#cb7-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"../../data/badtitled.csv"</span>)
<span id="cb7-2"><a href="#cb7-2"></a>data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<table class="dataframe table table-sm table-striped">
<caption>A data.frame: 13 × 5</caption>
<thead>
    <tr><th scope="col">Person.Age</th><th scope="col">Person__Height</th><th scope="col">person.Weight</th><th scope="col">Person.Gender</th><th scope="col">empty</th></tr>
    <tr><th scope="col">&lt;int&gt;</th><th scope="col">&lt;chr&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;chr&gt;</th><th scope="col">&lt;lgl&gt;</th></tr>
</thead>
<tbody>
    <tr><td>23</td><td>185 </td><td>  NA</td><td>Male  </td><td>NA</td></tr>
    <tr><td>41</td><td>175 </td><td>68.3</td><td>   M  </td><td>NA</td></tr>
    <tr><td>11</td><td>142*</td><td>55.4</td><td>Female</td><td>NA</td></tr>
    <tr><td>12</td><td>NA  </td><td>48.2</td><td>Man   </td><td>NA</td></tr>
    <tr><td>54</td><td>191 </td><td>  NA</td><td>female</td><td>NA</td></tr>
    <tr><td>32</td><td>168 </td><td>78.0</td><td>F     </td><td>NA</td></tr>
    <tr><td>22</td><td>NA  </td><td>54.0</td><td>male. </td><td>NA</td></tr>
    <tr><td>21</td><td>165 </td><td>  NA</td><td>m     </td><td>NA</td></tr>
    <tr><td>14</td><td>NA  </td><td>90.2</td><td>Man   </td><td>NA</td></tr>
    <tr><td>51</td><td>250 </td><td>  NA</td><td>female</td><td>NA</td></tr>
    <tr><td>41</td><td>20  </td><td>81.0</td><td>F     </td><td>NA</td></tr>
    <tr><td>66</td><td>NA  </td><td>59.0</td><td>male. </td><td>NA</td></tr>
    <tr><td>71</td><td>171 </td><td>  NA</td><td>m     </td><td>NA</td></tr>
</tbody>
</table>
</div>
</div>
<p>Швидко змінити назви стовпців та привести їх до однакового стилю можна за домогою бібліотеки <code>janitor</code>:</p>
<div class="cell" data-execution_count="52">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="fu">library</span>(janitor)</span>
<span id="cb8-2"><a href="#cb8-2"></a>clean <span class="ot">&lt;-</span> <span class="fu">clean_names</span>(data)</span>
<span id="cb8-3"><a href="#cb8-3"></a><span class="fu">colnames</span>(clean)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class="list-inline"><li>'person_age'</li><li>'person_height'</li><li>'person_weight'</li><li>'person_gender'</li><li>'empty'</li></ol>
</div>
</div>
<hr>
</section>
<section id="підготовка-та-очистка-текстової-інформації" class="level3" data-number="20.2.3">
<h3 data-number="20.2.3" class="anchored" data-anchor-id="підготовка-та-очистка-текстової-інформації"><span class="header-section-number">20.2.3</span> Підготовка та очистка текстової інформації</h3>
<p>Зчитаємо інформацію про стать з попереднього прикладу:</p>
<div class="cell" data-execution_count="53">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"../../data/badtitled.csv"</span>)</span>
<span id="cb9-2"><a href="#cb9-2"></a>data <span class="ot">&lt;-</span> <span class="fu">clean_names</span>(data)</span>
<span id="cb9-3"><a href="#cb9-3"></a>data <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(data<span class="sc">$</span>person_gender)</span>
<span id="cb9-4"><a href="#cb9-4"></a><span class="fu">colnames</span>(data) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"gender"</span>)</span>
<span id="cb9-5"><a href="#cb9-5"></a><span class="fu">unlist</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<style>
.dl-inline {width: auto; margin:0; padding: 0}
.dl-inline>dt, .dl-inline>dd {float: none; width: auto; display: inline-block}
.dl-inline>dt::after {content: ":\0020"; padding-right: .5ex}
.dl-inline>dt:not(:first-of-type) {padding-left: .5ex}
</style><dl class="dl-inline"><dt>gender1</dt><dd>'Male'</dd><dt>gender2</dt><dd><span style="white-space:pre-wrap">'   M'</span></dd><dt>gender3</dt><dd>'Female'</dd><dt>gender4</dt><dd>'Man'</dd><dt>gender5</dt><dd>'female'</dd><dt>gender6</dt><dd><span style="white-space:pre-wrap">'F    '</span></dd><dt>gender7</dt><dd>'male.'</dd><dt>gender8</dt><dd>'m'</dd><dt>gender9</dt><dd>'Man'</dd><dt>gender10</dt><dd>'female'</dd><dt>gender11</dt><dd><span style="white-space:pre-wrap">'F    '</span></dd><dt>gender12</dt><dd>'male.'</dd><dt>gender13</dt><dd>'m'</dd></dl>
</div>
</div>
<p>Схоже, що ці дані насправді мають всього 2 записи, проте у базу даних їх вносили різні люди або вони були зібрані з різних джерел інформації. Це досить поширена проблема у роботі з даними. Особливо коли відбуваєть заміна людей на рочих місцях або перехід на інше програмне забезпечення.</p>
<p>Якщо це буде розглядатися як факторна змінна без будь-якої попередньої обробки, очевидно, що 8, а не 2 класи будуть збережені. Тому завдання полягає в тому, щоб автоматично розпізнавати наведені вище дані про те, чи відноситься кожен елемент до чоловічої чи жіночої статі. У статистичних контекстах класифікацію таких “безладні” текстові рядки в ряд фіксованих категорій часто називають кодуванням.</p>
<p>Опишемо два взаємодоповнюючих підходи до кодування рядків: <code>нормалізація</code> (<code>string normalization</code>) рядків і аналіз схожості тексту (<code>approximate text matching</code>).</p>
<p>Розглянемо наступні підходи до очистки текстових даних:</p>
<pre><code>– [x] Видалення пробілів на початку або в кінці
– [x] Обрізання/збільшення рядків до певної ширини
– [x] Перетворення у верхній/нижній регістр.
– [x] Пошук рядків, що містять прості шаблони (підрядки).
– [x] Апроксимація рядків на основі "відстаней".</code></pre>
<p>Робота з текстом у <code>R</code> здійснюється за допомогою пакету <code>stringr</code>.</p>
<p><strong>Видалення пробілів на початку або в кінці</strong> здійснюється за допомогою функції <code>str_trim()</code>.</p>
<div class="cell" data-execution_count="54">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb11-2"><a href="#cb11-2"></a><span class="fu">str_trim</span>(<span class="st">" ostroh academy  "</span>)</span>
<span id="cb11-3"><a href="#cb11-3"></a><span class="fu">str_trim</span>(<span class="st">" ostroh academy "</span>, <span class="at">side =</span> <span class="st">"left"</span>)</span>
<span id="cb11-4"><a href="#cb11-4"></a><span class="fu">str_trim</span>(<span class="st">" ostroh academy "</span>, <span class="at">side =</span> <span class="st">"right"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
'ostroh academy'
</div>
<div class="cell-output cell-output-display">
'ostroh academy '
</div>
<div class="cell-output cell-output-display">
' ostroh academy'
</div>
</div>
<p><strong>Обрізання/збільшення рядків до певної ширини</strong> здійснюється за допомогою функції <code>str_pad()</code>.</p>
<div class="cell" data-execution_count="55">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="fu">str_pad</span>(<span class="dv">57</span>, <span class="at">width =</span> <span class="dv">6</span>, <span class="at">side =</span> <span class="st">"left"</span>, <span class="at">pad =</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
'000057'
</div>
</div>
<div class="cell" data-execution_count="56">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="fu">str_pad</span>(<span class="st">"ostroh"</span>, <span class="at">width =</span> <span class="dv">10</span>, <span class="at">side =</span> <span class="st">"right"</span>, <span class="at">pad =</span> <span class="st">"_"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
'ostroh____'
</div>
</div>
<p><strong>Перетворення у верхній/нижній регістр</strong></p>
<div class="cell" data-execution_count="57">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a>text <span class="ot">&lt;-</span> <span class="st">"Ostroh Academy!"</span></span>
<span id="cb14-2"><a href="#cb14-2"></a><span class="fu">toupper</span>(text)</span>
<span id="cb14-3"><a href="#cb14-3"></a><span class="fu">tolower</span>(text)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
'OSTROH ACADEMY!'
</div>
<div class="cell-output cell-output-display">
'ostroh academy!'
</div>
</div>
<p><strong>Пошук рядків, що містять прості шаблони (підрядки)</strong></p>
<p>Скористаємося функцієя <code>grep()</code> та <code>grepl()</code> для пошуку підрядків у інформації про стать:</p>
<div class="cell" data-execution_count="58">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="fu">grepl</span>(<span class="st">"m"</span>, data<span class="sc">$</span>gender) <span class="co"># Повертає TRUE/FALSE, якщо знахоить входження рядка</span></span>
<span id="cb15-2"><a href="#cb15-2"></a><span class="fu">grep</span>(<span class="st">"m"</span>, data<span class="sc">$</span>gender) <span class="co"># Повертає номери рядків, по яких є входження</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class="list-inline"><li>FALSE</li><li>FALSE</li><li>TRUE</li><li>FALSE</li><li>TRUE</li><li>FALSE</li><li>TRUE</li><li>TRUE</li><li>FALSE</li><li>TRUE</li><li>FALSE</li><li>TRUE</li><li>TRUE</li></ol>
</div>
<div class="cell-output cell-output-display">
<style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class="list-inline"><li>3</li><li>5</li><li>7</li><li>8</li><li>10</li><li>12</li><li>13</li></ol>
</div>
</div>
<div class="cell" data-execution_count="59">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a><span class="fu">grepl</span>(<span class="st">"m"</span>, data<span class="sc">$</span>gender, <span class="at">ignore.case =</span> <span class="cn">TRUE</span>) <span class="co"># не враховує регістр букв</span></span>
<span id="cb16-2"><a href="#cb16-2"></a><span class="fu">grepl</span>(<span class="st">"m"</span>, <span class="fu">tolower</span>(data<span class="sc">$</span>gender))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class="list-inline"><li>TRUE</li><li>TRUE</li><li>TRUE</li><li>TRUE</li><li>TRUE</li><li>FALSE</li><li>TRUE</li><li>TRUE</li><li>TRUE</li><li>TRUE</li><li>FALSE</li><li>TRUE</li><li>TRUE</li></ol>
</div>
<div class="cell-output cell-output-display">
<style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class="list-inline"><li>TRUE</li><li>TRUE</li><li>TRUE</li><li>TRUE</li><li>TRUE</li><li>FALSE</li><li>TRUE</li><li>TRUE</li><li>TRUE</li><li>TRUE</li><li>FALSE</li><li>TRUE</li><li>TRUE</li></ol>
</div>
</div>
<div class="cell" data-execution_count="60">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a>data<span class="sc">$</span>gender</span>
<span id="cb17-2"><a href="#cb17-2"></a><span class="fu">grepl</span>(<span class="st">"^m"</span>, data<span class="sc">$</span>gender, <span class="at">ignore.case =</span> <span class="cn">TRUE</span>) <span class="co"># Показує усі збіги, що починаються з вказаної літери</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class="list-inline"><li>'Male'</li><li><span style="white-space:pre-wrap">'   M'</span></li><li>'Female'</li><li>'Man'</li><li>'female'</li><li><span style="white-space:pre-wrap">'F    '</span></li><li>'male.'</li><li>'m'</li><li>'Man'</li><li>'female'</li><li><span style="white-space:pre-wrap">'F    '</span></li><li>'male.'</li><li>'m'</li></ol>
</div>
<div class="cell-output cell-output-display">
<style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class="list-inline"><li>TRUE</li><li>FALSE</li><li>FALSE</li><li>TRUE</li><li>FALSE</li><li>FALSE</li><li>TRUE</li><li>TRUE</li><li>TRUE</li><li>FALSE</li><li>FALSE</li><li>TRUE</li><li>TRUE</li></ol>
</div>
</div>
<p><strong>Пошук “відстані” між ряжками</strong> - це аналіз рядків на схожіть з визначенням рівня співпадінь.</p>
<div class="cell" data-execution_count="61">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a><span class="fu">adist</span>(<span class="st">"ao"</span>, <span class="st">"ao"</span>)</span>
<span id="cb18-2"><a href="#cb18-2"></a><span class="fu">adist</span>(<span class="st">"ao"</span>, <span class="st">"oa"</span>)</span>
<span id="cb18-3"><a href="#cb18-3"></a><span class="fu">adist</span>(<span class="st">"ao"</span>, <span class="st">"45fb"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<table class="dataframe table table-sm table-striped">
<caption>A matrix: 1 × 1 of type dbl</caption>
<tbody>
    <tr><td>0</td></tr>
</tbody>
</table>
</div>
<div class="cell-output cell-output-display">

<table class="dataframe table table-sm table-striped">
<caption>A matrix: 1 × 1 of type dbl</caption>
<tbody>
    <tr><td>2</td></tr>
</tbody>
</table>
</div>
<div class="cell-output cell-output-display">

<table class="dataframe table table-sm table-striped">
<caption>A matrix: 1 × 1 of type dbl</caption>
<tbody>
    <tr><td>4</td></tr>
</tbody>
</table>
</div>
</div>
<p>Давайте проаналізуємо інформацію про стать з точки зору схожості текстів:</p>
<div class="cell" data-execution_count="62">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a>m <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"male"</span>, <span class="st">"female"</span>)</span>
<span id="cb19-2"><a href="#cb19-2"></a>adj_m <span class="ot">&lt;-</span> <span class="fu">adist</span>(data<span class="sc">$</span>gender, m)</span>
<span id="cb19-3"><a href="#cb19-3"></a><span class="co">#adj_m &lt;- adist(tolower(data$gender), m)</span></span>
<span id="cb19-4"><a href="#cb19-4"></a><span class="co">#adj_m &lt;- adist(str_trim(tolower(data$gender), side="both"), m)</span></span>
<span id="cb19-5"><a href="#cb19-5"></a><span class="fu">colnames</span>(adj_m) <span class="ot">&lt;-</span> m </span>
<span id="cb19-6"><a href="#cb19-6"></a><span class="fu">rownames</span>(adj_m) <span class="ot">&lt;-</span> data<span class="sc">$</span>gender</span>
<span id="cb19-7"><a href="#cb19-7"></a>adj_m</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<table class="dataframe table table-sm table-striped">
<caption>A matrix: 13 × 2 of type dbl</caption>
<thead>
    <tr><th></th><th scope="col">male</th><th scope="col">female</th></tr>
</thead>
<tbody>
    <tr><th scope="row">Male</th><td>1</td><td>3</td></tr>
    <tr><th scope="row">   M</th><td>4</td><td>6</td></tr>
    <tr><th scope="row">Female</th><td>2</td><td>1</td></tr>
    <tr><th scope="row">Man</th><td>3</td><td>5</td></tr>
    <tr><th scope="row">female</th><td>2</td><td>0</td></tr>
    <tr><th scope="row">F    </th><td>5</td><td>6</td></tr>
    <tr><th scope="row">male.</th><td>1</td><td>3</td></tr>
    <tr><th scope="row">m</th><td>3</td><td>5</td></tr>
    <tr><th scope="row">Man</th><td>3</td><td>5</td></tr>
    <tr><th scope="row">female</th><td>2</td><td>0</td></tr>
    <tr><th scope="row">F    </th><td>5</td><td>6</td></tr>
    <tr><th scope="row">male.</th><td>1</td><td>3</td></tr>
    <tr><th scope="row">m</th><td>3</td><td>5</td></tr>
</tbody>
</table>
</div>
</div>
<div class="cell" data-execution_count="63">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a><span class="co"># Видалимо повтори</span></span>
<span id="cb20-2"><a href="#cb20-2"></a>adj_m <span class="sc">|&gt;</span> <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span> dplyr<span class="sc">::</span><span class="fu">distinct</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<table class="dataframe table table-sm table-striped">
<caption>A data.frame: 6 × 2</caption>
<thead>
    <tr><th></th><th scope="col">male</th><th scope="col">female</th></tr>
    <tr><th></th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th></tr>
</thead>
<tbody>
    <tr><th scope="row">Male</th><td>1</td><td>3</td></tr>
    <tr><th scope="row">X...M</th><td>4</td><td>6</td></tr>
    <tr><th scope="row">Female</th><td>2</td><td>1</td></tr>
    <tr><th scope="row">Man</th><td>3</td><td>5</td></tr>
    <tr><th scope="row">female</th><td>2</td><td>0</td></tr>
    <tr><th scope="row">F....</th><td>5</td><td>6</td></tr>
</tbody>
</table>
</div>
</div>
<p>Примінимо інформацію про відстані до “нечистих” даних про стать:</p>
<div class="cell" data-execution_count="64">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a>nums <span class="ot">&lt;-</span> <span class="fu">apply</span>(adj_m, <span class="dv">1</span>, which.min) <span class="co"># Знайдемо найближчі значення</span></span>
<span id="cb21-2"><a href="#cb21-2"></a>nums</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<style>
.dl-inline {width: auto; margin:0; padding: 0}
.dl-inline>dt, .dl-inline>dd {float: none; width: auto; display: inline-block}
.dl-inline>dt::after {content: ":\0020"; padding-right: .5ex}
.dl-inline>dt:not(:first-of-type) {padding-left: .5ex}
</style><dl class="dl-inline"><dt>Male</dt><dd>1</dd><dt><span style="white-space:pre-wrap">   M</span></dt><dd>1</dd><dt>Female</dt><dd>2</dd><dt>Man</dt><dd>1</dd><dt>female</dt><dd>2</dd><dt><span style="white-space:pre-wrap">F    </span></dt><dd>1</dd><dt>male.</dt><dd>1</dd><dt>m</dt><dd>1</dd><dt>Man</dt><dd>1</dd><dt>female</dt><dd>2</dd><dt><span style="white-space:pre-wrap">F    </span></dt><dd>1</dd><dt>male.</dt><dd>1</dd><dt>m</dt><dd>1</dd></dl>
</div>
</div>
<div class="cell" data-execution_count="65">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a><span class="fu">data.frame</span>(<span class="at">initial =</span> data<span class="sc">$</span>gender, <span class="at">coded =</span> m[nums]) <span class="co"># FFFFFFFFFFFFFF - проблема!</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<table class="dataframe table table-sm table-striped">
<caption>A data.frame: 13 × 2</caption>
<thead>
    <tr><th scope="col">initial</th><th scope="col">coded</th></tr>
    <tr><th scope="col">&lt;chr&gt;</th><th scope="col">&lt;chr&gt;</th></tr>
</thead>
<tbody>
    <tr><td>Male  </td><td>male  </td></tr>
    <tr><td>   M  </td><td>male  </td></tr>
    <tr><td>Female</td><td>female</td></tr>
    <tr><td>Man   </td><td>male  </td></tr>
    <tr><td>female</td><td>female</td></tr>
    <tr><td>F     </td><td>male  </td></tr>
    <tr><td>male. </td><td>male  </td></tr>
    <tr><td>m     </td><td>male  </td></tr>
    <tr><td>Man   </td><td>male  </td></tr>
    <tr><td>female</td><td>female</td></tr>
    <tr><td>F     </td><td>male  </td></tr>
    <tr><td>male. </td><td>male  </td></tr>
    <tr><td>m     </td><td>male  </td></tr>
</tbody>
</table>
</div>
</div>
<p>Як альтернативу для знаходження відстаней між рядками можна використовувати функції з бібліотеки <code>stringdist</code>.</p>
<div class="cell" data-execution_count="66">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a><span class="fu">library</span>(stringdist)</span>
<span id="cb23-2"><a href="#cb23-2"></a><span class="fu">adist</span>(<span class="st">"ao"</span>, <span class="st">"oa"</span>)</span>
<span id="cb23-3"><a href="#cb23-3"></a><span class="fu">stringdist</span>(<span class="st">"oa"</span>, <span class="st">"ao"</span>) <span class="co"># 1, а було 2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<table class="dataframe table table-sm table-striped">
<caption>A matrix: 1 × 1 of type dbl</caption>
<tbody>
    <tr><td>2</td></tr>
</tbody>
</table>
</div>
<div class="cell-output cell-output-display">
1
</div>
</div>
<p>Спробуємо “очистити” дані, які ми отримали з допомогою функції <code>amatch()</code>:</p>
<div class="cell" data-execution_count="67">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a>nums <span class="ot">&lt;-</span> <span class="fu">amatch</span>(data<span class="sc">$</span>gender,  <span class="fu">c</span>(<span class="st">"male"</span>, <span class="st">"female"</span>), <span class="at">maxDist =</span> <span class="dv">4</span>) <span class="co"># Знайдемо найближчі значення</span></span>
<span id="cb24-2"><a href="#cb24-2"></a>nums</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class="list-inline"><li>1</li><li>1</li><li>2</li><li>1</li><li>2</li><li>&lt;NA&gt;</li><li>1</li><li>1</li><li>1</li><li>2</li><li>&lt;NA&gt;</li><li>1</li><li>1</li></ol>
</div>
</div>
<div class="cell" data-execution_count="68">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a><span class="fu">data.frame</span>(<span class="at">initial =</span> data<span class="sc">$</span>gender, <span class="at">coded =</span> m[nums]) <span class="co"># FFFFFFFFFFFFFF - проблема!</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<table class="dataframe table table-sm table-striped">
<caption>A data.frame: 13 × 2</caption>
<thead>
    <tr><th scope="col">initial</th><th scope="col">coded</th></tr>
    <tr><th scope="col">&lt;chr&gt;</th><th scope="col">&lt;chr&gt;</th></tr>
</thead>
<tbody>
    <tr><td>Male  </td><td>male  </td></tr>
    <tr><td>   M  </td><td>male  </td></tr>
    <tr><td>Female</td><td>female</td></tr>
    <tr><td>Man   </td><td>male  </td></tr>
    <tr><td>female</td><td>female</td></tr>
    <tr><td>F     </td><td>NA    </td></tr>
    <tr><td>male. </td><td>male  </td></tr>
    <tr><td>m     </td><td>male  </td></tr>
    <tr><td>Man   </td><td>male  </td></tr>
    <tr><td>female</td><td>female</td></tr>
    <tr><td>F     </td><td>NA    </td></tr>
    <tr><td>male. </td><td>male  </td></tr>
    <tr><td>m     </td><td>male  </td></tr>
</tbody>
</table>
</div>
</div>
<div class="cell" data-execution_count="69">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">gender =</span> <span class="fu">ifelse</span>(gender <span class="sc">==</span> <span class="st">"F"</span>, <span class="st">"female"</span>, gender)) <span class="co"># ????? # Space</span></span>
<span id="cb26-2"><a href="#cb26-2"></a>data</span>
<span id="cb26-3"><a href="#cb26-3"></a>data <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">gender =</span> <span class="fu">ifelse</span>(<span class="fu">str_trim</span>(gender) <span class="sc">==</span> <span class="st">"F"</span>, <span class="st">"female"</span>, gender))</span>
<span id="cb26-4"><a href="#cb26-4"></a>data</span>
<span id="cb26-5"><a href="#cb26-5"></a>nums <span class="ot">&lt;-</span> <span class="fu">amatch</span>(data<span class="sc">$</span>gender,  <span class="fu">c</span>(<span class="st">"male"</span>, <span class="st">"female"</span>), <span class="at">maxDist =</span> <span class="dv">4</span>)</span>
<span id="cb26-6"><a href="#cb26-6"></a><span class="fu">data.frame</span>(<span class="at">initial =</span> data<span class="sc">$</span>gender, <span class="at">coded =</span> m[nums]) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<table class="dataframe table table-sm table-striped">
<caption>A data.frame: 13 × 1</caption>
<thead>
    <tr><th scope="col">gender</th></tr>
    <tr><th scope="col">&lt;chr&gt;</th></tr>
</thead>
<tbody>
    <tr><td>Male  </td></tr>
    <tr><td>   M  </td></tr>
    <tr><td>Female</td></tr>
    <tr><td>Man   </td></tr>
    <tr><td>female</td></tr>
    <tr><td>F     </td></tr>
    <tr><td>male. </td></tr>
    <tr><td>m     </td></tr>
    <tr><td>Man   </td></tr>
    <tr><td>female</td></tr>
    <tr><td>F     </td></tr>
    <tr><td>male. </td></tr>
    <tr><td>m     </td></tr>
</tbody>
</table>
</div>
<div class="cell-output cell-output-display">

<table class="dataframe table table-sm table-striped">
<caption>A data.frame: 13 × 1</caption>
<thead>
    <tr><th scope="col">gender</th></tr>
    <tr><th scope="col">&lt;chr&gt;</th></tr>
</thead>
<tbody>
    <tr><td>Male  </td></tr>
    <tr><td>   M  </td></tr>
    <tr><td>Female</td></tr>
    <tr><td>Man   </td></tr>
    <tr><td>female</td></tr>
    <tr><td>female</td></tr>
    <tr><td>male. </td></tr>
    <tr><td>m     </td></tr>
    <tr><td>Man   </td></tr>
    <tr><td>female</td></tr>
    <tr><td>female</td></tr>
    <tr><td>male. </td></tr>
    <tr><td>m     </td></tr>
</tbody>
</table>
</div>
<div class="cell-output cell-output-display">

<table class="dataframe table table-sm table-striped">
<caption>A data.frame: 13 × 2</caption>
<thead>
    <tr><th scope="col">initial</th><th scope="col">coded</th></tr>
    <tr><th scope="col">&lt;chr&gt;</th><th scope="col">&lt;chr&gt;</th></tr>
</thead>
<tbody>
    <tr><td>Male  </td><td>male  </td></tr>
    <tr><td>   M  </td><td>male  </td></tr>
    <tr><td>Female</td><td>female</td></tr>
    <tr><td>Man   </td><td>male  </td></tr>
    <tr><td>female</td><td>female</td></tr>
    <tr><td>female</td><td>female</td></tr>
    <tr><td>male. </td><td>male  </td></tr>
    <tr><td>m     </td><td>male  </td></tr>
    <tr><td>Man   </td><td>male  </td></tr>
    <tr><td>female</td><td>female</td></tr>
    <tr><td>female</td><td>female</td></tr>
    <tr><td>male. </td><td>male  </td></tr>
    <tr><td>m     </td><td>male  </td></tr>
</tbody>
</table>
</div>
</div>
<p>Місія виконана! Замінимо та збережемо інформацію у файл для майбутніх експериментів по цій темі:</p>
<div class="cell" data-execution_count="70">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"../../data/badtitled.csv"</span>)</span>
<span id="cb27-2"><a href="#cb27-2"></a>data <span class="ot">&lt;-</span> <span class="fu">clean_names</span>(data)</span>
<span id="cb27-3"><a href="#cb27-3"></a><span class="fu">head</span>(data, <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<table class="dataframe table table-sm table-striped">
<caption>A data.frame: 2 × 5</caption>
<thead>
    <tr><th></th><th scope="col">person_age</th><th scope="col">person_height</th><th scope="col">person_weight</th><th scope="col">person_gender</th><th scope="col">empty</th></tr>
    <tr><th></th><th scope="col">&lt;int&gt;</th><th scope="col">&lt;chr&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;chr&gt;</th><th scope="col">&lt;lgl&gt;</th></tr>
</thead>
<tbody>
    <tr><th scope="row">1</th><td>23</td><td>185</td><td>  NA</td><td>Male</td><td>NA</td></tr>
    <tr><th scope="row">2</th><td>41</td><td>175</td><td>68.3</td><td>   M</td><td>NA</td></tr>
</tbody>
</table>
</div>
</div>
<div class="cell" data-execution_count="71">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">person_gender =</span> <span class="fu">ifelse</span>(<span class="fu">str_trim</span>(person_gender) <span class="sc">==</span> <span class="st">"F"</span>, <span class="st">"female"</span>, person_gender))</span>
<span id="cb28-2"><a href="#cb28-2"></a>m <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"male"</span>, <span class="st">"female"</span>)</span>
<span id="cb28-3"><a href="#cb28-3"></a>nums <span class="ot">&lt;-</span> <span class="fu">amatch</span>(data<span class="sc">$</span>person_gender, m, <span class="at">maxDist =</span> <span class="dv">4</span>)</span>
<span id="cb28-4"><a href="#cb28-4"></a>data <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">person_gender =</span> m[nums])</span>
<span id="cb28-5"><a href="#cb28-5"></a>data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<table class="dataframe table table-sm table-striped">
<caption>A data.frame: 13 × 5</caption>
<thead>
    <tr><th scope="col">person_age</th><th scope="col">person_height</th><th scope="col">person_weight</th><th scope="col">person_gender</th><th scope="col">empty</th></tr>
    <tr><th scope="col">&lt;int&gt;</th><th scope="col">&lt;chr&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;chr&gt;</th><th scope="col">&lt;lgl&gt;</th></tr>
</thead>
<tbody>
    <tr><td>23</td><td>185 </td><td>  NA</td><td>male  </td><td>NA</td></tr>
    <tr><td>41</td><td>175 </td><td>68.3</td><td>male  </td><td>NA</td></tr>
    <tr><td>11</td><td>142*</td><td>55.4</td><td>female</td><td>NA</td></tr>
    <tr><td>12</td><td>NA  </td><td>48.2</td><td>male  </td><td>NA</td></tr>
    <tr><td>54</td><td>191 </td><td>  NA</td><td>female</td><td>NA</td></tr>
    <tr><td>32</td><td>168 </td><td>78.0</td><td>female</td><td>NA</td></tr>
    <tr><td>22</td><td>NA  </td><td>54.0</td><td>male  </td><td>NA</td></tr>
    <tr><td>21</td><td>165 </td><td>  NA</td><td>male  </td><td>NA</td></tr>
    <tr><td>14</td><td>NA  </td><td>90.2</td><td>male  </td><td>NA</td></tr>
    <tr><td>51</td><td>250 </td><td>  NA</td><td>female</td><td>NA</td></tr>
    <tr><td>41</td><td>20  </td><td>81.0</td><td>female</td><td>NA</td></tr>
    <tr><td>66</td><td>NA  </td><td>59.0</td><td>male  </td><td>NA</td></tr>
    <tr><td>71</td><td>171 </td><td>  NA</td><td>male  </td><td>NA</td></tr>
</tbody>
</table>
</div>
</div>
<p>Замінимо також висоту на числове значення, а не текст:</p>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span> </span>
<span id="cb29-2"><a href="#cb29-2"></a>    <span class="fu">mutate</span>(<span class="at">person_height =</span> <span class="fu">str_remove</span>(data<span class="sc">$</span>person_height, <span class="at">pattern =</span> <span class="st">"[*]"</span>))</span>
<span id="cb29-3"><a href="#cb29-3"></a>data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>ERROR: Error in mutate(data, person_height = str_remove(data$person_height, pattern = "[*]")): could not find function "mutate"</code></pre>
</div>
</div>
<div class="cell" data-execution_count="73">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">person_height =</span> <span class="fu">as.numeric</span>(person_height))</span>
<span id="cb31-2"><a href="#cb31-2"></a>data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<table class="dataframe table table-sm table-striped">
<caption>A data.frame: 13 × 5</caption>
<thead>
    <tr><th scope="col">person_age</th><th scope="col">person_height</th><th scope="col">person_weight</th><th scope="col">person_gender</th><th scope="col">empty</th></tr>
    <tr><th scope="col">&lt;int&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;chr&gt;</th><th scope="col">&lt;lgl&gt;</th></tr>
</thead>
<tbody>
    <tr><td>23</td><td>185</td><td>  NA</td><td>male  </td><td>NA</td></tr>
    <tr><td>41</td><td>175</td><td>68.3</td><td>male  </td><td>NA</td></tr>
    <tr><td>11</td><td>142</td><td>55.4</td><td>female</td><td>NA</td></tr>
    <tr><td>12</td><td> NA</td><td>48.2</td><td>male  </td><td>NA</td></tr>
    <tr><td>54</td><td>191</td><td>  NA</td><td>female</td><td>NA</td></tr>
    <tr><td>32</td><td>168</td><td>78.0</td><td>female</td><td>NA</td></tr>
    <tr><td>22</td><td> NA</td><td>54.0</td><td>male  </td><td>NA</td></tr>
    <tr><td>21</td><td>165</td><td>  NA</td><td>male  </td><td>NA</td></tr>
    <tr><td>14</td><td> NA</td><td>90.2</td><td>male  </td><td>NA</td></tr>
    <tr><td>51</td><td>250</td><td>  NA</td><td>female</td><td>NA</td></tr>
    <tr><td>41</td><td> 20</td><td>81.0</td><td>female</td><td>NA</td></tr>
    <tr><td>66</td><td> NA</td><td>59.0</td><td>male  </td><td>NA</td></tr>
    <tr><td>71</td><td>171</td><td>  NA</td><td>male  </td><td>NA</td></tr>
</tbody>
</table>
</div>
</div>
<div class="cell" data-execution_count="74">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a><span class="fu">write.csv</span>(data, <span class="at">file =</span> <span class="st">"../../data/cleaned_titled.csv"</span>, <span class="at">row.names =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
</section>
</section>
<section id="заміна-пропусків-у-даних-missing-value-imputation" class="level2" data-number="20.3">
<h2 data-number="20.3" class="anchored" data-anchor-id="заміна-пропусків-у-даних-missing-value-imputation"><span class="header-section-number">20.3</span> Заміна пропусків у даних (Missing Value Imputation)</h2>
<p>Дані реального світу часто мають відсутні значення. Дані можуть мати відсутні значення з ряду причин, таких як спостереження, які не були записані, пошкодження даних тощо.</p>
<p><strong>Проблема</strong> - [x] Обробка відсутніх даних важлива, оскільки багато алгоритмів машинного навчання або програм для візуалізації та аналізу данихне підтримують дані з відсутніми значеннями.</p>
<p><strong>Рішення</strong></p>
<ul class="task-list">
<li><input type="checkbox" disabled="" checked="">Видалити рядки з відсутніми даними з набору даних.</li>
<li><input type="checkbox" disabled="" checked="">Замінити відсутні значення середніми/медіанними значеннями.</li>
</ul>
<p><strong>Примітка</strong></p>
<ul class="task-list">
<li><input type="checkbox" disabled="" checked="">Використовуйте бізнес-логіку/знання для окремого підходу до кожної змінної</li>
<li><input type="checkbox" disabled="" checked="">У разі малого розміру вибірки або великої частки спостережень із відсутніми значеннями бажано замінювати, а видаляти</li>
</ul>
<p>Некоректна інформація в даних може бути записана різними способами, наприклад у датасеті ці дані можуть бутьу визначені як <code>NA</code> <code>&lt;NA&gt;</code> <code>NULL</code> <code>undefinded</code> <code>Undefined</code>. Перед обробкою таких даних усі невизначені записи варто конвертувати у <code>NA</code>.</p>
<p>Щоб переглянути список усіх стовпців, що мають пропуски даних можна скористатися наступним кодом:</p>
<div class="cell" data-cell_id="2edff2f1ee974e58963d8a42523f1a1f" data-deepnote_cell_height="162.1875" data-deepnote_cell_type="code" data-execution_millis="19" data-execution_start="1650392273243" data-source_hash="8a50abf2" data-tags="[]" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="75">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a>data <span class="ot">&lt;-</span> data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"../../data/cleaned_titled.csv"</span>, <span class="at">na.strings =</span> <span class="fu">c</span>(<span class="st">"&lt;NA&gt;"</span>, <span class="st">"NA"</span>, <span class="st">"null"</span>, <span class="st">"undefined"</span>, <span class="st">"NULL"</span>, <span class="st">""</span>))</span>
<span id="cb33-2"><a href="#cb33-2"></a><span class="fu">glimpse</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 13
Columns: 5
$ person_age    &lt;int&gt; 23, 41, 11, 12, 54, 32, 22, 21, 14, 51, 41, 66, 71
$ person_height &lt;int&gt; 185, 175, 142, NA, 191, 168, NA, 165, NA, 250, 20, NA, 1~
$ person_weight &lt;dbl&gt; NA, 68.3, 55.4, 48.2, NA, 78.0, 54.0, NA, 90.2, NA, 81.0~
$ person_gender &lt;chr&gt; "male", "male", "female", "male", "female", "female", "m~
$ empty         &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA</code></pre>
</div>
</div>
<section id="перевірка-наявності-пропусків-у-даних" class="level3" data-number="20.3.1">
<h3 data-number="20.3.1" class="anchored" data-anchor-id="перевірка-наявності-пропусків-у-даних"><span class="header-section-number">20.3.1</span> Перевірка наявності пропусків у даних</h3>
<p>Пакет <strong>MICE (Multivariate Imputation via Chained Equations)</strong></p>
<div class="cell" data-execution_count="76">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a><span class="fu">library</span>(mice)</span>
<span id="cb35-2"><a href="#cb35-2"></a><span class="fu">md.pattern</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<table class="dataframe table table-sm table-striped">
<caption>A matrix: 4 × 6 of type dbl</caption>
<thead>
    <tr><th></th><th scope="col">person_age</th><th scope="col">person_gender</th><th scope="col">person_height</th><th scope="col">person_weight</th><th scope="col">empty</th><th scope="col"></th></tr>
</thead>
<tbody>
    <tr><th scope="row">4</th><td>1</td><td>1</td><td>1</td><td>1</td><td> 0</td><td> 1</td></tr>
    <tr><th scope="row">5</th><td>1</td><td>1</td><td>1</td><td>0</td><td> 0</td><td> 2</td></tr>
    <tr><th scope="row">4</th><td>1</td><td>1</td><td>0</td><td>1</td><td> 0</td><td> 2</td></tr>
    <tr><th scope="row"></th><td>0</td><td>0</td><td>4</td><td>5</td><td>13</td><td>22</td></tr>
</tbody>
</table>
</div>
<div class="cell-output cell-output-display">
<p><img src="data-cleaning_files/figure-html/cell-33-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="77">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1"></a><span class="fu">library</span>(VIM)</span>
<span id="cb36-2"><a href="#cb36-2"></a>mice_plot <span class="ot">&lt;-</span> <span class="fu">aggr</span>(data, </span>
<span id="cb36-3"><a href="#cb36-3"></a>                  <span class="at">col=</span><span class="fu">c</span>(<span class="st">'navyblue'</span>,<span class="st">'yellow'</span>),</span>
<span id="cb36-4"><a href="#cb36-4"></a>                  <span class="at">numbers=</span><span class="cn">TRUE</span>, </span>
<span id="cb36-5"><a href="#cb36-5"></a>                  <span class="at">sortVars=</span><span class="cn">TRUE</span>,</span>
<span id="cb36-6"><a href="#cb36-6"></a>                  <span class="at">labels=</span><span class="fu">names</span>(data), </span>
<span id="cb36-7"><a href="#cb36-7"></a>                  <span class="at">cex.axis=</span>.<span class="dv">7</span>,</span>
<span id="cb36-8"><a href="#cb36-8"></a>                  <span class="at">gap=</span><span class="dv">3</span>, </span>
<span id="cb36-9"><a href="#cb36-9"></a>                  <span class="at">ylab=</span><span class="fu">c</span>(<span class="st">"Missing data"</span>,<span class="st">"Pattern"</span>))</span>
<span id="cb36-10"><a href="#cb36-10"></a>mice_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 Variables sorted by number of missings: 
      Variable     Count
         empty 1.0000000
 person_weight 0.3846154
 person_height 0.3076923
    person_age 0.0000000
 person_gender 0.0000000</code></pre>
</div>
<div class="cell-output cell-output-display">
<pre><code>
 Missings in variables:
      Variable Count
 person_height     4
 person_weight     5
         empty    13</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="data-cleaning_files/figure-html/cell-34-output-3.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1"></a><span class="fu">library</span>(Amelia)</span>
<span id="cb39-2"><a href="#cb39-2"></a>Amelia<span class="sc">::</span><span class="fu">missmap</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning message in is.na(obj):
"is.na() applied to non-(list or vector) of type 'closure'"</code></pre>
</div>
<div class="cell-output cell-output-error">
<pre><code>ERROR: Error in colMeans(is.na(obj)): 'x' must be an array of at least two dimensions</code></pre>
</div>
</div>
<p>Також можна скористатися альтернативними макетами: <code>missForest</code>, <code>mi</code>.</p>
<hr>
</section>
<section id="видалення-пустих-рядків-та-сповпців-у-data.frame" class="level3" data-number="20.3.2">
<h3 data-number="20.3.2" class="anchored" data-anchor-id="видалення-пустих-рядків-та-сповпців-у-data.frame"><span class="header-section-number">20.3.2</span> Видалення пустих рядків та сповпців у <code>data.frame</code></h3>
<p>Переглянемо стовпці, що містять пропуски:</p>
<div class="cell" data-execution_count="79">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1"></a><span class="co"># Переглянемо список стовпців з пропусками</span></span>
<span id="cb42-2"><a href="#cb42-2"></a><span class="fu">colnames</span>(data)[<span class="fu">apply</span>(data, <span class="dv">2</span>, anyNA)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class="list-inline"><li>'person_height'</li><li>'person_weight'</li><li>'empty'</li></ol>
</div>
</div>
<p>Функція <code>complete.cases</code> повертає логічні значення</p>
<div class="cell" data-execution_count="80">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1"></a><span class="fu">complete.cases</span>(data) <span class="co"># бо є стовпець Empty</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class="list-inline"><li>FALSE</li><li>FALSE</li><li>FALSE</li><li>FALSE</li><li>FALSE</li><li>FALSE</li><li>FALSE</li><li>FALSE</li><li>FALSE</li><li>FALSE</li><li>FALSE</li><li>FALSE</li><li>FALSE</li></ol>
</div>
</div>
<p>Також видаляти стовпці та рядки з <code>data.frame</code> можна за допомогою пакету <code>janitor</code>.</p>
<div class="cell" data-execution_count="81">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1"></a><span class="fu">library</span>(janitor)</span>
<span id="cb44-2"><a href="#cb44-2"></a>data_cleaned <span class="ot">&lt;-</span> <span class="fu">remove_empty</span>(data, <span class="at">which =</span> <span class="fu">c</span>(<span class="st">"rows"</span>,<span class="st">"cols"</span>), <span class="at">quiet =</span> <span class="cn">FALSE</span>)</span>
<span id="cb44-3"><a href="#cb44-3"></a>data_cleaned</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>No empty rows to remove.

Removing 1 empty columns of 5 columns total (Removed: empty).
</code></pre>
</div>
<div class="cell-output cell-output-display">

<table class="dataframe table table-sm table-striped">
<caption>A data.frame: 13 × 4</caption>
<thead>
    <tr><th></th><th scope="col">person_age</th><th scope="col">person_height</th><th scope="col">person_weight</th><th scope="col">person_gender</th></tr>
    <tr><th></th><th scope="col">&lt;int&gt;</th><th scope="col">&lt;int&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;chr&gt;</th></tr>
</thead>
<tbody>
    <tr><th scope="row">1</th><td>23</td><td>185</td><td>  NA</td><td>male  </td></tr>
    <tr><th scope="row">2</th><td>41</td><td>175</td><td>68.3</td><td>male  </td></tr>
    <tr><th scope="row">3</th><td>11</td><td>142</td><td>55.4</td><td>female</td></tr>
    <tr><th scope="row">4</th><td>12</td><td> NA</td><td>48.2</td><td>male  </td></tr>
    <tr><th scope="row">5</th><td>54</td><td>191</td><td>  NA</td><td>female</td></tr>
    <tr><th scope="row">6</th><td>32</td><td>168</td><td>78.0</td><td>female</td></tr>
    <tr><th scope="row">7</th><td>22</td><td> NA</td><td>54.0</td><td>male  </td></tr>
    <tr><th scope="row">8</th><td>21</td><td>165</td><td>  NA</td><td>male  </td></tr>
    <tr><th scope="row">9</th><td>14</td><td> NA</td><td>90.2</td><td>male  </td></tr>
    <tr><th scope="row">10</th><td>51</td><td>250</td><td>  NA</td><td>female</td></tr>
    <tr><th scope="row">11</th><td>41</td><td> 20</td><td>81.0</td><td>female</td></tr>
    <tr><th scope="row">12</th><td>66</td><td> NA</td><td>59.0</td><td>male  </td></tr>
    <tr><th scope="row">13</th><td>71</td><td>171</td><td>  NA</td><td>male  </td></tr>
</tbody>
</table>
</div>
</div>
<div class="cell" data-execution_count="82">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1"></a><span class="fu">write.csv</span>(data_cleaned, <span class="at">file =</span> <span class="st">"../../data/cleaned_titled2.csv"</span>, <span class="at">row.names =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Як бачимо, колонка <code>empty</code> була видалена.</p>
<p>Щоб переглянути усі записи, що не мають пропусків скористаємося функцією <code>na.omit()</code>:</p>
<div class="cell" data-cell_id="e9b832b9949e4b75b374e5c5db2c1da3" data-deepnote_cell_height="214.125" data-deepnote_cell_type="code" data-deepnote_output_heights="[117.125]" data-execution_millis="43" data-execution_start="1650392276674" data-source_hash="2a6c7a77" data-tags="[]" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="83">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1"></a><span class="fu">na.omit</span>(data_cleaned)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<table class="dataframe table table-sm table-striped">
<caption>A data.frame: 4 × 4</caption>
<thead>
    <tr><th></th><th scope="col">person_age</th><th scope="col">person_height</th><th scope="col">person_weight</th><th scope="col">person_gender</th></tr>
    <tr><th></th><th scope="col">&lt;int&gt;</th><th scope="col">&lt;int&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;chr&gt;</th></tr>
</thead>
<tbody>
    <tr><th scope="row">2</th><td>41</td><td>175</td><td>68.3</td><td>male  </td></tr>
    <tr><th scope="row">3</th><td>11</td><td>142</td><td>55.4</td><td>female</td></tr>
    <tr><th scope="row">6</th><td>32</td><td>168</td><td>78.0</td><td>female</td></tr>
    <tr><th scope="row">11</th><td>41</td><td> 20</td><td>81.0</td><td>female</td></tr>
</tbody>
</table>
</div>
</div>
<p>Таким чином пропущені значення будуть видалені з датасети, якщо інформацію переприсвоїти <code>data &lt;- na.omit(data)</code></p>
<hr>
</section>
<section id="заміна-пропусків-у-data.frame" class="level3" data-number="20.3.3">
<h3 data-number="20.3.3" class="anchored" data-anchor-id="заміна-пропусків-у-data.frame"><span class="header-section-number">20.3.3</span> Заміна пропусків у <code>data.frame</code></h3>
<p>Існує ряд підходів, що використовуються для заміни пропущених значень у датасеті:</p>
<p><strong>Заміна на 0</strong> * Вставте пропущені значення нулем</p>
<p><strong>Заміна на медіану/середнє значення</strong> * Для числових змінних - середнє або медіана, мінімум, максимум * Для категоріальних змінних - мода (бувають випадки, коли моду доцільно використовувати і для цислових)</p>
<p><strong>Сегментна заміна</strong> * Визначення сегментів * Обчислення середнього/медіани/моди для сегментів * Замінити значення по сегментах * Наприклад, ми можемо сказати, що кількість опадів майже не змінюється для міст у певній області України, у такому випадку ми можемо для усіх міст з пропусками записати значення середнє по регіону.</p>
<p><strong>Інтелектуальна заміна</strong> (Частковий випадок сегментної заміни) * Заміна значень з використанням методів машинного навчання</p>
<section id="заміна-пропусків-на-нуль-0" class="level4" data-number="20.3.3.1">
<h4 data-number="20.3.3.1" class="anchored" data-anchor-id="заміна-пропусків-на-нуль-0"><span class="header-section-number">20.3.3.1</span> 3.3.1. Заміна пропусків на нуль (0)</h4>
<div class="cell" data-cell_id="1d5ff061612940d393a9da09a412e850" data-deepnote_cell_height="66" data-deepnote_cell_type="code" data-tags="[]" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="84">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"../../data/cleaned_titled2.csv"</span>)</span>
<span id="cb48-2"><a href="#cb48-2"></a>data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<table class="dataframe table table-sm table-striped">
<caption>A data.frame: 13 × 4</caption>
<thead>
    <tr><th scope="col">person_age</th><th scope="col">person_height</th><th scope="col">person_weight</th><th scope="col">person_gender</th></tr>
    <tr><th scope="col">&lt;int&gt;</th><th scope="col">&lt;int&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;chr&gt;</th></tr>
</thead>
<tbody>
    <tr><td>23</td><td>185</td><td>  NA</td><td>male  </td></tr>
    <tr><td>41</td><td>175</td><td>68.3</td><td>male  </td></tr>
    <tr><td>11</td><td>142</td><td>55.4</td><td>female</td></tr>
    <tr><td>12</td><td> NA</td><td>48.2</td><td>male  </td></tr>
    <tr><td>54</td><td>191</td><td>  NA</td><td>female</td></tr>
    <tr><td>32</td><td>168</td><td>78.0</td><td>female</td></tr>
    <tr><td>22</td><td> NA</td><td>54.0</td><td>male  </td></tr>
    <tr><td>21</td><td>165</td><td>  NA</td><td>male  </td></tr>
    <tr><td>14</td><td> NA</td><td>90.2</td><td>male  </td></tr>
    <tr><td>51</td><td>250</td><td>  NA</td><td>female</td></tr>
    <tr><td>41</td><td> 20</td><td>81.0</td><td>female</td></tr>
    <tr><td>66</td><td> NA</td><td>59.0</td><td>male  </td></tr>
    <tr><td>71</td><td>171</td><td>  NA</td><td>male  </td></tr>
</tbody>
</table>
</div>
</div>
<p>Замінимо інформацію про вагу з пропусками на <code>0</code>:</p>
<div class="cell" data-cell_id="959cf61d7db74bc1a7ce5f3ec778368f" data-deepnote_cell_height="66" data-deepnote_cell_type="code" data-tags="[]" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="87">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1"></a>data_w0 <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">person_weight =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(person_weight), <span class="dv">0</span>, person_weight))</span>
<span id="cb49-2"><a href="#cb49-2"></a>data_w0</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<table class="dataframe table table-sm table-striped">
<caption>A data.frame: 13 × 4</caption>
<thead>
    <tr><th scope="col">person_age</th><th scope="col">person_height</th><th scope="col">person_weight</th><th scope="col">person_gender</th></tr>
    <tr><th scope="col">&lt;int&gt;</th><th scope="col">&lt;int&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;chr&gt;</th></tr>
</thead>
<tbody>
    <tr><td>23</td><td>185</td><td> 0.0</td><td>male  </td></tr>
    <tr><td>41</td><td>175</td><td>68.3</td><td>male  </td></tr>
    <tr><td>11</td><td>142</td><td>55.4</td><td>female</td></tr>
    <tr><td>12</td><td> NA</td><td>48.2</td><td>male  </td></tr>
    <tr><td>54</td><td>191</td><td> 0.0</td><td>female</td></tr>
    <tr><td>32</td><td>168</td><td>78.0</td><td>female</td></tr>
    <tr><td>22</td><td> NA</td><td>54.0</td><td>male  </td></tr>
    <tr><td>21</td><td>165</td><td> 0.0</td><td>male  </td></tr>
    <tr><td>14</td><td> NA</td><td>90.2</td><td>male  </td></tr>
    <tr><td>51</td><td>250</td><td> 0.0</td><td>female</td></tr>
    <tr><td>41</td><td> 20</td><td>81.0</td><td>female</td></tr>
    <tr><td>66</td><td> NA</td><td>59.0</td><td>male  </td></tr>
    <tr><td>71</td><td>171</td><td> 0.0</td><td>male  </td></tr>
</tbody>
</table>
</div>
</div>
<div class="cell" data-execution_count="88">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1"></a><span class="co"># Без dplyr</span></span>
<span id="cb50-2"><a href="#cb50-2"></a>data_w0 <span class="ot">&lt;-</span> data</span>
<span id="cb50-3"><a href="#cb50-3"></a>data_w0[<span class="fu">is.na</span>(data_w0<span class="sc">$</span>person_weight), <span class="st">"person_weight"</span>] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb50-4"><a href="#cb50-4"></a>data_w0</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<table class="dataframe table table-sm table-striped">
<caption>A data.frame: 13 × 4</caption>
<thead>
    <tr><th scope="col">person_age</th><th scope="col">person_height</th><th scope="col">person_weight</th><th scope="col">person_gender</th></tr>
    <tr><th scope="col">&lt;int&gt;</th><th scope="col">&lt;int&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;chr&gt;</th></tr>
</thead>
<tbody>
    <tr><td>23</td><td>185</td><td> 0.0</td><td>male  </td></tr>
    <tr><td>41</td><td>175</td><td>68.3</td><td>male  </td></tr>
    <tr><td>11</td><td>142</td><td>55.4</td><td>female</td></tr>
    <tr><td>12</td><td> NA</td><td>48.2</td><td>male  </td></tr>
    <tr><td>54</td><td>191</td><td> 0.0</td><td>female</td></tr>
    <tr><td>32</td><td>168</td><td>78.0</td><td>female</td></tr>
    <tr><td>22</td><td> NA</td><td>54.0</td><td>male  </td></tr>
    <tr><td>21</td><td>165</td><td> 0.0</td><td>male  </td></tr>
    <tr><td>14</td><td> NA</td><td>90.2</td><td>male  </td></tr>
    <tr><td>51</td><td>250</td><td> 0.0</td><td>female</td></tr>
    <tr><td>41</td><td> 20</td><td>81.0</td><td>female</td></tr>
    <tr><td>66</td><td> NA</td><td>59.0</td><td>male  </td></tr>
    <tr><td>71</td><td>171</td><td> 0.0</td><td>male  </td></tr>
</tbody>
</table>
</div>
</div>
<p>Зробити заміну для усіх числових стовпців:</p>
<div class="cell" data-execution_count="89">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1"></a><span class="fu">library</span>(tidyr) <span class="co"># for replace_na()</span></span>
<span id="cb51-2"><a href="#cb51-2"></a>data_all <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span> <span class="fu">mutate_if</span>(is.numeric , replace_na, <span class="at">replace =</span> <span class="dv">0</span>)</span>
<span id="cb51-3"><a href="#cb51-3"></a>data_all</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'tidyr'


The following object is masked from 'package:stringdist':

    extract

</code></pre>
</div>
<div class="cell-output cell-output-display">

<table class="dataframe table table-sm table-striped">
<caption>A data.frame: 13 × 4</caption>
<thead>
    <tr><th scope="col">person_age</th><th scope="col">person_height</th><th scope="col">person_weight</th><th scope="col">person_gender</th></tr>
    <tr><th scope="col">&lt;int&gt;</th><th scope="col">&lt;int&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;chr&gt;</th></tr>
</thead>
<tbody>
    <tr><td>23</td><td>185</td><td> 0.0</td><td>male  </td></tr>
    <tr><td>41</td><td>175</td><td>68.3</td><td>male  </td></tr>
    <tr><td>11</td><td>142</td><td>55.4</td><td>female</td></tr>
    <tr><td>12</td><td>  0</td><td>48.2</td><td>male  </td></tr>
    <tr><td>54</td><td>191</td><td> 0.0</td><td>female</td></tr>
    <tr><td>32</td><td>168</td><td>78.0</td><td>female</td></tr>
    <tr><td>22</td><td>  0</td><td>54.0</td><td>male  </td></tr>
    <tr><td>21</td><td>165</td><td> 0.0</td><td>male  </td></tr>
    <tr><td>14</td><td>  0</td><td>90.2</td><td>male  </td></tr>
    <tr><td>51</td><td>250</td><td> 0.0</td><td>female</td></tr>
    <tr><td>41</td><td> 20</td><td>81.0</td><td>female</td></tr>
    <tr><td>66</td><td>  0</td><td>59.0</td><td>male  </td></tr>
    <tr><td>71</td><td>171</td><td> 0.0</td><td>male  </td></tr>
</tbody>
</table>
</div>
</div>
<hr>
</section>
<section id="базова-числова-заміна-пропусків" class="level4" data-number="20.3.3.2">
<h4 data-number="20.3.3.2" class="anchored" data-anchor-id="базова-числова-заміна-пропусків"><span class="header-section-number">20.3.3.2</span> Базова числова заміна пропусків</h4>
<p>Заміна на константи або обчислені значення є стандарним підходом. Так, наприклад, заміна певного значення на середнє матиме вигляд:</p>
<div class="cell" data-execution_count="90">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1"></a>data_m <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span> </span>
<span id="cb53-2"><a href="#cb53-2"></a>    <span class="fu">mutate</span>(<span class="at">person_weight =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(person_weight), <span class="fu">mean</span>(data<span class="sc">$</span>person_weight, <span class="at">na.rm =</span> T), person_weight))</span>
<span id="cb53-3"><a href="#cb53-3"></a>data_m</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<table class="dataframe table table-sm table-striped">
<caption>A data.frame: 13 × 4</caption>
<thead>
    <tr><th scope="col">person_age</th><th scope="col">person_height</th><th scope="col">person_weight</th><th scope="col">person_gender</th></tr>
    <tr><th scope="col">&lt;int&gt;</th><th scope="col">&lt;int&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;chr&gt;</th></tr>
</thead>
<tbody>
    <tr><td>23</td><td>185</td><td>66.7625</td><td>male  </td></tr>
    <tr><td>41</td><td>175</td><td>68.3000</td><td>male  </td></tr>
    <tr><td>11</td><td>142</td><td>55.4000</td><td>female</td></tr>
    <tr><td>12</td><td> NA</td><td>48.2000</td><td>male  </td></tr>
    <tr><td>54</td><td>191</td><td>66.7625</td><td>female</td></tr>
    <tr><td>32</td><td>168</td><td>78.0000</td><td>female</td></tr>
    <tr><td>22</td><td> NA</td><td>54.0000</td><td>male  </td></tr>
    <tr><td>21</td><td>165</td><td>66.7625</td><td>male  </td></tr>
    <tr><td>14</td><td> NA</td><td>90.2000</td><td>male  </td></tr>
    <tr><td>51</td><td>250</td><td>66.7625</td><td>female</td></tr>
    <tr><td>41</td><td> 20</td><td>81.0000</td><td>female</td></tr>
    <tr><td>66</td><td> NA</td><td>59.0000</td><td>male  </td></tr>
    <tr><td>71</td><td>171</td><td>66.7625</td><td>male  </td></tr>
</tbody>
</table>
</div>
</div>
<p>Заміна на min, max, median не відрізняється.</p>
<p>Якщо виникає потреба замінити, наприклад, усі значення на медіану у всіх стовпцях за один прохід можна скористатися функцією <code>mutate_if()</code>:</p>
<div class="cell" data-execution_count="91">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1"></a>data_all <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span> </span>
<span id="cb54-2"><a href="#cb54-2"></a>    <span class="fu">mutate_if</span>(is.numeric, <span class="cf">function</span>(x) <span class="fu">ifelse</span>(<span class="fu">is.na</span>(x), <span class="fu">median</span>(x, <span class="at">na.rm =</span> T), x))</span>
<span id="cb54-3"><a href="#cb54-3"></a>data_all</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<table class="dataframe table table-sm table-striped">
<caption>A data.frame: 13 × 4</caption>
<thead>
    <tr><th scope="col">person_age</th><th scope="col">person_height</th><th scope="col">person_weight</th><th scope="col">person_gender</th></tr>
    <tr><th scope="col">&lt;int&gt;</th><th scope="col">&lt;int&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;chr&gt;</th></tr>
</thead>
<tbody>
    <tr><td>23</td><td>185</td><td>63.65</td><td>male  </td></tr>
    <tr><td>41</td><td>175</td><td>68.30</td><td>male  </td></tr>
    <tr><td>11</td><td>142</td><td>55.40</td><td>female</td></tr>
    <tr><td>12</td><td>171</td><td>48.20</td><td>male  </td></tr>
    <tr><td>54</td><td>191</td><td>63.65</td><td>female</td></tr>
    <tr><td>32</td><td>168</td><td>78.00</td><td>female</td></tr>
    <tr><td>22</td><td>171</td><td>54.00</td><td>male  </td></tr>
    <tr><td>21</td><td>165</td><td>63.65</td><td>male  </td></tr>
    <tr><td>14</td><td>171</td><td>90.20</td><td>male  </td></tr>
    <tr><td>51</td><td>250</td><td>63.65</td><td>female</td></tr>
    <tr><td>41</td><td> 20</td><td>81.00</td><td>female</td></tr>
    <tr><td>66</td><td>171</td><td>59.00</td><td>male  </td></tr>
    <tr><td>71</td><td>171</td><td>63.65</td><td>male  </td></tr>
</tbody>
</table>
</div>
</div>
<p>Розгялнемо кілька бібліотек для перевірки даних на наявність про</p>
<p>Ще одним із варіантів заміни значень може бути використання бібліотеки <code>Hmisc</code>:</p>
<div class="cell" data-execution_count="92">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1"></a><span class="fu">library</span>(Hmisc)</span>
<span id="cb55-2"><a href="#cb55-2"></a>data_wm <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">person_weight =</span> <span class="fu">impute</span>(data<span class="sc">$</span>person_weight, <span class="at">fun =</span> mean)) <span class="co"># mean imputation</span></span>
<span id="cb55-3"><a href="#cb55-3"></a><span class="co"># Аналогічно можна замінити на min,max, median чи інші функції</span></span>
<span id="cb55-4"><a href="#cb55-4"></a>data_wm </span>
<span id="cb55-5"><a href="#cb55-5"></a><span class="co"># * Значення із * - замінені</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<table class="dataframe table table-sm table-striped">
<caption>A data.frame: 13 × 4</caption>
<thead>
    <tr><th scope="col">person_age</th><th scope="col">person_height</th><th scope="col">person_weight</th><th scope="col">person_gender</th></tr>
    <tr><th scope="col">&lt;int&gt;</th><th scope="col">&lt;int&gt;</th><th scope="col">&lt;impute&gt;</th><th scope="col">&lt;chr&gt;</th></tr>
</thead>
<tbody>
    <tr><td>23</td><td>185</td><td>66.7625</td><td>male  </td></tr>
    <tr><td>41</td><td>175</td><td>68.3000</td><td>male  </td></tr>
    <tr><td>11</td><td>142</td><td>55.4000</td><td>female</td></tr>
    <tr><td>12</td><td> NA</td><td>48.2000</td><td>male  </td></tr>
    <tr><td>54</td><td>191</td><td>66.7625</td><td>female</td></tr>
    <tr><td>32</td><td>168</td><td>78.0000</td><td>female</td></tr>
    <tr><td>22</td><td> NA</td><td>54.0000</td><td>male  </td></tr>
    <tr><td>21</td><td>165</td><td>66.7625</td><td>male  </td></tr>
    <tr><td>14</td><td> NA</td><td>90.2000</td><td>male  </td></tr>
    <tr><td>51</td><td>250</td><td>66.7625</td><td>female</td></tr>
    <tr><td>41</td><td> 20</td><td>81.0000</td><td>female</td></tr>
    <tr><td>66</td><td> NA</td><td>59.0000</td><td>male  </td></tr>
    <tr><td>71</td><td>171</td><td>66.7625</td><td>male  </td></tr>
</tbody>
</table>
</div>
</div>
<hr>
</section>
<section id="hot-deck-imputation-як-перекласти" class="level4" data-number="20.3.3.3">
<h4 data-number="20.3.3.3" class="anchored" data-anchor-id="hot-deck-imputation-як-перекласти"><span class="header-section-number">20.3.3.3</span> Hot deck imputation (як перекласти???)</h4>
<p>Метод <code>Hot deck imputation</code> передбачає, що пропущені значення обчислюються шляхом копіювання значень із подібних записів у тому ж наборі даних.</p>
<p>Основне питання при <code>Hot deck imputation</code> полягає в тому, як вибрати значення заміни. Одним із поширених підходів є випадковий відбір:</p>
<div class="cell" data-execution_count="93">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1"></a><span class="co"># set.seed(1)</span></span>
<span id="cb56-2"><a href="#cb56-2"></a>data_hot <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">person_weight =</span> <span class="fu">impute</span>(data<span class="sc">$</span>person_weight, <span class="st">"random"</span>)) </span>
<span id="cb56-3"><a href="#cb56-3"></a>data_hot </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<table class="dataframe table table-sm table-striped">
<caption>A data.frame: 13 × 4</caption>
<thead>
    <tr><th scope="col">person_age</th><th scope="col">person_height</th><th scope="col">person_weight</th><th scope="col">person_gender</th></tr>
    <tr><th scope="col">&lt;int&gt;</th><th scope="col">&lt;int&gt;</th><th scope="col">&lt;impute&gt;</th><th scope="col">&lt;chr&gt;</th></tr>
</thead>
<tbody>
    <tr><td>23</td><td>185</td><td>59.0</td><td>male  </td></tr>
    <tr><td>41</td><td>175</td><td>68.3</td><td>male  </td></tr>
    <tr><td>11</td><td>142</td><td>55.4</td><td>female</td></tr>
    <tr><td>12</td><td> NA</td><td>48.2</td><td>male  </td></tr>
    <tr><td>54</td><td>191</td><td>78.0</td><td>female</td></tr>
    <tr><td>32</td><td>168</td><td>78.0</td><td>female</td></tr>
    <tr><td>22</td><td> NA</td><td>54.0</td><td>male  </td></tr>
    <tr><td>21</td><td>165</td><td>68.3</td><td>male  </td></tr>
    <tr><td>14</td><td> NA</td><td>90.2</td><td>male  </td></tr>
    <tr><td>51</td><td>250</td><td>48.2</td><td>female</td></tr>
    <tr><td>41</td><td> 20</td><td>81.0</td><td>female</td></tr>
    <tr><td>66</td><td> NA</td><td>59.0</td><td>male  </td></tr>
    <tr><td>71</td><td>171</td><td>90.2</td><td>male  </td></tr>
</tbody>
</table>
</div>
</div>
<p>Вихідне значення залежить від значення <code>seed</code>.</p>
<hr>
</section>
<section id="сегментна-заміна-пропусків" class="level4" data-number="20.3.3.4">
<h4 data-number="20.3.3.4" class="anchored" data-anchor-id="сегментна-заміна-пропусків"><span class="header-section-number">20.3.3.4</span> Сегментна заміна пропусків</h4>
<p>Заміна по сегментах часто дозволяє будувати точніші математичні моделі, адже групові середні краще описують явища і процеси, ніж загальні для всієї вибірки.</p>
<p>Знайдемо середні значення ваги за статтю та використаємо ці значення для заміни пропусків у даних.</p>
<div class="cell" data-execution_count="94">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1"></a>data_sgm <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span> </span>
<span id="cb57-2"><a href="#cb57-2"></a>                <span class="fu">group_by</span>(person_gender) <span class="sc">|&gt;</span></span>
<span id="cb57-3"><a href="#cb57-3"></a>                <span class="fu">mutate</span>(<span class="at">person_weight =</span> <span class="fu">replace_na</span>(person_weight, <span class="fu">mean</span>(person_weight, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)))</span>
<span id="cb57-4"><a href="#cb57-4"></a>data_sgm</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<table class="dataframe table table-sm table-striped">
<caption>A grouped_df: 13 × 4</caption>
<thead>
    <tr><th scope="col">person_age</th><th scope="col">person_height</th><th scope="col">person_weight</th><th scope="col">person_gender</th></tr>
    <tr><th scope="col">&lt;int&gt;</th><th scope="col">&lt;int&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;chr&gt;</th></tr>
</thead>
<tbody>
    <tr><td>23</td><td>185</td><td>63.94000</td><td>male  </td></tr>
    <tr><td>41</td><td>175</td><td>68.30000</td><td>male  </td></tr>
    <tr><td>11</td><td>142</td><td>55.40000</td><td>female</td></tr>
    <tr><td>12</td><td> NA</td><td>48.20000</td><td>male  </td></tr>
    <tr><td>54</td><td>191</td><td>71.46667</td><td>female</td></tr>
    <tr><td>32</td><td>168</td><td>78.00000</td><td>female</td></tr>
    <tr><td>22</td><td> NA</td><td>54.00000</td><td>male  </td></tr>
    <tr><td>21</td><td>165</td><td>63.94000</td><td>male  </td></tr>
    <tr><td>14</td><td> NA</td><td>90.20000</td><td>male  </td></tr>
    <tr><td>51</td><td>250</td><td>71.46667</td><td>female</td></tr>
    <tr><td>41</td><td> 20</td><td>81.00000</td><td>female</td></tr>
    <tr><td>66</td><td> NA</td><td>59.00000</td><td>male  </td></tr>
    <tr><td>71</td><td>171</td><td>63.94000</td><td>male  </td></tr>
</tbody>
</table>
</div>
</div>
<p>Також можна здійснити заміну значень по усіх стовпцях датасету за один раз. Проте не варто такий підхід використовувати постійно, а враховувати бізнес-логіку процесів, що вивчаються.</p>
<div class="cell" data-execution_count="95">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1"></a>data_sgm2 <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> </span>
<span id="cb58-2"><a href="#cb58-2"></a>  <span class="fu">group_by</span>(person_gender) <span class="sc">%&gt;%</span> </span>
<span id="cb58-3"><a href="#cb58-3"></a>    <span class="fu">mutate</span>(</span>
<span id="cb58-4"><a href="#cb58-4"></a>      <span class="fu">across</span>(<span class="fu">everything</span>(), <span class="sc">~</span><span class="fu">replace_na</span>(.x, <span class="fu">min</span>(.x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)))</span>
<span id="cb58-5"><a href="#cb58-5"></a>    )</span>
<span id="cb58-6"><a href="#cb58-6"></a>data_sgm2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<table class="dataframe table table-sm table-striped">
<caption>A grouped_df: 13 × 4</caption>
<thead>
    <tr><th scope="col">person_age</th><th scope="col">person_height</th><th scope="col">person_weight</th><th scope="col">person_gender</th></tr>
    <tr><th scope="col">&lt;int&gt;</th><th scope="col">&lt;int&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;chr&gt;</th></tr>
</thead>
<tbody>
    <tr><td>23</td><td>185</td><td>48.2</td><td>male  </td></tr>
    <tr><td>41</td><td>175</td><td>68.3</td><td>male  </td></tr>
    <tr><td>11</td><td>142</td><td>55.4</td><td>female</td></tr>
    <tr><td>12</td><td>165</td><td>48.2</td><td>male  </td></tr>
    <tr><td>54</td><td>191</td><td>55.4</td><td>female</td></tr>
    <tr><td>32</td><td>168</td><td>78.0</td><td>female</td></tr>
    <tr><td>22</td><td>165</td><td>54.0</td><td>male  </td></tr>
    <tr><td>21</td><td>165</td><td>48.2</td><td>male  </td></tr>
    <tr><td>14</td><td>165</td><td>90.2</td><td>male  </td></tr>
    <tr><td>51</td><td>250</td><td>55.4</td><td>female</td></tr>
    <tr><td>41</td><td> 20</td><td>81.0</td><td>female</td></tr>
    <tr><td>66</td><td>165</td><td>59.0</td><td>male  </td></tr>
    <tr><td>71</td><td>171</td><td>48.2</td><td>male  </td></tr>
</tbody>
</table>
</div>
</div>
<p>Якщо ж є потреба замінювати по окремих стовпцях, то їх можна вказати замість <code>everything()</code>: <code>across(c("person_height", "person_weight"), ~replace_na(.x, min(.x, na.rm = TRUE)))</code>.</p>
<p>Іншим варіантом може бути вказання номерів колонок: <code>across(c(1,3), ~replace_na(.x, min(.x, na.rm = TRUE)))</code></p>
<hr>
</section>
<section id="інтелектуальні-методи-заміни" class="level4" data-number="20.3.3.5">
<h4 data-number="20.3.3.5" class="anchored" data-anchor-id="інтелектуальні-методи-заміни"><span class="header-section-number">20.3.3.5</span> Інтелектуальні методи заміни</h4>
<p>Теоретично інтелектуальні методи заміни пропусків є найкращими, адже враховують математичні залежності у даних.</p>
<div class="cell" data-execution_count="96">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1"></a><span class="fu">library</span>(VIM)</span>
<span id="cb59-2"><a href="#cb59-2"></a>data_knn <span class="ot">&lt;-</span> <span class="fu">kNN</span>(data)</span>
<span id="cb59-3"><a href="#cb59-3"></a>data_knn</span>
<span id="cb59-4"><a href="#cb59-4"></a>data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<table class="dataframe table table-sm table-striped">
<caption>A data.frame: 13 × 8</caption>
<thead>
    <tr><th scope="col">person_age</th><th scope="col">person_height</th><th scope="col">person_weight</th><th scope="col">person_gender</th><th scope="col">person_age_imp</th><th scope="col">person_height_imp</th><th scope="col">person_weight_imp</th><th scope="col">person_gender_imp</th></tr>
    <tr><th scope="col">&lt;int&gt;</th><th scope="col">&lt;int&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;chr&gt;</th><th scope="col">&lt;lgl&gt;</th><th scope="col">&lt;lgl&gt;</th><th scope="col">&lt;lgl&gt;</th><th scope="col">&lt;lgl&gt;</th></tr>
</thead>
<tbody>
    <tr><td>23</td><td>185</td><td>59.0</td><td>male  </td><td>FALSE</td><td>FALSE</td><td> TRUE</td><td>FALSE</td></tr>
    <tr><td>41</td><td>175</td><td>68.3</td><td>male  </td><td>FALSE</td><td>FALSE</td><td>FALSE</td><td>FALSE</td></tr>
    <tr><td>11</td><td>142</td><td>55.4</td><td>female</td><td>FALSE</td><td>FALSE</td><td>FALSE</td><td>FALSE</td></tr>
    <tr><td>12</td><td>168</td><td>48.2</td><td>male  </td><td>FALSE</td><td> TRUE</td><td>FALSE</td><td>FALSE</td></tr>
    <tr><td>54</td><td>191</td><td>68.3</td><td>female</td><td>FALSE</td><td>FALSE</td><td> TRUE</td><td>FALSE</td></tr>
    <tr><td>32</td><td>168</td><td>78.0</td><td>female</td><td>FALSE</td><td>FALSE</td><td>FALSE</td><td>FALSE</td></tr>
    <tr><td>22</td><td>168</td><td>54.0</td><td>male  </td><td>FALSE</td><td> TRUE</td><td>FALSE</td><td>FALSE</td></tr>
    <tr><td>21</td><td>165</td><td>59.0</td><td>male  </td><td>FALSE</td><td>FALSE</td><td> TRUE</td><td>FALSE</td></tr>
    <tr><td>14</td><td>168</td><td>90.2</td><td>male  </td><td>FALSE</td><td> TRUE</td><td>FALSE</td><td>FALSE</td></tr>
    <tr><td>51</td><td>250</td><td>68.3</td><td>female</td><td>FALSE</td><td>FALSE</td><td> TRUE</td><td>FALSE</td></tr>
    <tr><td>41</td><td> 20</td><td>81.0</td><td>female</td><td>FALSE</td><td>FALSE</td><td>FALSE</td><td>FALSE</td></tr>
    <tr><td>66</td><td>168</td><td>59.0</td><td>male  </td><td>FALSE</td><td> TRUE</td><td>FALSE</td><td>FALSE</td></tr>
    <tr><td>71</td><td>171</td><td>59.0</td><td>male  </td><td>FALSE</td><td>FALSE</td><td> TRUE</td><td>FALSE</td></tr>
</tbody>
</table>
</div>
<div class="cell-output cell-output-display">

<table class="dataframe table table-sm table-striped">
<caption>A data.frame: 13 × 4</caption>
<thead>
    <tr><th scope="col">person_age</th><th scope="col">person_height</th><th scope="col">person_weight</th><th scope="col">person_gender</th></tr>
    <tr><th scope="col">&lt;int&gt;</th><th scope="col">&lt;int&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;chr&gt;</th></tr>
</thead>
<tbody>
    <tr><td>23</td><td>185</td><td>  NA</td><td>male  </td></tr>
    <tr><td>41</td><td>175</td><td>68.3</td><td>male  </td></tr>
    <tr><td>11</td><td>142</td><td>55.4</td><td>female</td></tr>
    <tr><td>12</td><td> NA</td><td>48.2</td><td>male  </td></tr>
    <tr><td>54</td><td>191</td><td>  NA</td><td>female</td></tr>
    <tr><td>32</td><td>168</td><td>78.0</td><td>female</td></tr>
    <tr><td>22</td><td> NA</td><td>54.0</td><td>male  </td></tr>
    <tr><td>21</td><td>165</td><td>  NA</td><td>male  </td></tr>
    <tr><td>14</td><td> NA</td><td>90.2</td><td>male  </td></tr>
    <tr><td>51</td><td>250</td><td>  NA</td><td>female</td></tr>
    <tr><td>41</td><td> 20</td><td>81.0</td><td>female</td></tr>
    <tr><td>66</td><td> NA</td><td>59.0</td><td>male  </td></tr>
    <tr><td>71</td><td>171</td><td>  NA</td><td>male  </td></tr>
</tbody>
</table>
</div>
</div>
<p>Ще одним схожим методом заміни пропусків може бути здійснення прогнозів на основі регресії чи складніших математичних методів пропусків.</p>
<hr>
</section>
</section>
</section>
<section id="аналіз-та-обробка-статистичних-викидів-у-даних" class="level2" data-number="20.4">
<h2 data-number="20.4" class="anchored" data-anchor-id="аналіз-та-обробка-статистичних-викидів-у-даних"><span class="header-section-number">20.4</span> Аналіз та обробка статистичних викидів у даних</h2>
<p><strong>Виявлення аномалій</strong>&nbsp;— це сукупність методів, призначених для виявлення незвичайних точок даних, які мають вирішальне значення для виявлення шахрайства та захисту комп’ютерних мереж від зловмисної діяльності.</p>
<p><strong>Аномалія</strong> - точка даних або набір точок даних, які не мають таку саму структуру та поведінку, що й інші дані.</p>
<p>Аномалії у даних можуть мати різну природу та по різному себе проявляти:</p>
<ul class="task-list">
<li><input type="checkbox" disabled="" checked="">Точкова аномалія<ul>
<li>Єдина точка даних</li>
<li>Незвично в порівнянні з іншими даними</li>
</ul></li>
</ul>
<p>Приклад: одна добова висока температура 41°С серед ряду звичайних весняних днів</p>
<div class="cell" data-execution_count="97">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1"></a>temp <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">15</span>, <span class="dv">17</span>, <span class="dv">19</span>, <span class="dv">12</span>, <span class="dv">30</span>, <span class="dv">41</span>, <span class="dv">17</span>, <span class="dv">20</span>)</span>
<span id="cb60-2"><a href="#cb60-2"></a><span class="fu">boxplot</span>(temp, <span class="at">ylab =</span> <span class="st">"Celcium"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="data-cleaning_files/figure-html/cell-52-output-1.png" class="img-fluid"></p>
</div>
</div>
<ul class="task-list">
<li><input type="checkbox" disabled="" checked="">Колективна аномалія<ul>
<li>Аномальна колекція екземплярів даних</li>
<li>Незвично, якщо розглядати разом</li>
</ul></li>
</ul>
<p>Опишемо набір даних, до використовуватиметься надалі для прикладів.</p>
<p><code>river_eco</code> - це data.frame, що містить такі три стовпці: - [x] <code>index</code> - цілі числа, що описують порядок спостережень нітратів; - [x] <code>nitrate</code> - місячні концентрації розчинених нітратів у річці; - [x] <code>month</code> - змінна, що містить місяць для кожного спостереження нітратів</p>
<p>Нам потрібно дослідити стовпець <code>nitrate</code>, щоб оцінити наявність точкових аномалій у даних.</p>
<div class="cell" data-execution_count="98">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1"></a>river_data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"../../data/river_eco.csv"</span>)</span>
<span id="cb61-2"><a href="#cb61-2"></a><span class="fu">head</span>(river_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<table class="dataframe table table-sm table-striped">
<caption>A data.frame: 6 × 3</caption>
<thead>
    <tr><th></th><th scope="col">index</th><th scope="col">nitrate</th><th scope="col">months</th></tr>
    <tr><th></th><th scope="col">&lt;int&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;chr&gt;</th></tr>
</thead>
<tbody>
    <tr><th scope="row">1</th><td>1</td><td>1.581</td><td>January </td></tr>
    <tr><th scope="row">2</th><td>2</td><td>1.323</td><td>February</td></tr>
    <tr><th scope="row">3</th><td>3</td><td>1.140</td><td>March   </td></tr>
    <tr><th scope="row">4</th><td>4</td><td>1.245</td><td>April   </td></tr>
    <tr><th scope="row">5</th><td>5</td><td>1.072</td><td>May     </td></tr>
    <tr><th scope="row">6</th><td>6</td><td>1.483</td><td>June    </td></tr>
</tbody>
</table>
</div>
</div>
<p>Переглянемо описову статистику показника нітрати:</p>
<div class="cell" data-execution_count="99">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1"></a><span class="fu">summary</span>(river_data<span class="sc">$</span>nitrate)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
 0.5920  0.9485  1.0680  1.0649  1.1700  1.8970 </code></pre>
</div>
</div>
<p>Як видно, медіана та середнє відрізняються не дуже.</p>
<p>Далі перевіримо наявність викидів у даних за допомогою <code>boxplot</code>:</p>
<div class="cell" data-execution_count="100">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1"></a><span class="fu">boxplot</span>(river_data<span class="sc">$</span>nitrate)</span>
<span id="cb64-2"><a href="#cb64-2"></a><span class="co"># Додамо лінії 1 та 3 квантилів</span></span>
<span id="cb64-3"><a href="#cb64-3"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fu">quantile</span>(river_data<span class="sc">$</span>nitrate,<span class="fl">0.25</span>),<span class="at">col=</span><span class="st">"red"</span>,<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb64-4"><a href="#cb64-4"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fu">quantile</span>(river_data<span class="sc">$</span>nitrate,<span class="fl">0.75</span>),<span class="at">col=</span><span class="st">"red"</span>,<span class="at">lty=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="data-cleaning_files/figure-html/cell-55-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>Також виведемо номери рядків спостереженнь, що є викидами:</p>
<div class="cell" data-execution_count="101">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1"></a><span class="fu">boxplot.stats</span>(river_data<span class="sc">$</span>nitrate)<span class="sc">$</span>out</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class="list-inline"><li>1.581</li><li>1.643</li><li>1.533</li><li>1.517</li><li>1.897</li><li>0.592</li></ol>
</div>
</div>
<div class="cell" data-execution_count="102">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1"></a><span class="fu">hist</span>(river_data<span class="sc">$</span>nitrate, <span class="at">xlab =</span> <span class="st">"Nitrate concentration"</span>, <span class="at">breaks =</span> <span class="dv">40</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="data-cleaning_files/figure-html/cell-57-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="103">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1"></a><span class="fu">plot</span>(nitrate <span class="sc">~</span> index, <span class="at">data =</span> river_data, <span class="at">type =</span> <span class="st">"o"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="data-cleaning_files/figure-html/cell-58-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="104">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1"></a><span class="co"># Середньомісячний вміст нітратів у річці</span></span>
<span id="cb68-2"><a href="#cb68-2"></a>river_grouped <span class="ot">&lt;-</span> river_data <span class="sc">|&gt;</span> <span class="fu">group_by</span>(months) <span class="sc">|&gt;</span> <span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(nitrate))</span>
<span id="cb68-3"><a href="#cb68-3"></a>river_grouped </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<table class="dataframe table table-sm table-striped">
<caption>A tibble: 12 × 2</caption>
<thead>
    <tr><th scope="col">months</th><th scope="col">mean</th></tr>
    <tr><th scope="col">&lt;chr&gt;</th><th scope="col">&lt;dbl&gt;</th></tr>
</thead>
<tbody>
    <tr><td>April    </td><td>1.0166250</td></tr>
    <tr><td>August   </td><td>0.9380833</td></tr>
    <tr><td>December </td><td>1.2264167</td></tr>
    <tr><td>February </td><td>1.1838400</td></tr>
    <tr><td>January  </td><td>1.2163600</td></tr>
    <tr><td>July     </td><td>0.9810417</td></tr>
    <tr><td>June     </td><td>0.9792083</td></tr>
    <tr><td>March    </td><td>1.1050400</td></tr>
    <tr><td>May      </td><td>0.9978333</td></tr>
    <tr><td>November </td><td>1.0962500</td></tr>
    <tr><td>October  </td><td>1.0360000</td></tr>
    <tr><td>September</td><td>0.9885833</td></tr>
</tbody>
</table>
</div>
</div>
<div class="cell" data-execution_count="105">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1"></a><span class="fu">plot</span>(river_grouped<span class="sc">$</span>mean, <span class="at">type =</span> <span class="st">"o"</span>, <span class="at">xlab =</span> <span class="st">"Month"</span>, <span class="at">ylab =</span> <span class="st">"Monthly mean"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="data-cleaning_files/figure-html/cell-60-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="106">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1"></a><span class="fu">boxplot</span>(nitrate <span class="sc">~</span> months, <span class="at">data =</span> river_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="data-cleaning_files/figure-html/cell-61-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>Між Q1 та Q2 зосереджено 50% усіх спостережень. Персентиль відображає кількість спостережень, що зосереджені з ним включно. Нижче розміщено більше інформації для ознайомлення з інформацією про квантилі.</p>
<p><a href="https://en.wikipedia.org/wiki/Quantile">Quantile. Wikipedia</a></p>
<p><img src="../../_static/da-data-cleaning/quantiles.png" class="img-fluid"></p>
<p>Джерело: https://en.wikipedia.org/wiki/Interquartile_range</p>
<p><img src="../../_static/da-data-cleaning/quantiles2.png" class="img-fluid"></p>
<p>Джерело: https://makemeanalyst.com/explore-your-data-range-interquartile-range-and-box-plot/</p>
<p>Визначивши викиди у даних з ними можна здійснити кілька операцій:</p>
<ol type="1">
<li>Заміна на деякі значення (impute)</li>
<li>Заміна на границі квантилей</li>
</ol>
<div class="cell" data-execution_count="107">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1"></a>lower_bound <span class="ot">&lt;-</span> <span class="fu">quantile</span>(river_data<span class="sc">$</span>nitrate, <span class="fl">0.025</span>)</span>
<span id="cb71-2"><a href="#cb71-2"></a>lower_bound</span>
<span id="cb71-3"><a href="#cb71-3"></a></span>
<span id="cb71-4"><a href="#cb71-4"></a>upper_bound <span class="ot">&lt;-</span> <span class="fu">quantile</span>(river_data<span class="sc">$</span>nitrate, <span class="fl">0.975</span>)</span>
<span id="cb71-5"><a href="#cb71-5"></a>upper_bound</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<strong>2.5%:</strong> 0.75475
</div>
<div class="cell-output cell-output-display">
<strong>97.5%:</strong> 1.4095
</div>
</div>
<div class="cell" data-execution_count="108">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1"></a>outlier_index <span class="ot">&lt;-</span> <span class="fu">which</span>(river_data<span class="sc">$</span>nitrate <span class="sc">&lt;</span> lower_bound <span class="sc">|</span> river_data<span class="sc">$</span>nitrate <span class="sc">&gt;</span> upper_bound)</span>
<span id="cb72-2"><a href="#cb72-2"></a>outlier_index</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class="list-inline"><li>1</li><li>6</li><li>36</li><li>53</li><li>104</li><li>119</li><li>121</li><li>156</li><li>159</li><li>167</li><li>199</li><li>200</li><li>269</li><li>270</li><li>281</li><li>282</li></ol>
</div>
</div>
<div class="cell" data-execution_count="109">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1"></a>river_data[outlier_index, ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<table class="dataframe table table-sm table-striped">
<caption>A data.frame: 16 × 3</caption>
<thead>
    <tr><th></th><th scope="col">index</th><th scope="col">nitrate</th><th scope="col">months</th></tr>
    <tr><th></th><th scope="col">&lt;int&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;chr&gt;</th></tr>
</thead>
<tbody>
    <tr><th scope="row">1</th><td>  1</td><td>1.581</td><td>January </td></tr>
    <tr><th scope="row">6</th><td>  6</td><td>1.483</td><td>June    </td></tr>
    <tr><th scope="row">36</th><td> 36</td><td>1.643</td><td>December</td></tr>
    <tr><th scope="row">53</th><td> 53</td><td>1.533</td><td>May     </td></tr>
    <tr><th scope="row">104</th><td>104</td><td>0.671</td><td>August  </td></tr>
    <tr><th scope="row">119</th><td>119</td><td>1.517</td><td>November</td></tr>
    <tr><th scope="row">121</th><td>121</td><td>1.414</td><td>January </td></tr>
    <tr><th scope="row">156</th><td>156</td><td>1.897</td><td>December</td></tr>
    <tr><th scope="row">159</th><td>159</td><td>1.414</td><td>March   </td></tr>
    <tr><th scope="row">167</th><td>167</td><td>0.671</td><td>November</td></tr>
    <tr><th scope="row">199</th><td>199</td><td>0.748</td><td>July    </td></tr>
    <tr><th scope="row">200</th><td>200</td><td>0.592</td><td>August  </td></tr>
    <tr><th scope="row">269</th><td>269</td><td>0.700</td><td>May     </td></tr>
    <tr><th scope="row">270</th><td>270</td><td>0.673</td><td>June    </td></tr>
    <tr><th scope="row">281</th><td>281</td><td>0.730</td><td>May     </td></tr>
    <tr><th scope="row">282</th><td>282</td><td>0.693</td><td>June    </td></tr>
</tbody>
</table>
</div>
</div>
<p>Таким чином, усі значення вище та нище деякого показника можемо замінити на потрібні нам значення, наприклад, середні за поточний місяць.</p>
<p>Здійснимо заміну значень у наборі даних на основі квантилей:</p>
<div class="cell" data-execution_count="110">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1"></a>river_data<span class="sc">$</span>nitrate_upd <span class="ot">&lt;-</span> river_data<span class="sc">$</span>nitrate</span>
<span id="cb74-2"><a href="#cb74-2"></a>qnt <span class="ot">&lt;-</span> <span class="fu">quantile</span>(river_data<span class="sc">$</span>nitrate_upd, <span class="at">probs=</span><span class="fu">c</span>(.<span class="dv">05</span>, .<span class="dv">95</span>), <span class="at">na.rm =</span> T)</span>
<span id="cb74-3"><a href="#cb74-3"></a>H <span class="ot">&lt;-</span> <span class="fl">1.5</span> <span class="sc">*</span> <span class="fu">IQR</span>(qnt[<span class="dv">1</span>], <span class="at">na.rm =</span> T)</span>
<span id="cb74-4"><a href="#cb74-4"></a>river_data<span class="sc">$</span>nitrate_upd[river_data<span class="sc">$</span>nitrate_upd <span class="sc">&lt;</span> (qnt[<span class="dv">1</span>] <span class="sc">-</span> H)] <span class="ot">&lt;-</span> qnt[<span class="dv">1</span>]</span>
<span id="cb74-5"><a href="#cb74-5"></a>river_data<span class="sc">$</span>nitrate_upd[river_data<span class="sc">$</span>nitrate_upd <span class="sc">&gt;</span> (qnt[<span class="dv">2</span>] <span class="sc">+</span> H)] <span class="ot">&lt;-</span> qnt[<span class="dv">2</span>]</span>
<span id="cb74-6"><a href="#cb74-6"></a></span>
<span id="cb74-7"><a href="#cb74-7"></a>qnt</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<style>
.dl-inline {width: auto; margin:0; padding: 0}
.dl-inline>dt, .dl-inline>dd {float: none; width: auto; display: inline-block}
.dl-inline>dt::after {content: ":\0020"; padding-right: .5ex}
.dl-inline>dt:not(:first-of-type) {padding-left: .5ex}
</style><dl class="dl-inline"><dt>5%</dt><dd>0.805</dd><dt>95%</dt><dd>1.3325</dd></dl>
</div>
</div>
<div class="cell" data-execution_count="111">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1"></a><span class="fu">boxplot</span>(river_data<span class="sc">$</span>nitrate_upd)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="data-cleaning_files/figure-html/cell-66-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="112">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1"></a><span class="fu">boxplot</span>(nitrate_upd <span class="sc">~</span> months, <span class="at">data =</span> river_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="data-cleaning_files/figure-html/cell-67-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="113">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1"></a><span class="fu">plot</span>(nitrate_upd <span class="sc">~</span> index, <span class="at">data =</span> river_data, <span class="at">type =</span> <span class="st">"o"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="data-cleaning_files/figure-html/cell-68-output-1.png" class="img-fluid"></p>
</div>
</div>
<hr>
</section>
<section id="додаткові-прийоми-очистки-даних" class="level2" data-number="20.5">
<h2 data-number="20.5" class="anchored" data-anchor-id="додаткові-прийоми-очистки-даних"><span class="header-section-number">20.5</span> Додаткові прийоми очистки даних <a class="anchor" id="id5"></a></h2>
<section id="видалення-дублікатів" class="level3" data-number="20.5.1">
<h3 data-number="20.5.1" class="anchored" data-anchor-id="видалення-дублікатів"><span class="header-section-number">20.5.1</span> Видалення дублікатів</h3>
<div class="cell" data-cell_id="d490e9a9360c42ae987076ffe6c2a38c" data-deepnote_cell_height="66" data-deepnote_cell_type="code" data-tags="[]" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="114">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">X =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">1</span>), <span class="at">Y =</span> <span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>, <span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>, <span class="st">"A"</span>))</span>
<span id="cb78-2"><a href="#cb78-2"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<table class="dataframe table table-sm table-striped">
<caption>A data.frame: 7 × 2</caption>
<thead>
    <tr><th scope="col">X</th><th scope="col">Y</th></tr>
    <tr><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;chr&gt;</th></tr>
</thead>
<tbody>
    <tr><td>1</td><td>A</td></tr>
    <tr><td>1</td><td>B</td></tr>
    <tr><td>2</td><td>C</td></tr>
    <tr><td>1</td><td>A</td></tr>
    <tr><td>3</td><td>B</td></tr>
    <tr><td>2</td><td>C</td></tr>
    <tr><td>1</td><td>A</td></tr>
</tbody>
</table>
</div>
</div>
<div class="cell" data-cell_id="788b0f22678d41c19a949ffa6ce2751d" data-deepnote_cell_height="200.5625" data-deepnote_cell_type="code" data-execution_millis="80" data-execution_start="1650383560355" data-source_hash="45cbf634" data-tags="[]" data-vscode="{&quot;languageId&quot;:&quot;r&quot;}" data-execution_count="115">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1"></a>df <span class="sc">|&gt;</span> <span class="fu">distinct</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<table class="dataframe table table-sm table-striped">
<caption>A data.frame: 4 × 2</caption>
<thead>
    <tr><th scope="col">X</th><th scope="col">Y</th></tr>
    <tr><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;chr&gt;</th></tr>
</thead>
<tbody>
    <tr><td>1</td><td>A</td></tr>
    <tr><td>1</td><td>B</td></tr>
    <tr><td>2</td><td>C</td></tr>
    <tr><td>3</td><td>B</td></tr>
</tbody>
</table>
</div>
</div>
<hr>
</section>
</section>
<section id="завдання-для-практики" class="level2" data-number="20.6">
<h2 data-number="20.6" class="anchored" data-anchor-id="завдання-для-практики"><span class="header-section-number">20.6</span> Завдання для практики</h2>
<p>!!!</p>
<hr>
</section>
<section id="набори-даних" class="level2" data-number="20.7">
<h2 data-number="20.7" class="anchored" data-anchor-id="набори-даних"><span class="header-section-number">20.7</span> Набори даних</h2>
<ol type="1">
<li>https://github.com/kleban/r-book-published/tree/main/datasets/untitled.csv</li>
<li>https://github.com/kleban/r-book-published/tree/main/datasets/badtitled.csv</li>
<li>https://github.com/kleban/r-book-published/tree/main/datasets/cleaned_titled.csv</li>
<li>https://github.com/kleban/r-book-published/tree/main/datasets/cleaned_titled2.csv</li>
<li>https://github.com/kleban/r-book-published/tree/main/datasets/river_eco.csv</li>
</ol>
<hr>
</section>
<section id="використані-та-додаткові-джерела" class="level2" data-number="20.8">
<h2 data-number="20.8" class="anchored" data-anchor-id="використані-та-додаткові-джерела"><span class="header-section-number">20.8</span> Використані та додаткові джерела</h2>
<ol type="1">
<li><a href="https://www.insidesherpa.com/virtual-internships/m7W4GMqeT3bh9Nb2c">KPMG Virtual Internship</a></li>
<li><a href="https://cran.r-project.org/doc/contrib/de_Jonge+van_der_Loo-Introduction_to_data_cleaning_with_R.pdf">An introduction to data cleaning with R / Edwin de Jonge, Mark van der Loo, 2013</a></li>
<li><a href="datacamp.com/courses/anomaly-detection-in-r">Anomaly Detection in R</a></li>
<li><a href="https://medium.com/analytics-vidhya/k-nearest-neighbor-the-maths-behind-it-how-it-works-and-an-example-f1de1208546c">K-nearest Neighbor: The maths behind it, how it works and an example</a></li>
<li><a href="https://en.wikipedia.org/wiki/Quantile">Quantile. Wikipedia</a></li>
</ol>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>

<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./39-r-wide-to-long.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Wide-to-long tables</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./references.html" class="pagination-link">
        <span class="nav-page-text">Список використаних джерел</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
      <div class="nav-footer-center">Copyright 2023, Юрій Клебан</div>
  </div>
</footer>



</body></html>